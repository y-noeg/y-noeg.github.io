"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7660],{79271:function(e,t,o){var n,r=o(67294);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i.apply(this,arguments)}t.Z=function(e){return r.createElement("svg",i({fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=r.createElement("path",{d:"M8 3.5L5.46 6.547a.6.6 0 01-.921 0L1.999 3.5",stroke:"inherit",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}},41822:function(e,t,o){o.d(t,{W:function(){return n}});const n=o(59016).ZP.div.withConfig({displayName:"BottomRightButtons",componentId:"sc-1xy1znj-0"})(["position:absolute;bottom:","px;right:","px;flex-direction:column;display:grid;gap:8px;"],(e=>e.theme.panelSpacing),(e=>e.theme.panelSpacing))},8423:function(e,t,o){o.d(t,{N:function(){return m}});o(67294);var n=o(59016),r=o(41664),i=o.n(r),a=o(29212),l=o(24418),s=o(85893);const c=n.ZP.div.withConfig({displayName:"FullScreenMessage__PageContainer",componentId:"jdrf4g-0"})(["align-items:center;display:flex;height:100%;justify-content:center;width:100%;background-color:",";user-select:text;"],(e=>{let{theme:t}=e;return t.colors.background})),d=n.ZP.div.withConfig({displayName:"FullScreenMessage__Content",componentId:"jdrf4g-1"})(["flex-direction:row;text-align:center;max-width:340px;width:100%;padding:0 20px;"]),p=n.ZP.div.withConfig({displayName:"FullScreenMessage__LogoContainer",componentId:"jdrf4g-2"})(["margin-bottom:28px;&:hover{cursor:pointer;}"]),u=n.ZP.div.withConfig({displayName:"FullScreenMessage__MainMessage",componentId:"jdrf4g-3"})(["font-weight:500;font-size:15px;line-height:20px;"]),m=n.ZP.div.withConfig({displayName:"FullScreenMessage__SubMessage",componentId:"jdrf4g-4"})(["margin:24px 0;font-size:13px;line-height:16px;color:",";a{color:",";&:hover,:focus,:active{text-decoration:underline;}}"],(e=>{let{theme:t}=e;return t.colors.subMessageText}),(e=>{let{theme:t}=e;return t.colors.subMessageLink}));t.Z=e=>{let{mainMessage:t,children:o}=e;const{workspaceUrl:n}=(0,l.bp)();return(0,s.jsx)(c,{children:(0,s.jsxs)(d,{children:[(0,s.jsx)(i(),{href:n,children:(0,s.jsx)(p,{children:(0,s.jsx)(a.Z,{style:{width:"40px",height:"40px"}})})}),(0,s.jsx)(u,{children:t}),o]})})}},76682:function(e,t,o){o(67294);var n=o(37887),r=o(33504),i=o(85893);t.Z=e=>{let{id:t,children:o}=e;const{loading:a,error:l,data:s}=(0,n.a)(r.Z,{variables:{id:t},skip:null==t});if(a)return(0,i.jsx)("div",{});if(l)return(0,i.jsxs)(i.Fragment,{children:["`Error! $",l.message,"`"]});const c=s?s.tile:null;return(0,i.jsx)(i.Fragment,{children:o(c)})}},37660:function(e,t,o){o.d(t,{E:function(){return Cf},Z:function(){return vf}});var n,r=o(59499),i=o(4730),a=o(67294),l=o(4480),s=o(64310),c=o(13433),d=o(13285),p=o(95421),u=o(5152),m=o.n(u),g=o(11163),h=o.n(g),f=o(7863),b=o(59016),y=o(1922),C=o(17386),v=o(29334),x=o(31343),O=o(94717);function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},P.apply(this,arguments)}var j=function(e){return a.createElement("svg",P({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.833 0A1.167 1.167 0 0114 1.167v11.666A1.167 1.167 0 0112.833 14H1.167A1.167 1.167 0 010 12.833V1.167A1.167 1.167 0 011.167 0h11.666z",fill:"#FF3434"})))},w=o(40461),T=o(53098),I=o(80375),E=o(4034),_=o(90170),S=o(85893);const k=(0,b.ZP)(d.E.div).withConfig({displayName:"RecordingInProgressPanel__ContainerStyles",componentId:"sc-1ipbnub-0"})(["margin-right:","px;width:","px;height:","px;overflow:hidden;z-index:",";position:absolute;top:","px;right:0;flex-direction:column;display:flex;justify-content:center;"],(e=>e.theme.panelSpacing),(e=>{let{width:t}=e;return t}),(e=>{let{height:t}=e;return t}),T.Mf,(e=>-e.theme.headerHeight)),Z=(0,b.ZP)(O.Z).withConfig({displayName:"RecordingInProgressPanel__StopButton",componentId:"sc-1ipbnub-1"})(["height:40px;width:40px;border-radius:53px;display:flex;align-items:center;justify-content:center;color:",";"],(e=>e.theme.colors.sheetBg));var D=e=>{let{width:t,height:o,resetToFullCanvas:n}=e;const[r,i]=(0,l.FV)(w.wo);(0,a.useEffect)((()=>()=>i(!1)),[i]);const s=(0,a.useRef)(r);s.current=r;const c=(0,E.t2)(),d=(0,a.useCallback)((()=>{s.current&&(n(),i(!1),c.setPropertyPanel(_.Z.RECORD))}),[n,i,c]),p=(0,a.useCallback)((e=>{"Space"!==e.code&&"Escape"!==e.code||d()}),[d]);return(0,a.useEffect)((()=>r?(document.addEventListener("keyup",p),()=>{document.removeEventListener("keyup",p)}):()=>{}),[r,p]),r?(0,S.jsx)(k,{width:t,height:o,initial:{x:t},animate:{x:0},exit:{x:t},transition:I.Z2,children:(0,S.jsx)(Z,{"data-testid":"stop_recording_button",onClick:d,children:(0,S.jsx)(j,{})})}):null},M=o(92627),R=o(78374),A=o(60153),L=o(86388),N=o(24418),H=o(60864),V=o(66482),B=o(88902),F=o(64096),$=o(89202),G=o(36409),z=o(51718);var U=o(61505),W=o(14593),q=o(84081),K=o(24955),Y=o(95821),J=o(76682),X=o(40556),Q=o(33340),ee=o(96012);const te=b.ZP.div.withConfig({displayName:"Common__PanelContainer",componentId:"olc3hh-0"})(["margin:0 12px 12px 12px;font-size:",";width:216px;"],(e=>e.theme.fontSizes.sm)),oe=b.ZP.div.withConfig({displayName:"Common__PropertyRow",componentId:"olc3hh-1"})(["width:100%;height:28px;margin-bottom:",";",""],(e=>{let{$lastItem:t=!1}=e;return t?"0px":"12px"}),(e=>{let{disabled:t=!1}=e;return t&&(0,b.iv)(["opacity:0.4;"])})),ne=(0,b.ZP)(oe).withConfig({displayName:"Common__PropertyRowText",componentId:"olc3hh-2"})(["font-size:",";line-height:13px;height:24px;padding-top:1px;padding-bottom:8px;color:",";margin-bottom:0;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),re=(0,b.ZP)(oe).withConfig({displayName:"Common__TwoButtonRow",componentId:"olc3hh-3"})(["display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:10px;"]),ie=(0,b.ZP)(oe).withConfig({displayName:"Common__ToggleRow",componentId:"olc3hh-4"})(["font-size:",";color:",";height:20px;margin-bottom:12px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;",""],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40),(e=>e.disabled&&"\n    opacity: 0.4;\n  ")),ae=(0,b.ZP)(ee.Z).withConfig({displayName:"Common__PropertyPanelInput",componentId:"olc3hh-5"})(["height:28px;min-height:28px;margin-top:0;padding:6px 12px;background-color:",";color:",";::placeholder{color:",";}:disabled{background-color:",";border-color:",";color:",";}:disabled::placeholder{color:",";}:focus{background-color:",";border-color:",";}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.inputText}),(e=>{let{theme:t}=e;return t.colors.inputPlaceholder}),(e=>{let{theme:t}=e;return t.colors.inputBgDisabled}),(e=>{let{theme:t}=e;return t.colors.inputBorderDisabled}),(e=>{let{theme:t}=e;return t.colors.inputTextDisabled}),(e=>{let{theme:t}=e;return t.colors.inputPlaceholderDisabled}),(e=>{let{theme:t}=e;return t.colors.inputBgFocus}),(e=>{let{theme:t}=e;return t.colors.inputBorderFocus})),le=b.ZP.textarea.withConfig({displayName:"Common__TextareaInput",componentId:"olc3hh-6"})(["width:100%;height:80px;font-size:13px;line-height:16px;padding:8px;margin:0;background-color:",";appearance:none;display:block;border:none;border-top:none;box-sizing:border-box;border-radius:",";font-size:",";caret-color:",";color:",";outline:none;resize:none;&::selection{background-color:",";}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>e.theme.borderRadius.sm),(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.uiAccent),(e=>e.theme.colors.inputText),(e=>e.theme.colors.textSelection)),se=b.ZP.div.withConfig({displayName:"Common__InputRow",componentId:"olc3hh-7"})(["width:100%;margin-bottom:12px;"]);var ce=o(53569),de=o(5370),pe=o(79271),ue=o(39090);const me=["isDisabled"],ge=["children"],he=["children","isDisabled"];function fe(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function be(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):fe(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ye=b.ZP.div.withConfig({displayName:"TextSelector__OptionContainer",componentId:"sc-93lq8j-0"})(["padding:6px 4px 6px 8px;display:flex;align-items:center;flex-wrap:wrap;"]),Ce=b.ZP.div.withConfig({displayName:"TextSelector__OptionValue",componentId:"sc-93lq8j-1"})(["flex:1;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"]),ve=b.ZP.div.withConfig({displayName:"TextSelector__OptionDescription",componentId:"sc-93lq8j-2"})(["margin-top:2px;color:",";font-size:",";line-height:1.2;",":hover &{color:",";}"],(e=>{let{theme:t}=e;return t.colors.menuTextSecondary}),(e=>{let{theme:t}=e;return t.fontSizes.xxs}),ye,(e=>{let{theme:t}=e;return t.colors.menuTextHover})),xe=e=>{let{isDisabled:t}=e,o=(0,i.Z)(e,me);return(0,S.jsx)(ce.F.DropdownIndicator,be(be({},o),{},{children:t?(0,S.jsx)(pe.Z,{opacity:"0.2",height:"10",width:"10",viewBox:"0 0 10 10"}):(0,S.jsx)(pe.Z,{height:"10",width:"10",viewBox:"0 0 10 10"})}))},Oe=e=>{let{children:t}=e,o=(0,i.Z)(e,ge);return(0,S.jsx)(ce.F.Option,be(be({},o),{},{children:(0,S.jsxs)(ye,{children:[(0,S.jsx)(Ce,{children:t}),o.isSelected&&(0,S.jsx)(ue.Z,{}),o.data.description&&(0,S.jsx)(ve,{children:o.data.description})]})}))},Pe=e=>{let{children:t,isDisabled:o}=e,n=(0,i.Z)(e,he);return ce.F.ValueContainer&&(0,S.jsxs)(ce.F.ValueContainer,be(be({},n),{},{children:[!!t&&n.selectProps.icon&&(0,S.jsx)(n.selectProps.icon,{style:{width:18,height:18,fill:"currentColor",marginRight:"5px",flex:"none",opacity:o?"0.5":1}}),t]}))};var je=e=>{let{currentValue:t,options:o,onBlur:n,onFocus:r,onChange:i,menuWidth:l,controlWidth:s,disabled:c,icon:d,backgroundColor:p,styles:u,placeholder:m}=e;const g=(0,b.Fg)(),h=o.filter((e=>e.value===t)),f=h.length>0?h[0]:o[0],y=(0,a.useMemo)((()=>({menu:(e,t)=>be(be({},e),{},{width:t.selectProps.menuWidth,fontSize:"12px",lineHeight:"16px",marginTop:"-28px",padding:"6px",color:g.colors.menuControlText,backgroundColor:g.colors.menuBackgroundLayer[0]}),control:(e,t)=>be(be({},e),{},{width:t.selectProps.controlWidth,border:0,boxShadow:"none",fontSize:"12px",height:"28px",minHeight:"28px",lineHeight:"16px",paddingLeft:"4px",color:g.colors.menuControlText,"&:hover":{backgroundColor:g.colors.contrast12}}),valueContainer:e=>be(be({},e),{},{flexWrap:"initial"}),singleValue:()=>({color:g.colors.menuControlText,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}),placeholder:(e,t)=>({color:g.colors.menuControlText,opacity:t.selectProps.isDisabled?.5:1}),menuList:e=>be(be({},e),{},{paddingTop:0,paddingBottom:0}),option:(e,t)=>{let{data:o}=t;return be(be({},e),{},{borderRadius:"6px",color:o.color||g.colors.menuText,padding:"0px","&:hover":{color:o.colorHover||o.color||g.colors.menuTextHover,backgroundColor:o.backgroundColorHover||g.colors.uiAccent}})},indicatorsContainer:e=>be(be({},e),{},{height:"26px",paddingRight:"2px"}),dropdownIndicator:e=>be(be({},e),{},{stroke:g.colors.menuControlText})})),[g]),C=be(be({},y),u);return(0,S.jsx)(de.ZP,{isDisabled:c,onChange:e=>i(e.value),onBlur:n,onFocus:r,styles:C,menuWidth:l,controlWidth:s,options:o,isSearchable:!1,value:f,icon:d,placeholder:m||"",components:{DropdownIndicator:xe,IndicatorSeparator:()=>null,Option:Oe,ValueContainer:Pe},theme:e=>be(be({},e),{},{borderRadius:8,colors:be(be({},e.colors),{},{primary25:g.colors.transparent,primary50:g.colors.transparent,primary75:g.colors.transparent,primary:g.colors.transparent,neutral0:p??g.colors.contrast8,neutral5:g.colors.contrast8,neutral10:g.colors.contrast8,neutral90:g.colors.contrast,neutral80:g.colors.contrast,neutral70:g.colors.contrast,neutral60:g.colors.contrast,neutral50:g.colors.contrast})})})},we=o(24306);const Te=["style","isSelected"];function Ie(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ee(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ie(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const _e=(e,t)=>{const{style:o,isSelected:n}=e,r=(0,i.Z)(e,Te),a=(0,b.Fg)();return(0,S.jsxs)(we.Z,Ee(Ee({ref:t,style:Ee(Ee({},o),{},{width:24,height:24,fillOpacity:0,borderRadius:"100%",border:n?`2px solid ${a.colors.contentAccent}`:null}),viewBox:"0 0 24 24"},r),{},{children:[(0,S.jsx)("path",{d:"M21 3L3 21",stroke:n?`${a.colors.contentAccent}`:a.colors.colorSwatchBlackBorder,strokeWidth:"1.5"}),(0,S.jsx)("rect",{x:"0.75",y:"0.75",width:"22.5",height:"22.5",rx:"11.25",stroke:n?"transparent":a.colors.colorSwatchBlackBorder,strokeWidth:"1.5"})]}))};var Se=(0,a.forwardRef)(_e),ke=o(38621);const Ze=b.ZP.div.withConfig({displayName:"ColorSelectorstyles__LegacySwatchContainer",componentId:"sc-1xotnel-0"})(["width:100%;height:24px;margin-top:4px;display:flex;flex-direction:row;gap:12px;"]),De=(0,b.ZP)(ke.Z).attrs((()=>({type:"button"}))).withConfig({displayName:"ColorSelectorstyles__LegacySwatch",componentId:"sc-1xotnel-1"})(["width:24px;height:24px;border-radius:100%;box-sizing:border-box;",";background:",";",";",";",";background-size:cover;"],(e=>e.$isSelected&&`border: 2px solid ${e.$colorPickerMode?e.theme.colors.contrast:e.theme.colors.uiAccent}`),(e=>"black"===e.$color?e.theme.colors.colorSwatchBlack:"light"===e.$color?e.theme.colors.colorSwatchWhite:null),(e=>"black"===e.$color&&!e.$isSelected&&`border: 1.5px solid ${e.theme.colors.colorSwatchBlackBorder}`),(e=>"light"===e.$color&&!e.$isSelected&&`border: 1.5px solid ${e.theme.colors.colorSwatchBlackBorder}`),(e=>e.$colorPickerMode&&"background: url(/assets/color-picker.png)"));var Me;!function(e){e[e.dark=0]="dark",e[e.light=1]="light",e[e.black=2]="black"}(Me||(Me={}));var Re=e=>{let t,{color:o,setColor:n,disabled:r}=e;t="black"===o?"black":"light"===o?"light":"dark"===o?"dark":"custom";const i=(0,a.useCallback)((e=>{n(e.currentTarget.value)}),[n]),l=(0,E.t2)(),{t:s}=(0,y.$G)(),c=(0,a.useCallback)((()=>{l.pushPropertyPanel(_.Z.COLOR_PICKER)}),[l]);return(0,S.jsxs)(Ze,{children:[(0,S.jsx)(De,{disabled:r,title:"#00000",value:"black",$isSelected:"black"===t,$color:"black",onClick:i,"data-testid":"black_color_input"}),(0,S.jsx)(De,{disabled:r,title:"#ffffff",value:"light",$isSelected:"light"===t,$color:"light",onClick:i,"data-testid":"white_color_input"}),(0,S.jsx)(De,{disabled:r,title:`${s("library.colorSelector.onhoverTitle.chooseAColor")}`,$colorPickerMode:!0,$isSelected:"custom"===t,onClick:c,"data-testid":"custom_color_input"}),(0,S.jsx)(De,{disabled:r,title:`${s("library.colorSelector.onhoverTitle.removeBackgroundColor")}`,value:"dark",$isSelected:!1,onClick:i,children:(0,S.jsx)(Se,{isSelected:"dark"===t})})]})},Ae=o(78963),Le=o(83942),Ne=o(38156),He=o(34136),Ve=o(88554);const Be=b.ZP.div.withConfig({displayName:"SegmentedControls",componentId:"sc-1oyxyb-0"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);& button{min-width:unset;}& button:nth-child(1) span{border-top-right-radius:0px;border-bottom-right-radius:0px;}& button:not(:first-child):not(:last-child) span{border-radius:0px;}& button:nth-last-child(1) span{border-top-left-radius:0px;border-bottom-left-radius:0px;}border:1px solid ",";border-radius:",';& [aria-selected="true"] ',"{background:",";}}"],(e=>e.theme.colors.segmentedBorder),Ve.n.default,He.e,(e=>{let{theme:t}=e;return t.colors.segmentedSelected}));var Fe=Be,$e=o(17463),Ge=o(10196),ze=o(70777);function Ue(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function We(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ue(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var qe=e=>{let{tileData:t,updateTileData:o}=e;const n=(0,a.useRef)(null),r=(0,l.Zl)(Ae.cm),i=(0,l.Zl)(Ae.VJ),s=(0,l.Zl)((0,$e.vw)(t.id)),c=(0,a.useCallback)((e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];s((0,$e.aY)(t))}}),[s]),{imageAttributes:d,mediaTileData:p}=t,{mediaFillType:u,backgroundColor:m,captionStyle:g,fillCropCenterX:h,fillCropCenterY:f,fillCropScale:b,mediaStatus:C}=p||{},v=u||K.AL,x=m||K.M2,O=C===z.Jpv.UploadInProgress,P=(0,a.useCallback)((e=>{o((t=>We(We({},t),{},{mediaTileData:We(We({},t.mediaTileData),{},{mediaFillType:e})})))}),[o]),j=(0,B.ye)(B.TT.AI_IMAGE_OUTPAINTING),w=g||K.Io,T=(0,K.Gj)(d,C),I=(0,a.useCallback)((e=>{const t=e;o((e=>We(We({},e),{},{mediaTileData:We(We({},e.mediaTileData),{},{captionStyle:t})}))),w!==z.ubC.None&&null!==w||t===z.ubC.None||(0,H.VY)(!0)}),[w,o]),k=(0,a.useCallback)((e=>(0,Le.$V)(o,e)),[o]),Z=(0,a.useCallback)((e=>{o((t=>We(We({},t),{},{mediaTileData:We(We({},t.mediaTileData),{},{backgroundColor:e})})))}),[o]),D=null!=h&&null!=f&&null!=b,M=(0,a.useCallback)((()=>{v!==z.EwX.Fill&&v!==z.EwX.Fit||D?P(z.EwX.Crop):(i(v),r(!0))}),[v,D,r,i,P]),R=(0,a.useCallback)((()=>{i(v),r(!0)}),[v,r,i]),A=(0,E.t2)(),L=(0,a.useCallback)((()=>{A.pushPropertyPanel(_.Z.OUTPAINTING)}),[A]),N=(0,a.useCallback)((()=>{A.pushPropertyPanel(_.Z.IMAGE_CREATE)}),[A]),{t:V}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(t.type===z.YUT.Image||t.type===z.YUT.ImageGenerative)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(re,{style:{height:"56px"},children:[(0,S.jsx)(He.Z,{onClick:N,size:"tall",startIcon:(0,S.jsx)(Ge.Z,{}),iconStyles:{width:"16px",height:"16px"},children:V("sidebar.media.create")}),(0,S.jsx)(Ne.Z,{onClick:()=>{var e;null===(e=n.current)||void 0===e||e.click()},actionText:V("sidebar.media.upload"),disabled:O,style:{width:"100%"},size:"tall",startIcon:(0,S.jsx)(ze.Z,{}),iconStyles:{width:"16px",height:"16px"}})]}),(0,S.jsx)("input",{ref:n,type:"file",accept:K.lW,onChange:c,style:{display:"none"}})]}),t.type===z.YUT.Giphy&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:V("sidebar.media.URL")}),(0,S.jsx)(oe,{children:(0,S.jsx)(ae,{type:"text",value:t.contentLink||"",onChange:e=>k(e.target.value),placeholder:V("sidebar.media.giphyLink")})})]}),(0,S.jsx)(ne,{disabled:T,children:V("sidebar.media.size")}),(0,S.jsxs)(Fe,{style:{marginBottom:12},role:"listbox",children:[(0,S.jsx)(He.Z,{disabled:T,"data-testid":"image_fill_type_fit_option",selected:v===z.EwX.Fit,onClick:()=>P(z.EwX.Fit),isSegment:!0,children:V("sidebar.media.fit")}),(0,S.jsx)(He.Z,{disabled:T,"data-testid":"image_fill_type_fill_option",selected:v===z.EwX.Fill,onClick:()=>P(z.EwX.Fill),isSegment:!0,children:V("sidebar.media.fill")}),(0,S.jsx)(He.Z,{disabled:T,"data-testid":"image_fill_type_crop_option",selected:v===z.EwX.Crop,onClick:M,isSegment:!0,children:V("sidebar.media.custom")})]}),(0,S.jsx)(oe,{children:(0,S.jsx)(He.Z,{disabled:T,onClick:R,style:{width:"100%"},children:V("sidebar.media.adjust")})}),j&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{disabled:T,children:V("sidebar.media.aiTools")}),(0,S.jsx)(He.Z,{disabled:T,onClick:L,style:{width:"100%"},"data-testid":"image_outpainting_button",children:V("sidebar.media.outpainting")})]}),(0,S.jsx)(ne,{disabled:T,children:V("sidebar.caption")}),(0,S.jsx)(oe,{disabled:T,"data-testid":"image_caption_input",children:(0,S.jsx)(je,{disabled:T,currentValue:w,options:[{value:"none",label:V("sidebar.none")},{value:"top",label:V("sidebar.top")},{value:"bottom",label:V("sidebar.bottom")}],onChange:I,menuWidth:"100%",controlWidth:"100%"})}),(0,S.jsx)(ne,{disabled:T,children:V("sidebar.backgroundColor")}),(0,S.jsx)(oe,{disabled:T,"data-testid":"image_background_color_input",$lastItem:!0,children:(0,S.jsx)(Re,{color:x,setColor:Z,disabled:T})})]})},Ke=o(58975),Ye=o(62820),Je=o(65309),Xe=o(43886),Qe=o(25675),et=o.n(Qe);const tt=b.ZP.div.withConfig({displayName:"ImageCardList__CardListWrapper",componentId:"sc-5aed7r-0"})([""]),ot=b.ZP.div.withConfig({displayName:"ImageCardList__PreviewDiv",componentId:"sc-5aed7r-1"})(["width:103px;height:103px;border-radius:8px;background-color:",";display:flex;justify-content:center;align-items:center;"],(e=>{let{theme:t}=e;return t.colors.inputBg})),nt=(0,b.ZP)(ot).withConfig({displayName:"ImageCardList__GlimmerPreviewDiv",componentId:"sc-5aed7r-2"})(["animation:glimmer 1.36s infinite;animation-delay:",";background:linear-gradient( to bottom right,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 32.65%,rgba(255,255,255,0.2) 45.58%,rgba(255,255,255,0) 60.74%,rgba(255,255,255,0) 100% );background-size:400px 400px;@keyframes glimmer{0%{background-position:-220px -220px;}100%{background-position:-10px -10px;}}"],(e=>{let{index:t}=e;switch(t){case 0:default:return"0s";case 1:case 2:return"0.198s";case 3:return"0.395s"}})),rt=b.ZP.div.withConfig({displayName:"ImageCardList__CardList",componentId:"sc-5aed7r-3"})(["gap:10px;display:grid;grid-template-columns:repeat(",",1fr);"],(e=>{let{columns:t}=e;return t})),it=b.ZP.div.withConfig({displayName:"ImageCardList__Card",componentId:"sc-5aed7r-4"})(["display:flex;column-span:1;-webkit-column-break-inside:avoid;-moz-column-break-inside:avoid;border-radius:8px;width:103px;height:103px;border-width:2px;border-width:",";border-style:solid;border-color:",";img{width:100%;height:100%;border-radius:8px;}"],(e=>{let{selected:t}=e;return t?"2px":"0px"}),(e=>{let{selected:t,theme:o}=e;return t?o.colors.contentAccent:"transparent"}));var at=e=>{let{images:t,selectedImage:o,onImageClick:n,loading:r=!1,columns:i,style:a}=e;const l=r?[0,1,2,3].map((e=>({index:e,imagePath:`${e}`,imageUrlPreview:"",imageUrlTile:""}))):t;return(0,S.jsx)(tt,{style:a,children:l&&(0,S.jsx)(rt,{columns:i,children:null===l||void 0===l?void 0:l.map((e=>{return(0,S.jsxs)(it,{selected:(null===o||void 0===o?void 0:o.imagePath)===e.imagePath,onClick:()=>{r||n(e)},children:[!r&&(0,S.jsx)(et(),{width:"103px",height:"103px",alt:e.imagePath,src:e.imageUrlPreview,loader:(0,Le.T8)(e.imageUrlPreview),quality:50,draggable:!1,placeholder:"blur",blurDataURL:`data:image/svg+xml;base64,${i=103,a=103,t=`\n<svg width="${i}" height="${a}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n<path d="M0,0 h103 v103 h-103 v-103 a8,8 0 0 1 8,-8 z" fill="rgba(255, 255, 255, 0.1)" />\n</svg>`,window.btoa(t)}`}),r&&(0,S.jsx)(ot,{children:(0,S.jsx)(nt,{index:e.index})})]},e.imagePath);var t,i,a}))})})},lt=o(79297),st=o(71515);const ct=b.ZP.div.withConfig({displayName:"TextRowWithTip__RowContainer",componentId:"f15w2s-0"})(["display:flex;padding-top:4px;padding-bottom:8px;"]),dt=b.ZP.div.withConfig({displayName:"TextRowWithTip__TextContainer",componentId:"f15w2s-1"})(["font-size:",";line-height:16px;color:",";flex:1;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),pt=b.ZP.div.withConfig({displayName:"TextRowWithTip__TipIconContainer",componentId:"f15w2s-2"})(["width:16px;height:16px;"]);var ut=e=>{let{text:t,tipText:o}=e;return(0,S.jsxs)(ct,{children:[(0,S.jsx)(dt,{children:t}),(0,S.jsx)(pt,{children:(0,S.jsx)(st.Z,{content:o,placement:"left",tooltipStyle:{width:"235px",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"break-spaces"},children:(0,S.jsx)(lt.Z,{style:{width:16,height:16,opacity:.4}})})})]})};const mt=e=>{var t,o,n;let{disableOutpaintGeneration:r,inputRef:i,query:a,loading:l,isBalanceLoading:s,setQuery:c,data:d,onImageClick:p,cancelOutpaint:u,submitPrompt:m,applyOutpaint:g,selectedImage:h}=e;const{t:f}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ut,{text:`${f("sidebar.imageGeneration.optionalPrompt")}`,tipText:f("sidebar.imageGeneration.genericAIImageTipText")}),(0,S.jsx)(se,{children:(0,S.jsx)(le,{ref:i,value:a,placeholder:f("sidebar.imageGeneration.imagePlaceholder"),rows:3,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),m())},onChange:e=>{c(e.target.value)}})}),(l||(null===d||void 0===d||null===(t=d.outpaintImages)||void 0===t?void 0:t.images))&&(0,S.jsx)(at,{images:(null===d||void 0===d||null===(o=d.outpaintImages)||void 0===o?void 0:o.images)||[],onImageClick:p,selectedImage:h,loading:l,columns:2,style:{marginBottom:"12px"}}),(null===d||void 0===d||null===(n=d.outpaintImages)||void 0===n?void 0:n.images)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(oe,{children:(0,S.jsx)(He.Z,{onClick:g,color:"primary",style:{width:"100%"},disabled:!h,children:f("sidebar.imageGeneration.apply")})}),(0,S.jsxs)(re,{$lastItem:!0,children:[(0,S.jsx)(He.Z,{onClick:u,style:{width:"103px"},disabled:!h,children:f("cancel")}),(0,S.jsx)(He.Z,{onClick:m,style:{width:"103px"},children:f("sidebar.imageGeneration.regenerate")})]})]}),!d&&(0,S.jsx)(oe,{$lastItem:!0,children:(0,S.jsx)(He.Z,{onClick:m,style:{width:"100%"},endIcon:l?(0,S.jsx)(Ye.T,{size:16}):null,disabled:s||l||r,children:f(l?"sidebar.imageGeneration.generating":"sidebar.imageGeneration.generate")})})]})};var gt=e=>{var t;let{tileData:o}=e;const n=(0,a.useRef)(null),{0:r,1:i}=(0,a.useState)(""),{0:s,1:c}=(0,a.useState)(void 0),d=(null===o||void 0===o||null===(t=o.mediaTileData)||void 0===t?void 0:t.mediaFillType)===z.EwX.Fill,{isBalanceLoading:p,refetchCurrentCreditBalance:u,handleGenerationError:m,attemptToPerformCreditsOperation:g}=(0,Je.KW)(),[h,{data:f,error:b,loading:y}]=(0,z.mPo)({errorPolicy:"all",onCompleted:()=>{u()}});(0,a.useEffect)((()=>{m(b)}),[b,m]);const C=(0,l.Zl)((0,Q.bP)(o.id)),v=(0,a.useCallback)((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];C({tileId:o.id,url:e,prompt:t,setToFill:n})}),[C,o.id]),{id:x,tomeId:O}=o,[P,j]=(0,l.FV)(Q.mK),w=(null===P||void 0===P?void 0:P.tileWidth)??0,T=(null===P||void 0===P?void 0:P.tileHeight)??0,I=(0,a.useCallback)((()=>{c(void 0),j(null),C(null)}),[C,j]),E=(0,a.useCallback)((()=>{(0,H.Dm)(null)}),[]),_=(0,a.useCallback)((async()=>{const e=new Ke.Z(1024,1024),t=(0,Xe.q)(o);if(t){var n,r;const i=o.mediaTileData;let a;null!==i&&void 0!==i&&i.fillCropCenterX&&null!==i&&void 0!==i&&i.fillCropCenterY&&null!==i&&void 0!==i&&i.fillCropScale&&(a={posX:i.fillCropCenterX,posY:i.fillCropCenterY,scale:i.fillCropScale}),await e.drawImageUrlFromTileWithCrop(t,(null===(n=o.mediaTileData)||void 0===n?void 0:n.mediaFillType)||z.EwX.Crop,w,T,(null===(r=o.mediaTileData)||void 0===r?void 0:r.aspectRatio)||1,a);return await e.getBase64PNGData()}throw new Error("No image path found on tile")}),[o,T,w]),k=(0,a.useCallback)((async()=>{var e,t,o,r;if(y)return;const a=void 0===(null===(e=n.current)||void 0===e?void 0:e.value)||""===(null===(t=n.current)||void 0===t?void 0:t.value)?" ":null===(o=n.current)||void 0===o?void 0:o.value;g(Je.Cw.IMAGE_OUTPAINT,(async()=>{const e=await _();i(a),h({variables:{prompt:a,tileId:x,tomeId:O,sourceImageBase64:e}})})),null===(r=n.current)||void 0===r||r.blur()}),[h,_,x,O,y,g]),Z=(0,a.useCallback)((e=>{v(e.imageUrlTile,r,!0),c(e)}),[r,v]);return(0,S.jsx)(mt,{disableOutpaintGeneration:d,inputRef:n,query:r,setQuery:i,loading:y,isBalanceLoading:p(),data:f,onImageClick:Z,submitPrompt:k,cancelOutpaint:I,applyOutpaint:E,selectedImage:s})},ht=o(46075),ft=o(59361),bt=o(77206);function yt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ct(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var vt=e=>{let{tileData:t,updateTileData:o}=e;const{id:n,videoTileData:r,mediaTileData:i}=t,{autoplay:s,loop:c,url:d}=r||{},{captionStyle:p,mediaFillType:u,fillCropCenterX:m,fillCropCenterY:g,fillCropScale:h,backgroundColor:f}=i||{},b=(0,B.ye)(B.TT.NARRATION_VIDEO_OVERRIDE),C=(0,a.useRef)(null),v=(0,l.Zl)(Ae.s5),x=(0,l.Zl)(Ae.VJ),O=(0,l.Zl)((0,$e.vw)(n)),P=(0,a.useCallback)((e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];O((0,$e.aY)(t))}}),[O]),j=f||K.M2,w=u||z.EwX.Fit,T=(null===i||void 0===i?void 0:i.mediaStatus)===z.Jpv.UploadInProgress,I=(0,l.sJ)((0,bt.M)({tileId:t.id,url:d||""})),E=(0,ft.M)(i||void 0,I),_=(0,a.useCallback)((e=>{o((t=>Ct(Ct({},t),{},{mediaTileData:Ct(Ct({},t.mediaTileData),{},{captionStyle:e})}))),"none"!==p&&null!==p||"none"===e||(0,H.VY)(!0)}),[p,o]),k=(0,a.useCallback)((()=>{o((e=>{var t;return Ct(Ct({},e),{},{videoTileData:Ct(Ct({},e.videoTileData),{},{autoplay:!(null!==(t=e.videoTileData)&&void 0!==t&&t.autoplay)})})}))}),[o]),Z=(0,a.useCallback)((()=>{o((e=>{var t;return Ct(Ct({},e),{},{videoTileData:Ct(Ct({},e.videoTileData),{},{loop:!(null!==(t=e.videoTileData)&&void 0!==t&&t.loop)})})}))}),[o]),D=(0,a.useCallback)((e=>{o((t=>Ct(Ct({},t),{},{mediaTileData:Ct(Ct({},t.mediaTileData),{},{backgroundColor:e})})))}),[o]),M=(0,a.useCallback)((e=>{o((t=>Ct(Ct({},t),{},{mediaTileData:Ct(Ct({},t.mediaTileData),{},{mediaFillType:e})})))}),[o]),R=null!=m&&null!=g&&null!=h,A=(0,a.useCallback)((()=>{w!==z.EwX.Fill&&w!==z.EwX.Fit||R?M(z.EwX.Crop):(x(w),v(!0))}),[w,R,v,x,M]),L=(0,a.useCallback)((()=>{x(w),v(!0)}),[w,v,x]),{t:N}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[b&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:N("sidebar.media.muxVideoId")}),(0,S.jsx)(oe,{style:{userSelect:"text"},children:N("sidebar.media.videoId",{videoId:null===r||void 0===r?void 0:r.videoId})||"null"})]}),(0,S.jsx)(oe,{children:(0,S.jsx)(Ne.Z,{style:{width:"100%"},onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},actionText:N("sidebar.media.upload"),disabled:T})}),(0,S.jsx)(ne,{disabled:E,children:N("sidebar.media.size")}),(0,S.jsxs)(Fe,{style:{marginBottom:12},role:"listbox",children:[(0,S.jsx)(He.Z,{disabled:E,"data-testid":"video_fill_type_fit_option",selected:w===z.EwX.Fit,onClick:()=>M(z.EwX.Fit),isSegment:!0,children:N("sidebar.media.fit")}),(0,S.jsx)(He.Z,{disabled:E,"data-testid":"video_fill_type_fill_option",selected:w===z.EwX.Fill,onClick:()=>M(z.EwX.Fill),isSegment:!0,children:N("sidebar.media.fill")}),(0,S.jsx)(He.Z,{disabled:E,"data-testid":"video_fill_type_crop_option",selected:w===z.EwX.Crop,onClick:A,isSegment:!0,children:N("sidebar.media.custom")})]}),(0,S.jsxs)(re,{children:[(0,S.jsx)(He.Z,{disabled:E,onClick:L,children:N("sidebar.media.adjust")}),(0,S.jsx)(He.Z,{disabled:E,onClick:()=>(0,H.PS)(!(0,H.PS)()),children:N("sidebar.media.trim")})]}),(0,S.jsxs)(ie,{disabled:E,children:[(0,S.jsx)("label",{htmlFor:"VideoSidebarAutoplay",children:N("sidebar.media.autoplay")}),(0,S.jsx)(ht.Z,{inputId:"VideoSidebarAutoplay",width:"40px",height:"20px",onBgColor:!0,checked:!!s,disabled:E,onClick:k})]}),(0,S.jsxs)(ie,{disabled:E,children:[(0,S.jsx)("label",{htmlFor:"VideoSidebarRepeat",children:N("sidebar.media.repeat")}),(0,S.jsx)(ht.Z,{inputId:"VideoSidebarRepeat",width:"40px",height:"20px",onBgColor:!0,checked:!!c,disabled:E,onClick:Z})]}),(0,S.jsx)(ne,{disabled:E,children:N("sidebar.caption")}),(0,S.jsx)(oe,{disabled:E,"data-testid":"video_caption_input",children:(0,S.jsx)(je,{disabled:E,currentValue:p||"none",options:[{value:"none",label:N("sidebar.none")},{value:"top",label:N("sidebar.top")},{value:"bottom",label:N("sidebar.bottom")}],onChange:_,menuWidth:"100%",controlWidth:"100%"})}),(0,S.jsx)(ne,{disabled:E,children:N("sidebar.backgroundColor")}),(0,S.jsx)(oe,{$lastItem:!0,disabled:E,children:(0,S.jsx)(Re,{color:j,setColor:D,disabled:E})}),(0,S.jsx)("input",{ref:C,type:"file",accept:"video/*",onChange:P,style:{display:"none"}})]})},xt=o(90574);function Ot(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Pt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ot(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var jt=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Pt(Pt({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M12 32C12 30.8954 12.8954 30 14 30H50C51.1046 30 52 30.8954 52 32C52 33.1046 51.1046 34 50 34H14C12.8954 34 12 33.1046 12 32Z"})}))));const wt=b.ZP.div.withConfig({displayName:"Stepper__StepperWrapper",componentId:"sc-1xh2odp-0"})(["display:flex;align-items:center;border-radius:8px;width:fit-content;padding:4px;background-color:",";"],(e=>e.theme.colors.stepperBackground)),Tt=(0,b.ZP)(He.Z).withConfig({displayName:"Stepper__StepButton",componentId:"sc-1xh2odp-1"})(["min-width:24px;padding:0 0px;height:20px;","{border-radius:4px;}"],He.e),It=b.ZP.input.withConfig({displayName:"Stepper__CustomInput",componentId:"sc-1xh2odp-2"})(["background-color:transparent;height:20px;color:",";border:0;border-radius:0;padding:0;width:46px;outline:none;caret-color:",";text-align:center;display:inline-block;"],(e=>e.theme.colors.inputText),(e=>e.theme.colors.uiAccent));var Et=e=>{let{max:t=Number.MAX_SAFE_INTEGER,min:o=Number.MIN_SAFE_INTEGER,step:n=1,setValue:r,value:i}=e;const l=(0,a.useCallback)((()=>{r((e=>e+n<=t?e+n:e))}),[t,r,n]),s=(0,a.useCallback)((()=>{r((e=>e-n>=o?e-n:e))}),[o,r,n]),{t:c}=(0,y.$G)();return(0,S.jsxs)(wt,{children:[(0,S.jsx)(Tt,{onClick:s,"aria-label":c("library.stepper.ariaLabelDecreaseValue"),disabled:i-n<o,size:"small",variant:"text",iconOpacity:1,startIcon:(0,S.jsx)(jt,{style:{width:16}}),iconStyles:{margin:0}}),(0,S.jsx)(It,{value:i,readOnly:!0,autoComplete:"off",role:"spinbutton","aria-valuemin":o,"aria-valuemax":t,"aria-valuenow":i}),(0,S.jsx)(Tt,{onClick:l,"aria-label":c("library.stepper.ariaLabelIncreaseValue"),disabled:i+n>t,size:"small",variant:"text",iconOpacity:1,startIcon:(0,S.jsx)(xt.Z,{style:{width:16}}),iconStyles:{margin:0}})]})},_t=o(83926),St=o(17382),kt=o(60112),Zt=o(73849);function Dt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Mt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Dt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Rt=b.ZP.div.withConfig({displayName:"TableSidebar__StepperColumn",componentId:"sc-1kwyfv4-0"})(["padding-bottom:12px;"]);var At=e=>{var t,o,n,r;let{isSelectedTileSquare:i,tileData:l,updateTileData:s}=e;const{tableTileData:c}=l,{showTitle:d,wrapText:p}=c,u=(0,a.useMemo)((()=>{var e;return((null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.data)||[]).map((e=>e.id))}),[c]),m=(0,a.useMemo)((()=>{var e;return((null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.columns)||[]).map((e=>e.accessor))}),[c]),g=(0,a.useRef)({data:null===c||void 0===c||null===(t=c.payload)||void 0===t?void 0:t.data,columns:null===c||void 0===c||null===(o=c.payload)||void 0===o?void 0:o.columns});(0,a.useEffect)((()=>{var e;g.current.data=null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.data}),[null===c||void 0===c||null===(n=c.payload)||void 0===n?void 0:n.data]),(0,a.useEffect)((()=>{var e;g.current.columns=null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.columns}),[null===c||void 0===c||null===(r=c.payload)||void 0===r?void 0:r.columns]);const h=(0,kt.Z)(g,l.id).deselectAllCells,f=(0,a.useCallback)((e=>(0,St.Sd)(s,e)),[s]),{deleteColumn:b,deleteRow:C,insertColumn:v,insertRow:x}=(0,_t.ZP)(f,h),O=(0,a.useCallback)((()=>{s((e=>{var t;return Mt(Mt({},e),{},{tableTileData:Mt(Mt({},e.tableTileData),{},{showTitle:!(null!==e&&void 0!==e&&null!==(t=e.tableTileData)&&void 0!==t&&t.showTitle)})})}))}),[s]),P=(0,a.useCallback)((()=>{s((e=>{var t;return Mt(Mt({},e),{},{tableTileData:Mt(Mt({},e.tableTileData),{},{wrapText:!(null!==e&&void 0!==e&&null!==(t=e.tableTileData)&&void 0!==t&&t.wrapText)})})}))}),[s]),j=(0,a.useCallback)((e=>{const t=e(u.length)-u.length;t>0&&x(),t<0&&C(u[u.length-1])}),[C,x,u]),w=(0,a.useCallback)((e=>{const t=e(m.length)-m.length;t>0&&v(Zt.Hr.string),t<0&&b(m[m.length-1])}),[m,v,b]),T=(0,a.useCallback)((()=>{s((e=>{var t;const o=i()?1:2,n=Object.entries(null===(t=e.tableTileData)||void 0===t?void 0:t.columnWidths),r=1/n.length*o,a=Object.fromEntries(n.map((e=>{let[t]=e;return[t,r]})));return Mt(Mt({},e),{},{tableTileData:Mt(Mt({},e.tableTileData),{},{columnWidths:a})})}))}),[s,i]),{t:I}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,S.jsxs)(Rt,{"data-testid":"table_row_stepper",children:[(0,S.jsx)(ne,{children:I("sidebar.rows")}),(0,S.jsx)(Et,{min:1,max:100,value:u.length,setValue:j})]}),(0,S.jsxs)(Rt,{"data-testid":"table_column_stepper",children:[(0,S.jsx)(ne,{children:I("sidebar.columns")}),(0,S.jsx)(Et,{min:1,max:100,value:m.length,setValue:w})]})]}),(0,S.jsxs)(ie,{children:[(0,S.jsx)("label",{htmlFor:"TableSidebarShowTitle",children:I("sidebar.showTitle")}),(0,S.jsx)(ht.Z,{inputId:"TableSidebarShowTitle",width:"40px",height:"20px",onBgColor:!0,checked:!!d,onClick:O})]}),(0,S.jsxs)(ie,{children:[(0,S.jsx)("label",{htmlFor:"TableSidebarWrapText",children:I("sidebar.wrapText")}),(0,S.jsx)(ht.Z,{inputId:"TableSidebarWrapText",width:"40px",height:"20px",onBgColor:!0,checked:!!p,onClick:P})]}),(0,S.jsx)(oe,{$lastItem:!0,children:(0,S.jsx)(He.Z,{onClick:T,style:{width:"100%"},children:I("sidebar.distributeColumns")})})]})},Lt=o(26190),Nt=o(89030);const Ht=b.ZP.div.withConfig({displayName:"MessageWithTag__MessageContainer",componentId:"sc-12nq4be-0"})(["line-height:16px;"]),Vt=b.ZP.span.withConfig({displayName:"MessageWithTag__Message",componentId:"sc-12nq4be-1"})(["font-style:normal;font-weight:normal;font-size:11px;line-height:15px;color:",";"],(e=>e.theme.colors.contrast40));var Bt=e=>{let{message:t,tag:o}=e;return(0,S.jsxs)(Ht,{children:[(0,S.jsx)(Nt.Vp,{color:"gray",children:o})," ",(0,S.jsx)(Vt,{children:t})]})};function Ft(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function $t(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ft(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Gt=e=>{let{tileData:t,updateTileData:o}=e;const n=(0,q.An)(t.type),r=n.length>0?n[0].label:void 0,{t:i}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:i("sidebar.url")}),(0,S.jsx)(oe,{children:(0,S.jsx)(ae,{type:"text",value:t.contentLink||"",onChange:e=>{o((t=>$t($t({},t),{},{contentLink:e.target.value})))},placeholder:`${i("sidebar.embed.placeholder",r?{tileType:r,context:"tileLabel"}:{})}`,onContextMenuCapture:Lt.Z})}),r&&(0,S.jsx)(Bt,{tag:i("tag.tip"),message:`${i("sidebar.embed.message",r?{tileType:r,context:"tileLabel"}:{})}`})]})},zt=o(46513),Ut=o(99990);function Wt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Kt=(e,t)=>(0,S.jsxs)(we.Z,qt(qt({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M15.2731 27.6365C17.2814 27.6365 18.9094 26.0084 18.9094 24.0001C18.9094 21.9918 17.2814 20.3638 15.2731 20.3638C13.2648 20.3638 11.6367 21.9918 11.6367 24.0001C11.6367 26.0084 13.2648 27.6365 15.2731 27.6365Z"}),(0,S.jsx)("path",{d:"M31.2731 27.6365C33.2814 27.6365 34.9094 26.0084 34.9094 24.0001C34.9094 21.9918 33.2814 20.3638 31.2731 20.3638C29.2648 20.3638 27.6367 21.9918 27.6367 24.0001C27.6367 26.0084 29.2648 27.6365 31.2731 27.6365Z"}),(0,S.jsx)("path",{d:"M50.9094 24.0001C50.9094 26.0084 49.2814 27.6365 47.2731 27.6365C45.2648 27.6365 43.6367 26.0084 43.6367 24.0001C43.6367 21.9918 45.2648 20.3638 47.2731 20.3638C49.2814 20.3638 50.9094 21.9918 50.9094 24.0001Z"}),(0,S.jsx)("path",{d:"M15.2731 43.6365C17.2814 43.6365 18.9094 42.0084 18.9094 40.0001C18.9094 37.9918 17.2814 36.3638 15.2731 36.3638C13.2648 36.3638 11.6367 37.9918 11.6367 40.0001C11.6367 42.0084 13.2648 43.6365 15.2731 43.6365Z"}),(0,S.jsx)("path",{d:"M34.9094 40.0001C34.9094 42.0084 33.2814 43.6365 31.2731 43.6365C29.2648 43.6365 27.6367 42.0084 27.6367 40.0001C27.6367 37.9918 29.2648 36.3638 31.2731 36.3638C33.2814 36.3638 34.9094 37.9918 34.9094 40.0001Z"}),(0,S.jsx)("path",{d:"M47.2731 43.6365C49.2814 43.6365 50.9094 42.0084 50.9094 40.0001C50.9094 37.9918 49.2814 36.3638 47.2731 36.3638C45.2648 36.3638 43.6367 37.9918 43.6367 40.0001C43.6367 42.0084 45.2648 43.6365 47.2731 43.6365Z"})]}));var Yt=(0,a.forwardRef)(Kt),Jt=o(24581),Xt=o(2372);const Qt="12px",eo=(0,b.ZP)(Yt).withConfig({displayName:"SidebarTemplate__CustomDraggableIcon",componentId:"sc-1ipmnnf-0"})(["position:absolute;top:11px;left:0;right:0;margin-left:auto;margin-right:auto;fill:",";transition:fill 0.2s ease-out;"],(e=>{let{theme:t}=e;return t.colors.sidebarDraggingIcon})),to=b.ZP.div.withConfig({displayName:"SidebarTemplate__PanelHeader",componentId:"sc-1ipmnnf-1"})(["width:100%;padding-left:",";padding-right:",";padding-top:12px;padding-bottom:12px;display:flex;flex-direction:row;align-items:center;z-index:999999999;position:relative;",""],Qt,Qt,(e=>{let{$draggable:t}=e;return t&&(0,b.iv)(["&:hover{cursor:grab;& ","{fill:",";}}"],eo,(e=>{let{theme:t}=e;return t.colors.sidebarDraggingIconHover}))})),oo=b.ZP.div.withConfig({displayName:"SidebarTemplate__HeaderLabel",componentId:"sc-1ipmnnf-2"})(["font-size:",";color:",";line-height:20px;font-weight:600;flex:1;white-space:nowrap;display:flex;",";"],(e=>{let{$smallFont:t,theme:o}=e;return t?o.fontSizes.sm:o.fontSizes.smmd}),(e=>{let{theme:t}=e;return t.colors.sidebarHeaderText}),(e=>{let{$childLabel:t}=e;return t&&(0,b.iv)(["justify-content:center;width:100%;position:absolute;left:0;"])})),no=(0,b.iv)(["height:24px;width:24px;min-width:auto;"]),ro=(0,b.ZP)(He.Z).attrs({variant:"text"}).withConfig({displayName:"SidebarTemplate__CloseButton",componentId:"sc-1ipmnnf-3"})(["position:absolute;right:12px;top:10px;",""],no),io=(0,b.ZP)(ke.Z).withConfig({displayName:"SidebarTemplate__CloseButtonInteractionTarget",componentId:"sc-1ipmnnf-4"})(["position:absolute;right:0px;top:0px;height:40px;width:38px;cursor:pointer;"]),ao=(0,b.ZP)(He.Z).withConfig({displayName:"SidebarTemplate__SidebarHeaderButton",componentId:"sc-1ipmnnf-5"})([""," margin-left:-4px;z-index:",";"],no,T.Mf+1),lo=b.ZP.div.withConfig({displayName:"SidebarTemplate__PanelContent",componentId:"sc-1ipmnnf-6"})(["padding:",";"],(e=>e.$noPadding?"0px":"8px 12px 12px 12px")),so=(0,b.ZP)(Nt.Ur).withConfig({displayName:"SidebarTemplate__SidebarBetaTag",componentId:"sc-1ipmnnf-7"})([":first-child{line-height:100%;margin:3px 0 3px 6px;}"]);var co=(0,a.forwardRef)(((e,t)=>{let{hasHeader:o,headerText:n,contentNoPadding:r,panelContent:i,headerBetaTag:l=!1,draggable:s,startDrag:c}=e;const d=(0,E.Z5)(),p=(0,E.t2)(),[u,m]=a.useState(!1),g=(0,a.useCallback)((e=>{s&&c&&(c(e),m(!0))}),[s,c]),h=(0,a.useCallback)((()=>{m(!1)}),[]),f=(0,zt.E)(),b=(0,a.useCallback)((()=>{f.start("hover")}),[f]),C=(0,a.useCallback)((()=>{f.start("default")}),[f]),v=(0,a.useCallback)((()=>{f.start("active"),p.closePropertyPanel()}),[f,p]),{t:x}=(0,y.$G)();return(0,S.jsxs)("div",{ref:t,children:[o&&(0,S.jsxs)(to,{onPointerDown:g,onPointerUp:h,$draggable:s,children:[d>1&&(0,S.jsx)(ao,{variant:"text",size:"small","data-testid":"property_panel_back_button",startIcon:(0,S.jsx)(Ut.Z,{style:{height:20,width:20}}),iconStyles:{margin:0},onClick:p.popPropertyPanel}),(0,S.jsxs)(oo,{"data-testid":"property_panel_header_label",$smallFont:!!s,$childLabel:d>1,children:[n,l&&(0,S.jsx)(so,{})]}),s&&(0,S.jsxs)(S.Fragment,{children:[d<=1&&(0,S.jsx)(eo,{style:{width:22,height:22}}),(0,S.jsx)(ro,{size:"small",animationControls:f,iconStyles:{margin:0},icon:(0,S.jsx)(Jt.Z,{style:{width:22,height:22}}),iconOpacity:.2}),(0,S.jsx)(io,{"aria-label":x("sidebar.closePanel"),onMouseOver:b,onMouseOut:C,onClick:v})]})]}),(0,S.jsx)(lo,{$noPadding:r,children:i}),u&&(0,S.jsx)(Xt.Z,{})]})})),po=o(50576),uo=o(59764),mo=o(32579);var go=()=>{const{activeEditorRef:e}=(0,a.useContext)(uo.f);return(0,l.sJ)(mo.Z),e.current},ho=o(69029),fo=o(12459),bo=o(96375),yo=o(65111);function Co(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function vo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Co(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var xo=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,vo(vo({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,S.jsx)("path",{d:"M12 32C12 30.8954 12.8954 30 14 30H38C39.1046 30 40 30.8954 40 32C40 33.1046 39.1046 34 38 34H14C12.8954 34 12 33.1046 12 32Z"}),(0,S.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function Oo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Po(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Oo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Oo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var jo=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Po(Po({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,S.jsx)("path",{d:"M18 32C18 30.8954 18.8954 30 20 30H44C45.1046 30 46 30.8954 46 32C46 33.1046 45.1046 34 44 34H20C18.8954 34 18 33.1046 18 32Z"}),(0,S.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function wo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function To(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):wo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Io=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,To(To({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,S.jsx)("path",{d:"M24 32C24 30.8954 24.8954 30 26 30H50C51.1046 30 52 30.8954 52 32C52 33.1046 51.1046 34 50 34H26C24.8954 34 24 33.1046 24 32Z"}),(0,S.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function Eo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function _o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Eo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Eo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var So=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,_o(_o({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M14 18C12.8954 18 12 18.8954 12 20C12 21.1046 12.8954 22 14 22H50C51.1046 22 52 21.1046 52 20C52 18.8954 51.1046 18 50 18H14Z"}),(0,S.jsx)("path",{d:"M33.4142 33.5858C32.6332 32.8047 31.3668 32.8047 30.5858 33.5858L22.5858 41.5858C21.8047 42.3668 21.8047 43.6332 22.5858 44.4142C23.3668 45.1953 24.6332 45.1953 25.4142 44.4142L32 37.8284L38.5858 44.4142C39.3668 45.1953 40.6332 45.1953 41.4142 44.4142C42.1953 43.6332 42.1953 42.3668 41.4142 41.5858L33.4142 33.5858Z"})]}))));function ko(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Zo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ko(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ko(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Do=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Zo(Zo({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M33.4142 24.4142L41.4142 16.4142C42.1953 15.6332 42.1953 14.3668 41.4142 13.5858C40.6332 12.8047 39.3668 12.8047 38.5858 13.5858L32 20.1716L25.4142 13.5858C24.6332 12.8047 23.3668 12.8047 22.5858 13.5858C21.8047 14.3668 21.8047 15.6332 22.5858 16.4142L30.5858 24.4142C31.3668 25.1953 32.6332 25.1953 33.4142 24.4142Z"}),(0,S.jsx)("path",{d:"M12 32C12 33.1046 12.8954 34 14 34H50C51.1046 34 52 33.1046 52 32C52 30.8954 51.1046 30 50 30H14C12.8954 30 12 30.8954 12 32Z"}),(0,S.jsx)("path",{d:"M41.4142 47.5858L33.4142 39.5858C32.6332 38.8047 31.3668 38.8047 30.5858 39.5858L22.5858 47.5858C21.8047 48.3668 21.8047 49.6332 22.5858 50.4142C23.3668 51.1953 24.6332 51.1953 25.4142 50.4142L32 43.8284L38.5858 50.4142C39.3668 51.1953 40.6332 51.1953 41.4142 50.4142C42.1953 49.6332 42.1953 48.3668 41.4142 47.5858Z"})]}))));function Mo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ro(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Mo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Ao=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Ro(Ro({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M41.4142 22.4142L33.4142 30.4142C32.6332 31.1953 31.3668 31.1953 30.5858 30.4142L22.5858 22.4142C21.8047 21.6332 21.8047 20.3668 22.5858 19.5858C23.3668 18.8047 24.6332 18.8047 25.4142 19.5858L32 26.1716L38.5858 19.5858C39.3668 18.8047 40.6332 18.8047 41.4142 19.5858C42.1953 20.3668 42.1953 21.6332 41.4142 22.4142Z"}),(0,S.jsx)("path",{d:"M14 46C12.8954 46 12 45.1046 12 44C12 42.8954 12.8954 42 14 42H50C51.1046 42 52 42.8954 52 44C52 45.1046 51.1046 46 50 46H14Z"})]})))),Lo=o(24603),No=o(40105);function Ho(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Vo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ho(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Bo=(e,t)=>Vo(Vo({},e),{},{textTileData:Vo(Vo({},e.textTileData),t)}),Fo=o(767),$o=o(49279);const Go=(0,b.ZP)(He.Z).attrs($o.S7).withConfig({displayName:"SlateTextSidebar__TextStyleButton",componentId:"uc20ao-0"})(["width:50%;"]),zo=(0,b.ZP)(oe).withConfig({displayName:"SlateTextSidebar__TextStyleRow",componentId:"uc20ao-1"})(["position:relative;display:flex;margin-bottom:8px;"," + ","{margin-left:8px;}:last-child{margin-bottom:0;}"],Go,Go),Uo=(0,b.ZP)(Go).withConfig({displayName:"SlateTextSidebar__DisplayButton",componentId:"uc20ao-2"})(["font-size:17px;font-weight:600;"]),Wo=(0,b.ZP)(Go).withConfig({displayName:"SlateTextSidebar__TitleButton",componentId:"uc20ao-3"})(["font-size:16px;font-weight:600;"]),qo=(0,b.ZP)(Go).withConfig({displayName:"SlateTextSidebar__HeadingButton",componentId:"uc20ao-4"})(["font-size:14.5px;font-weight:600;"]),Ko=(0,b.ZP)(Go).withConfig({displayName:"SlateTextSidebar__SubheadingButton",componentId:"uc20ao-5"})(["font-size:13px;font-weight:600;"]),Yo=(0,b.ZP)("span").withConfig({displayName:"SlateTextSidebar__GroupLabel",componentId:"uc20ao-6"})(["display:flex;color:",";font-size:",";margin-top:12px;margin-bottom:8px;:first-child{margin-top:0;}"],(e=>e.theme.colors.commentEditorPlaceholder),(e=>e.theme.fontSizes.xxs)),Jo=(0,b.ZP)(Go).attrs($o.S7).withConfig({displayName:"SlateTextSidebar__BodyButton",componentId:"uc20ao-7"})(["font-size:13px;font-weight:400;svg{width:24px;height:24px;}"]),Xo=(0,b.ZP)(Go).attrs($o.S7).withConfig({displayName:"SlateTextSidebar__CaptionButton",componentId:"uc20ao-8"})(["font-size:11px;font-weight:400;"]),Qo=(0,b.ZP)(He.Z).attrs($o.S7).withConfig({displayName:"SlateTextSidebar__AlignmentButton",componentId:"uc20ao-9"})(["svg{width:24px;height:24px;}"]),en=(0,b.ZP)(Fe).attrs($o.Jo).withConfig({displayName:"SlateTextSidebar__StyledSegmentedControls",componentId:"uc20ao-10"})(["margin-bottom:8px;:last-child{margin-bottom:0;}"]);var tn=e=>{var t,o;let{tileData:n,updateTileData:r}=e;const i=go(),{t:a}=(0,y.$G)(),l=(0,No.Z)((function(){let{vertical:e,horizontal:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>{r((o=>{var n,r;return Bo(o,{verticalAlignment:e||(null===(n=o.textTileData)||void 0===n?void 0:n.verticalAlignment),horizontalAlignment:t||(null===(r=o.textTileData)||void 0===r?void 0:r.horizontalAlignment)})}))}}),[r]),s=(0,B.ye)(B.TT.TEXT_COLOR_SIDEBAR);if(null===i||void 0===i||!i.children.length)return null;const c=(0,Lo.oA)(null===(t=n.textTileData)||void 0===t?void 0:t.horizontalAlignment),d=(0,Lo.xZ)(null===(o=n.textTileData)||void 0===o?void 0:o.verticalAlignment),p=(0,ho.Hk)(i),u=(0,ho.Lk)(i,p);return(0,S.jsxs)("div",{"data-testid":"text_sidebar",children:[(0,S.jsx)(Yo,{children:a("sidebar.alignment")}),(0,S.jsxs)(en,{role:"listbox",children:[(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({horizontal:z.KxP.Leading}),"aria-selected":c===z.KxP.Leading,selected:c===z.KxP.Leading,startIcon:(0,S.jsx)(xo,{})}),(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({horizontal:z.KxP.Center}),"aria-selected":c===z.KxP.Center,selected:c===z.KxP.Center,startIcon:(0,S.jsx)(jo,{})}),(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({horizontal:z.KxP.Trailing}),"aria-selected":c===z.KxP.Trailing,selected:c===z.KxP.Trailing,startIcon:(0,S.jsx)(Io,{})})]}),(0,S.jsxs)(en,{role:"listbox",children:[(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({vertical:z.Q4P.Top}),"aria-selected":d===z.Q4P.Top,selected:d===z.Q4P.Top,startIcon:(0,S.jsx)(So,{})}),(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({vertical:z.Q4P.Center}),"aria-selected":d===z.Q4P.Center,selected:d===z.Q4P.Center,startIcon:(0,S.jsx)(Do,{})}),(0,S.jsx)(Qo,{isSegment:!0,role:"option",onClick:l({vertical:z.Q4P.Bottom}),"aria-selected":d===z.Q4P.Bottom,selected:d===z.Q4P.Bottom,startIcon:(0,S.jsx)(Ao,{})})]}),(0,S.jsx)(Yo,{children:a("sidebar.style")}),(0,S.jsxs)(zo,{children:[(0,S.jsx)(Uo,{"data-testid":"sidebar_button_display",selected:(0,po.Z)(u,[fo.L$]),onClick:()=>{(0,ho.U9)(i,fo.L$,!0)},children:a("sidebar.display")}),(0,S.jsx)(Wo,{"data-testid":"sidebar_button_title",selected:(0,po.Z)(u,[fo.Ch]),onClick:()=>{(0,ho.U9)(i,fo.Ch,!0)},children:a("sidebar.title")})]}),(0,S.jsxs)(zo,{children:[(0,S.jsx)(qo,{"data-testid":"sidebar_button_heading",selected:(0,po.Z)(u,[fo.r3]),onClick:()=>{(0,ho.U9)(i,fo.r3,!0)},children:a("sidebar.heading")}),(0,S.jsx)(Ko,{"data-testid":"sidebar_button_subheading",selected:(0,po.Z)(u,[fo.yq]),onClick:()=>{(0,ho.U9)(i,fo.yq,!0)},children:a("sidebar.subheading")})]}),(0,S.jsxs)(zo,{children:[(0,S.jsx)(Jo,{"data-testid":"sidebar_button_body",selected:(0,po.Z)(u,[fo.JB]),onClick:()=>{(0,ho.U9)(i,fo.JB,!0)},children:a("sidebar.body")}),(0,S.jsx)(Xo,{"data-testid":"sidebar_button_caption",selected:(0,po.Z)(u,[fo.Oo]),onClick:()=>{(0,ho.U9)(i,fo.Oo,!0)},children:a("sidebar.caption")})]}),(0,S.jsx)(Yo,{children:a("sidebar.lists")}),(0,S.jsxs)(zo,{children:[(0,S.jsx)(Jo,{"data-testid":"sidebar_button_bulleted",selected:(0,ho.ku)(i,fo.qR),onClick:()=>{(0,ho.th)(i,fo.qR,!0)},startIcon:(0,S.jsx)(bo.Z,{})}),(0,S.jsx)(Jo,{"data-testid":"sidebar_button_numbered",selected:(0,ho.ku)(i,fo.y1),onClick:()=>{(0,ho.th)(i,fo.y1,!0)},startIcon:(0,S.jsx)(yo.Z,{})})]}),s&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Yo,{children:a("sidebar.colors")}),(0,S.jsx)(zo,{children:(0,S.jsx)(Fo.EL,{onChange:e=>(0,ho.z_)(i,e),editor:i})})]})]})};const on=b.ZP.div.withConfig({displayName:"ImageGenerationHistory__ScrollablePanel",componentId:"sc-12p6rpn-0"})(["max-height:600px;overflow:auto;"]),nn=b.ZP.div.withConfig({displayName:"ImageGenerationHistory__RecordRow",componentId:"sc-12p6rpn-1"})([""]),rn=(0,b.ZP)(te).withConfig({displayName:"ImageGenerationHistory__MinHeightPanelContent",componentId:"sc-12p6rpn-2"})(["height:432px;"]),an=(0,b.ZP)(ne).withConfig({displayName:"ImageGenerationHistory__RecordRowText",componentId:"sc-12p6rpn-3"})(["line-height:14px;height:auto;font-weight:400;padding:0px;margin-top:12px;margin-bottom:6px;user-select:text;cursor:text;&::selection{background-color:",";}"],(e=>e.theme.colors.textSelection)),ln=e=>{let{record:t,setImage:o}=e;const n=(0,a.useCallback)((e=>{o({url:e.imagePath,prompt:t.prompt,generationId:t.id,generationCandidates:t.images||[],negativePrompt:t.negativePrompt??null,dimensionType:t.dimensionType??null})}),[o,t.prompt,t.id,t.images,t.negativePrompt,t.dimensionType]);return(0,S.jsxs)(nn,{children:[(0,S.jsx)(an,{children:`"${t.prompt}"`}),(0,S.jsx)(at,{images:t.images||[],onImageClick:n,columns:2})]})};var sn=e=>{var t,o;let{setImage:n}=e;const{loading:r,data:i}=(0,z.Z5V)({fetchPolicy:"network-only"});return r?(0,S.jsx)(rn,{children:(0,S.jsx)(Ye.Z,{shouldCenter:!0})}):i?(0,S.jsx)(te,{children:(0,S.jsx)(on,{children:null===(t=i.me)||void 0===t||null===(o=t.imageGenerationRecords)||void 0===o?void 0:o.map((e=>(0,S.jsx)(ln,{record:e,setImage:n},e.id)))})}):null};function cn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function dn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):cn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var pn=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,dn(dn({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M34 20C34 18.8954 33.1046 18 32 18C30.8954 18 30 18.8954 30 20V32C30 32.5304 30.2107 33.0391 30.5858 33.4142L39.0858 41.9142C39.8668 42.6953 41.1332 42.6953 41.9142 41.9142C42.6953 41.1332 42.6953 39.8668 41.9142 39.0858L34 31.1716V20Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]}))));const un=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__RowContainer",componentId:"sc-1pl7ah3-0"})(["display:flex;padding-top:4px;padding-bottom:8px;"]),mn=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__TextContainer",componentId:"sc-1pl7ah3-1"})(["font-size:",";line-height:20px;color:",";flex:1;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),gn=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__TipIconContainer",componentId:"sc-1pl7ah3-2"})(["width:20px;height:20px;"]);var hn=e=>{let{text:t,icon:o,onIconClick:n,tooltipText:r}=e;return(0,S.jsxs)(un,{children:[(0,S.jsx)(mn,{children:t}),(0,S.jsx)(gn,{children:(0,S.jsx)(st.Z,{content:r,placement:"left",children:(0,S.jsx)(He.Z,{variant:"text",size:"small",icon:o,onClick:n,style:{padding:3,minWidth:"unset",height:"unset"}})})})]})};const fn=(0,b.ZP)(le).withConfig({displayName:"ImageGenerationSidebar__PromptInput",componentId:"sc-19689mv-0"})(["height:132px;"]),bn=(0,b.ZP)(le).withConfig({displayName:"ImageGenerationSidebar__NegativePromptInput",componentId:"sc-19689mv-1"})(["height:34px;"]);var yn=e=>{var t,o,n,r,i;let{tomeId:s,tileData:c,setImage:d,advancedSettingsVisible:p=!1}=e;const u=(0,B.ye)(B.TT.IMAGE_TILE_ADVANCED_SETTINGS),m=(0,a.useRef)(null),g=(0,a.useRef)(null),h=c.id,f=(null===(t=c.imageTileData)||void 0===t?void 0:t.usedCustomNegativePrompt)??!1,b=p||!(null===(o=c.imageTileData)||void 0===o||!o.dimensionType)&&c.imageTileData.dimensionType!==z.h7B.Square||!(null===(n=c.imageTileData)||void 0===n||!n.negativePrompt)&&f,{0:C,1:v}=(0,a.useState)(b),{0:x,1:O}=(0,a.useState)((null===(r=c.imageTileData)||void 0===r?void 0:r.dimensionType)||z.h7B.Square),{0:P,1:j}=(0,a.useState)(f&&(null===(i=c.imageTileData)||void 0===i?void 0:i.negativePrompt)||""),[w,T]=(0,l.FV)((0,Q.L2)(h)),[I,k]=(0,l.FV)((0,Q.xZ)(h)),Z=(0,a.useRef)(),[D,M]=(0,l.FV)((0,Q.j3)(h)),{isBalanceLoading:R,refetchCurrentCreditBalance:A,attemptToPerformCreditsOperation:L,handleGenerationError:N}=(0,Je.KW)(),[H,{loading:V,error:F}]=(0,z.Lre)({errorPolicy:"all",onCompleted:e=>{var t,o,n;(A(),e.generateImages&&Z.current)&&(k({prevGenerationId:(null===(t=c.imageTileData)||void 0===t?void 0:t.generationId)||"",generationId:(null===e||void 0===e||null===(o=e.generateImages)||void 0===o?void 0:o.id)||"",prompt:Z.current,images:(null===e||void 0===e||null===(n=e.generateImages)||void 0===n?void 0:n.images)||[],negativePrompt:P,dimensionType:x,usedCustomNegativePrompt:f}),Z.current=void 0)}});(0,a.useEffect)((()=>{N(F)}),[F,N]),(0,a.useEffect)((()=>{D&&(M(null),T(D),L(Je.Cw.DALLE_TILE,(()=>{Z.current=D,H({variables:{prompt:D,tileId:h,tomeId:s}})})))}),[D,M,h,s,H,T,L]),(0,a.useEffect)((()=>{var e,t,o,n,r,i,a,l,s,d,p;null!==(e=c.imageTileData)&&void 0!==e&&e.prompt&&(!I&&!w||null!==(t=c.imageTileData)&&void 0!==t&&t.generationId&&(null===(o=c.imageTileData)||void 0===o?void 0:o.generationId)!==(null===I||void 0===I?void 0:I.prevGenerationId))&&(T(null===(n=c.imageTileData)||void 0===n?void 0:n.prompt),k({prevGenerationId:(null===(r=c.imageTileData)||void 0===r?void 0:r.generationId)||"",generationId:(null===(i=c.imageTileData)||void 0===i?void 0:i.generationId)||"",prompt:null===(a=c.imageTileData)||void 0===a?void 0:a.prompt,images:(null===(l=c.imageTileData)||void 0===l?void 0:l.generationCandidates)||[],negativePrompt:(null===(s=c.imageTileData)||void 0===s?void 0:s.negativePrompt)||"",usedCustomNegativePrompt:(null===(d=c.imageTileData)||void 0===d?void 0:d.usedCustomNegativePrompt)??!1,dimensionType:(null===(p=c.imageTileData)||void 0===p?void 0:p.dimensionType)||z.h7B.Square}))}),[]),(0,a.useEffect)((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),[]);const $=(0,a.useCallback)((()=>{var e,t,o;if(V)return;null===(e=m.current)||void 0===e||e.blur();const n=null===(t=m.current)||void 0===t?void 0:t.value;if(!n)return;const r=(null===(o=g.current)||void 0===o?void 0:o.value)??"",i=x;L(Je.Cw.DALLE_TILE,(()=>{T(n),Z.current=n,H({variables:{prompt:n,tileId:h,tomeId:s,advancedOptions:{negativePrompt:r,dimension:i}}})}))}),[V,x,L,T,H,h,s]),G=(0,E.t2)(),U=(0,a.useCallback)((()=>{G.pushPropertyPanel(_.Z.IMAGE_GENERATION_HISTORY)}),[G]),W=(0,a.useCallback)((e=>{null!==I&&void 0!==I&&I.generationId&&null!==I&&void 0!==I&&I.prompt&&d({url:e.imagePath,prompt:null===I||void 0===I?void 0:I.prompt,generationId:null===I||void 0===I?void 0:I.generationId,generationCandidates:null===I||void 0===I?void 0:I.images,negativePrompt:(null===I||void 0===I?void 0:I.negativePrompt)??null,dimensionType:null===I||void 0===I?void 0:I.dimensionType})}),[d,I]),q=(0,a.useCallback)((e=>{O(e)}),[]),{t:K}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(hn,{text:K("sidebar.imageGeneration.prompt"),tooltipText:K("sidebar.imageGeneration.historyTooltip"),icon:(0,S.jsx)(pn,{}),onIconClick:U}),(0,S.jsx)(se,{children:(0,S.jsx)(fn,{ref:m,value:w,placeholder:K("sidebar.imageGeneration.imagePlaceholder"),rows:3,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),$())},onChange:e=>{T(e.target.value)}})}),(V||(null===I||void 0===I?void 0:I.images)&&I.images.length>1)&&(0,S.jsx)(at,{images:(null===I||void 0===I?void 0:I.images)||[],onImageClick:W,loading:!!w&&V,columns:2,style:{marginBottom:"12px"}}),u&&(0,S.jsxs)(ie,{children:[(0,S.jsx)("label",{htmlFor:"AdvancedSettingsToggle",children:K("sidebar.media.advanced")}),(0,S.jsx)(ht.Z,{inputId:"AdvancedSettingsToggle",width:"40px",height:"20px",onBgColor:!0,checked:C,disabled:!1,onClick:()=>{v(!C)}})]}),C&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:K("sidebar.imageGeneration.negativePrompt")}),(0,S.jsx)(se,{children:(0,S.jsx)(bn,{ref:g,value:P,placeholder:K("sidebar.imageGeneration.negativePromptPlaceholder"),rows:1,onChange:e=>{j(e.target.value)}})}),(0,S.jsx)(ne,{children:K("sidebar.imageGeneration.dimension")}),(0,S.jsx)(oe,{disabled:!1,"data-testid":"video_caption_input",children:(0,S.jsx)(je,{disabled:!1,currentValue:x,options:[{value:z.h7B.Square,label:"Square 1:1"},{value:z.h7B.Widescreen,label:"Widescreen 16:9"},{value:z.h7B.Ultrawide,label:"Ultrawide 21:9"},{value:z.h7B.Vertical,label:"Vertical 9:16"},{value:z.h7B.Portrait,label:"Portrait 4:5"}],onChange:q,menuWidth:"100%",controlWidth:"100%"})})]}),(0,S.jsx)(oe,{children:(0,S.jsx)(He.Z,{onClick:$,style:{width:"100%"},disabled:V||R(),children:K("sidebar.imageGeneration.generate")})})]})},Cn=o(99747),vn=o(54232),xn=o(85671),On=o(7996);var Pn=()=>{const e=go(),t=(0,On.Oz)(),o=(0,a.useCallback)((t=>{e&&((0,ho.z_)(e,t),requestAnimationFrame((()=>{(0,Cn.$Rk)(e)})))}),[e]),n=(0,On.px)({editor:e}),r=(0,l.Zl)(xn.k);(0,a.useEffect)((()=>(r(!0),()=>{r(!1)})),[r]);const i=(0,a.useCallback)((()=>{const e=n();return e.length?e[0]:"white"}),[n]);return(0,S.jsx)(vn.default,{color:i(),setColor:o,setColorComplete:t})};function jn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):jn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Tn=m()((()=>Promise.resolve().then(o.bind(o,54232))),{loadableGenerated:{webpack:()=>[54232]}}),In=e=>{var t,o,n;let{tomeId:r,tile:i,currentPanel:s,draggable:c,startDrag:d}=e;const{apolloClient:p,clientId:u}=(0,N.bp)(),m=function(){const{query:{debug:e}}=(0,g.useRouter)();return"true"===e}(),{tileData:h,updateTileData:f}=(0,U.Z)(i,r),b=(0,l.Zl)((0,Q.L2)(i.id)),C=(0,l.Zl)((0,Q.xZ)(i.id)),{getActiveController:v}=(0,a.useContext)(X.Z),x=v(),O=(0,a.useCallback)((()=>!x.isSingleTile(i.id)),[x,i.id]),P=(0,a.useCallback)((e=>{f((t=>wn(wn({},t),{},{mediaTileData:wn(wn({},t.mediaTileData),{},{backgroundColor:e})})))}),[f]),j=(0,a.useCallback)((e=>{var t,o;let{url:n,prompt:r,generationId:i,generationCandidates:a,negativePrompt:l,dimensionType:s}=e;f((e=>wn(wn({},e),{},{contentLink:n,imageAttributes:wn(wn({},e.imageAttributes),{},{imagePath:n}),imageTileData:wn(wn({},e.imageTileData),{},{prompt:r,generationId:i,generationCandidates:a,negativePrompt:l,dimensionType:s}),mediaTileData:wn(wn({},e.mediaTileData),{},{aspectRatio:null,fillCropCenterX:null,fillCropCenterY:null,fillCropScale:null,mediaFillType:z.EwX.Fill,mediaStatus:z.Jpv.Ready}),fileUploadTileData:{uploadId:null,createdAt:null}}))),b(r),C({prevGenerationId:(null===h||void 0===h||null===(t=h.imageTileData)||void 0===t?void 0:t.generationId)||"",generationId:i,prompt:r,images:a,negativePrompt:l||null,dimensionType:s||z.h7B.Square,usedCustomNegativePrompt:(null===h||void 0===h||null===(o=h.imageTileData)||void 0===o?void 0:o.usedCustomNegativePrompt)??!1})}),[f,b,C,null===h||void 0===h||null===(t=h.imageTileData)||void 0===t?void 0:t.generationId,null===h||void 0===h||null===(o=h.imageTileData)||void 0===o?void 0:o.usedCustomNegativePrompt]),w=(0,a.useCallback)((e=>{(0,Y.Gs)(e,p,u)}),[p,u]),T=(0,a.useMemo)((()=>(0,G.Z)((e=>w(e)),300)),[w]),I=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(W.Z,{data:h,saveData:q.KS.includes(h.type)?T:w}),s===_.Z.COLOR_PICKER&&((0,K.ck)(i.type)||i.type===z.YUT.Video)&&(0,S.jsx)(Tn,{color:(null===(n=h.mediaTileData)||void 0===n?void 0:n.backgroundColor)||K.M2,setColor:P}),s===_.Z.TEXT_COLOR_PICKER&&(0,S.jsx)(Pn,{}),s===_.Z.IMAGE_GENERATION_HISTORY&&i&&(0,S.jsx)(sn,{setImage:j}),s===_.Z.IMAGE_EDIT&&i&&(0,S.jsx)(te,{children:(0,S.jsx)(qe,{tileData:h,updateTileData:f})}),s===_.Z.OUTPAINTING&&i&&(0,S.jsx)(te,{children:(0,S.jsx)(gt,{tileData:h})}),s===_.Z.IMAGE_CREATE&&i&&(0,S.jsx)(te,{children:(0,S.jsx)(yn,{tomeId:r,tileData:h,setImage:j})}),s===_.Z.TILE&&i&&(0,S.jsxs)(S.Fragment,{children:[m&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:"id"}),(0,S.jsx)(oe,{children:h.id}),(0,S.jsx)(ne,{children:"URL"}),(0,S.jsx)(oe,{children:h.contentLink})]}),("TEXT"===i.type||"TEXT_SLATE"===i.type)&&(0,S.jsx)(tn,{tileData:h,updateTileData:f}),("IMAGE"===i.type||"GIPHY"===i.type||"IMAGE_GENERATIVE"===i.type)&&(0,S.jsx)(qe,{tileData:h,updateTileData:f}),"VIDEO"===i.type&&(0,S.jsx)(vt,{tileData:h,updateTileData:f}),"TABLE"===i.type&&(0,S.jsx)(At,{tileData:h,updateTileData:f,isSelectedTileSquare:O}),q.KS.includes(i.type)&&(0,S.jsx)(Gt,{tileData:h,updateTileData:f})]})]});let E=s,k=!1;if(s===_.Z.TILE){const e=(0,q.An)(i.type)[0];E=null===e||void 0===e?void 0:e.label,k=!(null===e||void 0===e||!e.beta)}else s===_.Z.COLOR_PICKER?E="Background Color":s===_.Z.TEXT_COLOR_PICKER?E="Text Color":s===_.Z.IMAGE_GENERATION_HISTORY?E="History":s===_.Z.IMAGE_EDIT?E="Edit Image":s===_.Z.OUTPAINTING?(E="Outpainting",k=!0):s===_.Z.IMAGE_CREATE&&(E="Create image");const{t:Z}=(0,y.$G)();return(0,S.jsx)(co,{hasHeader:!0,headerText:`${Z("sidebar.header",{header:E})}`,contentNoPadding:s!==_.Z.TILE,panelContent:I,headerBetaTag:k,draggable:c,startDrag:d})};var En=e=>{let{tomeId:t,currentPanel:o,draggable:n,startDrag:r}=e;const i=(0,c.l)(H.Dm);return i?(0,S.jsx)(J.Z,{id:i,children:e=>e?(0,S.jsx)(In,{tomeId:t,tile:e,currentPanel:o,draggable:n,startDrag:r}):null}):null},_n=o(68652),Sn=o(47250),kn=o(97210);function Zn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Dn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Zn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Mn=(e,t)=>(0,S.jsx)(we.Z,Dn(Dn({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M32.423 42C42.7214 42 49.8333 33.6184 49.8333 31C49.8333 28.3687 42.7086 20 32.423 20C22.2649 20 15 28.3687 15 31C15 33.6184 22.2522 42 32.423 42ZM32.423 39.972C24.0238 39.972 17.2305 32.8098 17.2305 31C17.2305 29.4726 24.0238 22.028 32.423 22.028C40.7841 22.028 47.6029 29.4726 47.6029 31C47.6029 32.8098 40.7841 39.972 32.423 39.972ZM32.423 38.1879C36.3869 38.1879 39.5732 34.9148 39.5732 31C39.5732 26.9825 36.3869 23.8121 32.423 23.8121C28.4337 23.8121 25.2346 26.9825 25.2473 31C25.2728 34.9148 28.4337 38.1879 32.423 38.1879ZM32.423 33.3874C31.0975 33.3874 30.0269 32.3092 30.0269 31C30.0269 29.6779 31.0975 28.6126 32.423 28.6126C33.7358 28.6126 34.8064 29.6779 34.8064 31C34.8064 32.3092 33.7358 33.3874 32.423 33.3874Z"})}));var Rn=(0,a.forwardRef)(Mn);function An(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ln(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?An(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):An(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Nn=(e,t)=>(0,S.jsx)(we.Z,Ln(Ln({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M33.4509 16.4508C33.4509 15.6671 32.7877 15 31.9917 15C31.2123 15 30.5491 15.6671 30.5491 16.4508V21.3203C30.5491 22.1041 31.2123 22.7712 31.9917 22.7712C32.7877 22.7712 33.4509 22.1041 33.4509 21.3203V16.4508ZM22.5564 25.6728C23.1202 26.2398 24.0488 26.2398 24.596 25.6728C25.1598 25.1225 25.1598 24.1886 24.596 23.6216L21.1967 20.1863C20.6495 19.636 19.7209 19.6193 19.1571 20.1697C18.6099 20.72 18.6099 21.6538 19.1571 22.2208L22.5564 25.6728ZM39.205 23.7884C38.6578 24.3554 38.6578 25.2893 39.205 25.8396C39.7688 26.4066 40.714 26.4066 41.2612 25.8396L44.6771 22.4043C45.2409 21.8373 45.2409 20.9034 44.6771 20.3364C44.1299 19.7861 43.2013 19.7861 42.6541 20.3364L39.205 23.7884ZM30.6817 44.6838C30.6651 45.3342 31.4279 45.5343 31.8425 45.1174L34.363 42.5659L37.1985 49.62C37.3312 49.9202 37.6794 50.0869 37.9779 49.9535L39.6195 49.3031C39.918 49.153 40.0341 48.8028 39.8848 48.5027L36.9 41.5653L40.4818 41.4152C41.1119 41.3819 41.4104 40.7815 40.9627 40.2979L31.9088 30.9425C31.4777 30.509 30.8475 30.7424 30.831 31.3594L30.6817 44.6838ZM15.4427 31.6429C14.6633 31.6429 14 32.31 14 33.0938C14 33.8776 14.6633 34.5446 15.4427 34.5446H20.3012C21.0972 34.5446 21.7605 33.8776 21.7605 33.0938C21.7605 32.31 21.0972 31.6429 20.3012 31.6429H15.4427ZM48.5408 34.5446C49.3367 34.5446 50 33.8776 50 33.0938C50 32.31 49.3367 31.6429 48.5408 31.6429H43.6988C42.9194 31.6429 42.2561 32.31 42.2561 33.0938C42.2561 33.8776 42.9194 34.5446 43.6988 34.5446H48.5408ZM19.3063 43.7833C18.7591 44.3336 18.7591 45.2841 19.2897 45.8345C19.8369 46.3848 20.7821 46.4015 21.3459 45.8511L24.7619 42.4158C25.3257 41.8655 25.3257 40.9316 24.7619 40.3646C24.2312 39.8143 23.286 39.8143 22.7222 40.3646L19.3063 43.7833Z"})}));var Hn=(0,a.forwardRef)(Nn);function Vn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Bn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Vn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Fn=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Bn(Bn({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M56 32.6667H8V31.3333H56V32.6667Z"})})))),$n=o(19614);function Gn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function zn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Gn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Un=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorSelector",componentId:"ts0vn9-0"})(["display:grid;grid-template-columns:repeat(4,24px);column-gap:10px;margin-bottom:16px;"]),Wn=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorWrap",componentId:"ts0vn9-1"})(["position:relative;width:24px;height:24px;"]),qn=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorCircle",componentId:"ts0vn9-2"})(["position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;"]),Kn=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorOutline",componentId:"ts0vn9-3"})(["position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;border:2px solid white;"]),Yn=b.ZP.div.withConfig({displayName:"AnnotationPanel__OptionSelector",componentId:"ts0vn9-4"})(["margin-bottom:16px;"]),Jn=(0,b.ZP)(Fe).withConfig({displayName:"AnnotationPanel__StyledSegmentedControls",componentId:"ts0vn9-5"})(["& button{text-transform:capitalize;}"]),Xn={duration:.25,ease:[.4,0,.1,1]};var Qn=e=>{let{annotations:t,tomeId:o}=e;const n=(0,l.sJ)(kn.Qf),r=(0,l.Zl)(kn.Hl),i=(0,l.Zl)(kn.f8),{apolloClient:s,clientId:c}=(0,N.bp)(),[d,p]=(0,l.FV)(kn.LN),[u,m]=(0,l.FV)(kn.Qc),{t:g}=(0,y.$G)(),{0:h,1:f}=(0,a.useState)(d.color),{0:C,1:v}=(0,a.useState)(d.line),{0:x,1:O}=(0,a.useState)(d.displayType),P=(0,a.useCallback)((e=>{if(null===n)return;if(n.annotationId===(null===u||void 0===u?void 0:u.id))m((t=>t?e(t):null));else{const r=t.find((e=>e.id===n.annotationId));if(void 0===r)return;const i=e(r);(0,Sn._E)(o,n.tileId,i,s,c)}}),[n,t,s,c,null===u||void 0===u?void 0:u.id,m,o]),j=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");h!==t&&(f(t),p((e=>zn(zn({},e),{},{color:t}))),P((e=>{const o=(0,_n.Z)(e);return o.style.colorScheme=t,o})))}),[h,p,P]),w=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");C!==t&&(v(t),p((e=>zn(zn({},e),{},{line:t}))),P((e=>{const o=(0,_n.Z)(e);return o.style.lineStyle=t,o})))}),[C,p,P]),T=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");x!==t&&(O(t),p((e=>zn(zn({},e),{},{displayType:t}))),P((e=>{const o=(0,_n.Z)(e);return o.displayType=t,o})))}),[x,p,P]);(0,a.useEffect)((()=>(i(!0),r(!0),()=>{r(!1)})),[r,i]),(0,a.useEffect)((()=>{var e,o,r,i,a;if(!n)return;let l;if(n.annotationId===(null===u||void 0===u?void 0:u.id))l=u;else{const e=t.find((e=>e.id===n.annotationId));if(void 0===e)return;l=e}null!==(e=l)&&void 0!==e&&null!==(o=e.style)&&void 0!==o&&o.lineStyle?v((e=>e===l.style.lineStyle?e:l.style.lineStyle)):v(d.line),null!==(r=l)&&void 0!==r&&null!==(i=r.style)&&void 0!==i&&i.colorScheme?f((e=>e===l.style.colorScheme?e:l.style.colorScheme)):f(d.color),null!==(a=l)&&void 0!==a&&a.displayType?O((e=>e===l.displayType?e:l.displayType)):O(d.displayType)}),[n,d,h,C,x,u,t]);const I={hairline:Fn,wavy:$n.Z,click:Hn,always:Rn},E=(0,b.Fg)();return(0,S.jsxs)(te,{onMouseDown:e=>{e.preventDefault()},children:[(0,S.jsx)(ne,{children:g("components.annotationPanel.colorTitle")}),(0,S.jsx)(Un,{role:"listbox",children:Object.entries(E.annotationColors).map((e=>{let[t,o]=e;return(0,S.jsxs)(Wn,{onClick:j,value:t,"aria-selected":h===t,role:"option",children:[(0,S.jsx)(qn,{style:{backgroundColor:o.background},initial:!1,animate:{scale:h===t?.6666666667:1},transition:Xn}),(0,S.jsx)(Kn,{style:{borderColor:o.background},initial:!1,animate:{scale:h===t?1:.5},transition:Xn})]},t)}))}),(0,S.jsx)(ne,{children:g("components.annotationPanel.lineStyleTitle")}),(0,S.jsx)(Yn,{children:(0,S.jsx)(Jn,{role:"listbox",children:["hairline","wavy"].map((e=>{const t=I[e];return(0,S.jsx)(He.Z,{"aria-selected":C===e,role:"option",onClick:w,value:e,isSegment:!0,selected:C===e,startIcon:(0,S.jsx)(t,{style:{width:24,height:24}}),children:e},e)}))})}),(0,S.jsx)(ne,{children:g("components.annotationPanel.showTitle")}),(0,S.jsx)(Yn,{children:(0,S.jsx)(Jn,{role:"listbox",children:[{type:"click",label:g("components.annotationPanel.onClickButtonLabel")},{type:"always",label:g("components.annotationPanel.alwaysButtonLabel")}].map((e=>{const t=I[e.type];return(0,S.jsx)(He.Z,{"aria-selected":x===e.type,role:"option",onClick:T,isSegment:!0,value:e.type,selected:x===e.type,startIcon:(0,S.jsx)(t,{style:{width:24,height:24}}),children:e.label},e.type)}))})})]})},er=o(98525),tr=o(82391),or=o(20543),nr=o(19579),rr=o(55075);function ir(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}var ar=e=>{let{tomeId:t,shouldSetPropertyPanel:o=!0,shouldFocusInput:n=!1}=e;const i=(0,l.sJ)(H.Vx),s=(0,E.t2)(),{apolloClient:c,clientId:d}=(0,N.bp)(),{getMainController:p}=(0,a.useContext)(X.Z),u=p(i);return(0,l._8)((e=>{let{set:a}=e;return e=>{let{tileType:l,additionalTileData:p={},afterAddTileAction:m}=e;const g=(0,rr.x)(t,i,u,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ir(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({type:l},p),c,d,{kind:or.r.END});o&&s.setPropertyPanel(_.Z.TILE),g&&((0,H.Dm)(g),a((0,H.Eq)(g),!0),n&&a((0,Q.pt)(g),!0),m!==nr.B.NONE&&a((0,nr.A)(g),{triggered:!0,action:m}))}}),[c,d,i,u,s,t,o,n])},lr=o(7377),sr=o(85684),cr=o(41366),dr=o(26188),pr=o(12464),ur=o(27618),mr=o(70974),gr=o(88989);function hr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function fr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const br=104,yr=b.ZP.div.withConfig({displayName:"TileSelectionOption__TileOption",componentId:"sc-19p6lg4-0"})(["position:absolute;display:flex;flex-direction:column;align-items:center;background-color:transparent !important;"]),Cr=b.ZP.div.withConfig({displayName:"TileSelectionOption__TileContainer",componentId:"sc-19p6lg4-1"})(["position:static;display:flex;justify-content:center;"]),vr=(0,b.ZP)(d.E.div).withConfig({displayName:"TileSelectionOption__OptionLabel",componentId:"sc-19p6lg4-2"})(["font-weight:500;font-size:",";color:",";"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.sidebarTileText)),xr=(0,b.ZP)(d.E.div).withConfig({displayName:"TileSelectionOption__OptionIcon",componentId:"sc-19p6lg4-3"})(["width:","px;height:","px;display:inline-block;background-color:",";border-radius:16px;display:flex;flex:none;transform:translate(0,0);justify-content:center;align-items:center;flex-direction:column;border-width:2px;border-color:",";border-style:solid;cursor:grab;svg{pointer-events:none;fill:",";}&:hover{background-color:",";}"],br,br,(e=>e.$isDragging?e.theme.colors.sidebarTileDragging:e.theme.colors.sidebarTile),(e=>e.selected?e.theme.colors.contentAccent:e.theme.colors.transparent),(e=>{let{theme:t}=e;return t.colors.sidebarTileIcon}),(e=>{let{theme:t}=e;return t.colors.sidebarTileHover})),Or=b.ZP.div.withConfig({displayName:"TileSelectionOption__AddTileIcon",componentId:"sc-19p6lg4-4"})(["width:26px;height:26px;background:",";border-radius:99px;display:flex;align-items:center;justify-content:center;position:absolute;top:-13px;left:-13px;svg{fill:",";}"],(e=>e.theme.colors.contentAccent),(e=>{let{theme:t}=e;return t.colors.accentForeground}));var Pr=e=>{let{addNewTile:t,option:o,selectedType:n,tileData:r,onTileDragStart:i,onTileDragEnd:s}=e;const c=(0,l.Zl)(R.LY),d=(0,l.sJ)(R.M9),{0:p,1:u}=(0,a.useState)(!1),{0:m,1:g}=(0,a.useState)(!1),{0:h,1:f}=(0,a.useState)({x:0,y:0}),b=(0,a.useRef)(null),C=(0,a.useMemo)((()=>(0,pr.oD)()),[]),{scrollContainerIfNeeded:v,cancelAnyScrolling:x}=(0,gr.Z)(),O=(0,a.useCallback)(((e,t)=>{(Math.abs(t.offset.x)>8||Math.abs(t.offset.y)>8)&&i(),v(e)}),[v,i]),P=(0,a.useCallback)((()=>{x(),u(!1),c(null),(0,H.bT)(!1)}),[x,c]);(0,a.useEffect)((()=>()=>{P()}),[P]);const j=(0,a.useCallback)((()=>{const e=b.current.getBoundingClientRect();g(!0),f({x:e.x,y:e.y}),u(!0),(0,H.bT)(!0);const t={kind:ur.A.ADD_TILE,typeType:o.value};c(t)}),[o.value,c]),w=(0,a.useCallback)((()=>{s({dismiss:!d}),P()}),[P,d,s]),E=(0,a.useCallback)((()=>{g(!1)}),[]),_={intital:{opacity:1,scale:1,width:br},addTile:{opacity:1,scale:.8,width:"horizontal"===(null===d||void 0===d?void 0:d.kind)?208:br}},{t:k}=(0,y.$G)();return(0,S.jsxs)(Cr,{children:[(0,S.jsxs)(yr,{style:fr({},p?{pointerEvents:"none"}:{}),onClick:()=>t({tileType:o.value,additionalTileData:r,afterAddTileAction:nr.B.NONE}),children:[(0,S.jsx)(pr.Nq,{node:C,children:(0,S.jsxs)(xr,{ref:b,id:o.value,selected:o.value===n,$isDragging:p,onDragTransitionEnd:E,drag:!0,dragSnapToOrigin:!0,onDrag:O,onDragStart:j,onDragEnd:w,dragTransition:{from:.001},dragPropagation:!0,initial:"intitial",variants:_,animate:p&&d?"addTile":"initial",transition:p&&d?I.iy:{duration:0},children:[p&&d&&(0,S.jsx)(Or,{children:(0,S.jsx)(xt.Z,{style:{width:"21px",height:"21px"}})}),(0,S.jsx)(o.icon,{}),(!p||p&&!d)&&(0,S.jsx)(vr,{children:`${k("sidebar.optionLabel",{option:o.label})}`})]})}),p||m?(0,S.jsx)(mr.Z,{scaleToPage:!1,dragPosition:h,node:C,containerZIndex:T.C8}):(0,S.jsx)(pr.t0,{node:C})]},o.value),(p||m)&&(0,S.jsx)(Xt.Z,{})]})};function jr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):jr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Tr=b.ZP.div.withConfig({displayName:"AddTileSelector__SearchContainer",componentId:"fr9vk1-0"})([""]),Ir=(0,b.ZP)(ee.Z).withConfig({displayName:"AddTileSelector__SearchInput",componentId:"fr9vk1-1"})(["height:","px;padding:12px 14px;background:transparent;margin-top:0;font-size:",";line-height:21px;border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-left-radius:0px;border-bottom-right-radius:0px;border-bottom:"," ","px solid;"],45,(e=>e.theme.fontSizes.md),(e=>e.theme.colors.contrast8),1),Er=b.ZP.div.withConfig({displayName:"AddTileSelector__DragHint",componentId:"fr9vk1-2"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;height:42px;font-size:",";color:",";",""],(e=>e.theme.fontSizes.xxs),(e=>{let{theme:t}=e;return t.colors.sidebarTileDragHint}),(e=>{let{theme:t}=e;return(0,lr.Z)({base:t.colors.sidebarTileDragHint,highlight:t.colors.sidebarTileDragShimmerHighlight})})),_r=b.ZP.div.withConfig({displayName:"AddTileSelector__Group",componentId:"fr9vk1-3"})(["display:grid;grid-template-columns:1fr 1fr;grid-template-rows:repeat(",",102px);gap:12px;padding:0 12px 12px;overflow-y:scroll;position:relative;max-height:","px;min-height:","px;"],(e=>e.$numRows),(e=>e.$maxHeight),(e=>e.$minHeight));var Sr=e=>{let{tomeId:t,maxHeight:o,onTileDragStart:n,onTileDragEnd:r}=e;const{0:i,1:l}=(0,a.useState)(""),{flags:s}=(0,a.useContext)(dr.Z),c=q.YM.filter((e=>!e.launchDarklyKey||(null===s||void 0===s?void 0:s[e.launchDarklyKey]))),d=Math.ceil(c.length/2),p=(0,a.useRef)(null),u=(0,a.useRef)(null);(0,a.useEffect)((()=>{u.current&&u.current.select()}),[]);const m=c.filter((e=>{let{label:t,value:o}=e;return!(i&&!t.toLowerCase().includes(i.toLowerCase())&&!o.toLowerCase().includes(i.toLowerCase()))}));let g=m,h={};if(0===m.length){const e=(0,cr.w)(i);e.tileType&&(g=c.filter((t=>t.value===e.tileType)),h=wr(wr({},h),e.tileData))}const f=(0,E.t2)(),b=(0,a.useCallback)((()=>{i&&i.length>0?l(""):f.closePropertyPanel()}),[f,i]),{0:C,1:v}=(0,a.useState)(null);(0,a.useEffect)((()=>{i&&i.length>0&&g.length>0?v(g[0].value):v(null)}),[i]);const x=ar({tomeId:t}),O=(0,a.useCallback)((()=>{C&&x({tileType:C,additionalTileData:h,afterAddTileAction:nr.B.NONE})}),[C,h]),{onKeyDown:P}=(0,tr.Z)({options:g.map((e=>e.value)),selectedType:C,setSelectedType:v,didSelect:O,didEscape:b}),j=o-45-1,w=104*d<j?104*d:j,{t:T}=(0,y.$G)();return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(sr.Z,{exemptContainerRefs:p.current?[p.current.ref]:[],onClick:()=>{v(null)},children:(0,S.jsxs)(Tr,{children:[(0,S.jsx)(Ir,{type:"text",placeholder:T("sidebar.searchInput"),value:i,onChange:e=>l(e.target.value),onKeyDown:P,ref:u}),(0,S.jsx)(Er,{children:T("sidebar.dragTilesHint")}),(0,S.jsx)(_r,{$maxHeight:j,$minHeight:w,$numRows:d,children:g.map((e=>(0,S.jsx)(Pr,{option:e,addNewTile:x,selectedType:C,tileData:h,onTileDragStart:n,onTileDragEnd:r},e.value)))})]})})})},kr=o(77774),Zr=o(36828);function Dr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Mr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Dr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Rr=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Mr(Mr({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M56.7661 45.8477V45.8477C56.0186 46.1574 55.1582 45.9863 54.5861 45.4141L44.5861 35.4141V35.4141C44.211 35.0391 44.0002 34.5304 44.0001 34V30V30.0003C44.0001 29.4699 44.2108 28.9612 44.5859 28.5861L54.5859 18.5861H54.5859C55.367 17.8052 56.6334 17.8054 57.4143 18.5866C57.7892 18.9615 57.9998 19.47 57.9999 20.0002V44.0002V44.0003C57.9999 44.8089 57.513 45.538 56.766 45.8477L56.7661 45.8477ZM12 16H36V16C39.3137 16 42 18.6863 42 22V42C42 45.3137 39.3137 48 36 48H12V48C8.68629 48 6 45.3137 6 42V42V22V22C6 18.6863 8.68629 16 12 16H12Z"})}))));function Ar(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Lr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ar(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Nr=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Lr(Lr({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{d:"M34.0208 47.8686V52.0068H42.0208C43.1254 52.0068 44.0208 52.9023 44.0208 54.0068C44.0208 55.1114 43.1254 56.0068 42.0208 56.0068H22.0208C20.9162 56.0068 20.0208 55.1114 20.0208 54.0068C20.0208 52.9023 20.9162 52.0068 22.0208 52.0068H30.0208V47.8686C22.0241 46.8643 16.0241 40.0664 16.0208 32.0068V28.0068C16.0208 26.9023 16.9162 26.0068 18.0208 26.0068C19.1254 26.0068 20.0208 26.9023 20.0208 28.0068V32.0068C20.0208 38.6343 25.3934 44.0068 32.0208 44.0068C38.6482 44.0068 44.0208 38.6343 44.0208 32.0068V28.0068C44.0208 26.9023 44.9162 26.0068 46.0208 26.0068C47.1254 26.0068 48.0208 26.9023 48.0208 28.0068V32.0068V32.0058C48.018 40.0654 42.0185 46.8636 34.0218 47.8685L34.0208 47.8686ZM32.0208 40.0068C27.6025 40.0068 24.0208 36.4251 24.0208 32.0068V16.0068V16.0068C24.0208 11.5886 27.6025 8.00684 32.0208 8.00684C36.4391 8.00684 40.0208 11.5886 40.0208 16.0068V32.0068C40.0208 36.4251 36.4391 40.0068 32.0208 40.0068C32.0208 40.0068 32.0208 40.0068 32.0208 40.0068H32.0208Z"})}))));const Hr=b.ZP.div.withConfig({displayName:"RecordingPanel__ButtonsContainer",componentId:"sc-1bx09b7-0"})(["display:flex;flex-direction:row;margin-bottom:14px;gap:9px;margin-top:11px;"]),Vr=b.ZP.span.withConfig({displayName:"RecordingPanel__RecordCircle",componentId:"sc-1bx09b7-1"})(["background-color:#ff3434;height:12px;width:12px;border-radius:6px;margin-right:5px;"]),Br=b.ZP.div.withConfig({displayName:"RecordingPanel__DevicePicker",componentId:"sc-1bx09b7-2"})(["margin-bottom:7px;"]);var Fr=e=>{let{videoStatus:t,tomeId:o,pageId:n,videoId:r}=e;const{apolloClient:i,clientId:s}=(0,N.bp)(),c=(0,l.sJ)(w.ep),d=(0,l.sJ)((0,$e.vw)(n)),p=(0,l.rb)((0,$e.vw)(n)),u=(0,l.Zl)(w.wo),[m,g]=(0,l.FV)(w.HV),[h,f]=(0,l.FV)(w.LW),b=(0,l.sJ)(w.jd),C=(0,l.sJ)(w.$6),v=(0,B.ye)(B.TT.NARRATION_VIDEO_OVERRIDE),x=(0,E.t2)(),O=!!d.localMediaUrl||t===z.Kwn.Ready,P=e=>e.startsWith("Default - ")?"Same As System":e.replace(/ *\([^)]*\) */g,""),j="NONE"!==c,T=c===Zr.D.NOT_ALLOWED_ERROR,I=c===Zr.D.NOT_READABLE_ERROR,_=c===Zr.D.UNSUPPORTED_BROWSER||c===Zr.D.OVERCONSTRAINED_ERROR,k=(0,a.useCallback)((()=>{p(),(0,kr.Np)(o,n,i,s)}),[i,s,n,p,o]),Z=d.inProgress,{t:D}=(0,y.$G)();let M;return M=D(Z?"sidebar.recordingPanel.uploading":O?"sidebar.recordingPanel.retake":"sidebar.recordingPanel.record"),(0,S.jsxs)(te,{children:[v&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne,{children:D("sidebar.media.muxVideoId")}),(0,S.jsx)(oe,{children:(0,S.jsx)(ae,{type:"text",value:r||"",onChange:e=>{e.target.value&&(0,kr.w8)(o,n,e.target.value,i,s,(()=>{(0,H.ak)({message:`${D("sidebar.recording.overrideMessage")}`})}))}})})]}),(0,S.jsx)(Br,{children:(0,S.jsx)(je,{disabled:0===C.length||j,currentValue:m||"",options:C.map((e=>({value:e.deviceId,label:P(e.label)}))),onChange:e=>{g(e)},menuWidth:"100%",icon:Rr,controlWidth:"100%",placeholder:D("sidebar.media.camera")})}),(0,S.jsx)(Br,{children:(0,S.jsx)(je,{disabled:0===b.length||j,currentValue:h||"",options:b.map((e=>({value:e.deviceId,label:P(e.label)}))),onChange:e=>{f(e)},menuWidth:"100%",icon:Nr,controlWidth:"100%",placeholder:D("sidebar.media.microphone")})}),(0,S.jsxs)(Hr,{children:[(0,S.jsx)(He.Z,{disabled:Z||j,"data-testid":"record_button","aria-label":D("sidebar.media.record"),onClick:()=>{u(!0),x.closePropertyPanel(),(0,H.oG)(!0)},iconOpacity:1,startIcon:Z?(0,S.jsx)(S.Fragment,{}):(0,S.jsx)(Vr,{}),style:{width:"100%"},children:M}),O&&(0,S.jsx)(He.Z,{"data-testid":"delete_recording_button","aria-label":D("sidebar.media.delete"),onClick:k,children:D("sidebar.media.delete")})]}),_&&(0,S.jsx)(Bt,{tag:D("sidebar.media.unsupportedBrowserTag"),message:D("sidebar.media.unsupportedBrowserMessage")}),I&&(0,S.jsx)(Bt,{tag:D("sidebar.media.cameraErrorTag"),message:D("sidebar.media.cameraErrorMessage")}),T&&(0,S.jsx)(Bt,{tag:D("sidebar.media.permissionNeededTag"),message:D("sidebar.media.permissionNeededMessage")})]})},$r=o(28648),Gr=o(28670),zr=o.n(Gr),Ur=o(15814),Wr=o(28205),qr=o(24233),Kr=o(65890),Yr=o(36488),Jr=o(22951);function Xr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Qr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Xr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ei=(0,b.ZP)(pe.Z).attrs({width:"8",height:"8",viewBox:"0 0 10 10"}).withConfig({displayName:"ThemeDropdown__DropdownArrow",componentId:"sc-1pl3wgr-0"})(["align-self:middle;display:inline-flex;margin:0.1em 0 0 0.35em;stroke:currentColor;flex-shrink:0;"]),ti=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeRow",componentId:"sc-1pl3wgr-1"})(["display:flex;flex-direction:row;gap:8px;align-items:center;font-size:",";"],(e=>{let{theme:t}=e;return t.fontSizes.sm})),oi=b.ZP.div.attrs((e=>{let{color:t,theme:o}=e;return{style:{backgroundColor:t,borderColor:(0,Kr.D1)({foregroundColorHex:t,backgroundColorHex:o.RAW_VALUES_LEGACY.menuBackgroundLayer[0]})}}})).withConfig({displayName:"ThemeDropdown__ThemeSwatch",componentId:"sc-1pl3wgr-2"})(["display:inline-flex;flex-direction:column;flex-shrink:0;justify-content:center;align-items:flex-start;width:32px;height:20px;border-radius:3px;border-width:1px;border-style:solid;text-align:left;padding-left:4px;"]),ni=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeTitle",componentId:"sc-1pl3wgr-3"})(["font-size:7px;line-height:1;color:",";"],(e=>{let{color:t}=e;return t})),ri=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeBody",componentId:"sc-1pl3wgr-4"})(["font-size:6px;line-height:1;color:",";"],(e=>{let{color:t}=e;return t})),ii=b.ZP.button.withConfig({displayName:"ThemeDropdown__ThemeDropdownTrigger",componentId:"sc-1pl3wgr-5"})(["background:",";color:",";border-radius:",";padding:6px;width:100%;","{width:48px;height:28px;border-radius:",";padding-left:5px;}","{font-size:9px;}","{font-size:7px;}svg{margin-left:auto;margin-right:6px;}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.menuControlText}),(e=>{let{theme:t}=e;return t.borderRadius.sm}),oi,(e=>{let{theme:t}=e;return t.borderRadius.xs}),ni,ri),ai=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeName",componentId:"sc-1pl3wgr-6"})([""," ",""],Jr.wR,(e=>{let{$isAnonymous:t}=e;return t&&"\n    font-style: italic;\n  "})),li=e=>{let{colors:t,children:o}=e;return(0,S.jsxs)(ti,{children:[(0,S.jsxs)(oi,{color:t.pageColor,children:[(0,S.jsx)(ni,{color:t.titleColor,children:"Title"}),(0,S.jsx)(ri,{color:t.bodyColor,children:"Body"})]}),o]})};var si=e=>{let{selected:t,themes:o,onChange:n,dropdownProps:r}=e;const{height:i}=(0,F.Z)(),a=o.map((e=>new Yr.Z(e))).filter((e=>!e.isAnonymous)).map((e=>({id:e.id,checked:e.id===t,action:()=>n(e.id),text:(0,S.jsx)(li,{colors:e.colors,children:(0,S.jsx)(ai,{$isAnonymous:e.isAnonymous,title:e.displayName,children:e.displayName})})}))),l=new Yr.Z(o.filter((e=>e.id===t))[0]);return(0,S.jsx)(qr.Z,Qr(Qr({menuWidth:216,menuPosition:"below",menuAlign:"left",maxHeight:Math.min(i?.5*i+50:500,500),itemsOrFn:a},r),{},{children:(0,S.jsx)(ii,{type:"button","data-testid":"theme_dropdown_trigger",children:l&&l.hasColors&&(0,S.jsxs)(li,{colors:l.colors,children:[(0,S.jsx)(ai,{$isAnonymous:l.isAnonymous,title:l.displayName,children:l.displayName}),(0,S.jsx)(ei,{"data-testid":"dropdown_arrow"})]})})}))},ci=o(88263),di=o(25934),pi=o(62830),ui=o.n(pi),mi=o(67679),gi=o(6748);function hi(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function fi(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hi(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function bi(e){var t;let{tomeId:o,pageId:n,colors:{bodyColor:r,pageColor:i,titleColor:a},headingTypeface:l,paragraphTypeface:s,apolloClient:c,clientId:d}=e;const p=ui()(),u=(0,di.Z)(),m=null===(t=c.cache.readFragment({id:`Tome:${o}`,fragment:z.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===t?void 0:t.id;(0,mi.L)(!!m,"Trying to create a theme and update its page, but was not able to retrieve an orgId from the cache",{tomeId:o,pageId:n});const g=[{operation:z.C8.CreateTheme,id:p,theme:{orgId:m,colors:{bodyColor:r,pageColor:i,titleColor:a},headingTypeface:l,paragraphTypeface:s,headingFontId:null===l||void 0===l?void 0:l.baseline.id,paragraphFontId:null===s||void 0===s?void 0:s.baseline.id}}];g.push({operation:z.C8.UpdatePage,id:n,page:{themeId:p}});const h={id:u,tomeId:o,clientId:d,apply:g,revert:(0,gi.oF)(g,c.cache)};(0,gi.iO)(c,h)}function yi(e){var t;let{tomeId:o,pageId:n,previousThemeId:r,colors:{bodyColor:i,pageColor:a,titleColor:l},headingTypeface:s,paragraphTypeface:c,apolloClient:d,clientId:p}=e;const u=ui()(),m=(0,di.Z)(),g=null===(t=d.cache.readFragment({id:`Tome:${o}`,fragment:z.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===t?void 0:t.id;(0,mi.L)(!!g,"Trying to create a theme and update its page, but was not able to retrieve an orgId from the cache",{tomeId:o,pageId:n});const h=[{operation:z.C8.CreateTheme,id:u,theme:{orgId:g,colors:{bodyColor:i,pageColor:a,titleColor:l},headingTypeface:s,paragraphTypeface:c,headingFontId:null===s||void 0===s?void 0:s.baseline.id,paragraphFontId:null===c||void 0===c?void 0:c.baseline.id}}];h.push({operation:z.C8.UpdateTome,id:o,tome:{themeId:u}});d.cache.readFragment({id:`Tome:${o}`,fragment:z.s0Y,fragmentName:"TomePagesFragment"}).pages.forEach((e=>{r&&e.theme.id!==r||h.push({operation:z.C8.UpdatePage,id:e.id,page:{id:e.id,themeId:u}})}));const f=(0,gi.oF)(h,d.cache),b={id:m,tomeId:o,clientId:p,apply:h,revert:f};(0,gi.iO)(d,b)}function Ci(e,t,o,n,r){var i;const a=(0,di.Z)(),l=null===(i=n.cache.readFragment({id:`Tome:${e}`,fragment:z.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===i?void 0:i.id,s=[{operation:z.C8.UpdateTheme,id:t,theme:o}],c={id:a,tomeId:e,clientId:r,apply:s,revert:(0,gi.oF)(s,n.cache)},d=[{operation:z.C8.UpdateTheme,id:t,theme:fi({orgId:l},o)}],p={id:a,tomeId:e,clientId:r,apply:d,revert:(0,gi.oF)(d,n.cache)};(0,gi.iO)(n,c,p)}var vi=o(22111);const xi=zr()("#000000").hex();function Oi(e){const t=zr()(e),o=t.luminance(),n=t.lch()[1],r=t.lch()[2];let i,a;return zr()(e).hex()===xi?{titleColor:"#FFFFFF",bodyColor:"#959595"}:(o>=.5?n>=30?(i=t.set("lch.l","/2.8").saturate(2.5).set("lch.h",r).hex(),a=zr().mix(t,i,.8).hex()):n<30&&n>=1?(i=t.set("lch.l","/2.7").saturate(2.5).set("lch.h",r).hex(),a=zr().mix(t,i,.8).hex()):(i=t.luminance(.02).hex(),a=t.luminance(.16).hex()):o<.5&&o>=.3?n>=30?(i=t.set("lch.l","/2.3").set("lch.h",r).hex(),a=zr().mix(t,i,.8).hex()):n<30&&n>=1?(i=t.set("lch.l","/2.7").saturate(1.2).set("lch.h",r).hex(),a=zr().mix(t,i,.8).hex()):(i=t.luminance(.02).hex(),a=t.luminance(.08).hex()):o<.3&&o>=.15?(i=n>=50?t.set("lch.l","*2.3").set("lch.h",r).hex():n<50&&n>=1?t.set("lch.l","*2.7").saturate(.8).set("lch.h",r).hex():t.set("lch.l","*3.4").set("lch.h",r).hex(),a=zr().mix(t,i,.7).hex()):o<.15&&o>=.02?(i=n>=50?t.set("lch.l","*4").set("lch.h",r).hex():n<50&&n>=1?t.set("lch.l","*6.5").saturate(.4).set("lch.h",r).hex():t.set("lch.l","*4").set("lch.h",r).hex(),a=zr().mix(t,i,.5).hex()):(i=t.luminance(.9).hex(),a=t.luminance(.3).hex()),{titleColor:i,bodyColor:a})}var Pi=o(50135),ji=o(31951);function wi(e){var t,o;const{tomeId:n}=(0,a.useContext)(Pi.z),{data:r}=(0,z.OXH)({variables:{tomeId:n}}),i=null===r||void 0===r||null===(t=r.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.typeFamilies;return(0,a.useCallback)((()=>{const t=e?(0,er.Fx)(e,i):(0,er.RE)(i);ji.Z.getInstance().loadFonts(t,!1)}),[e,i])}function Ti(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ii(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ti(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ti(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ei=(0,b.ZP)(pe.Z).attrs({width:8,height:8,viewBox:"0 0 10 10"}).withConfig({displayName:"FontDropdown__DropdownArrow",componentId:"gn8i8w-0"})(["stroke:currentColor;min-width:8px;"]),_i=b.ZP.div.withConfig({displayName:"FontDropdown__RowText",componentId:"gn8i8w-1"})(["",""],Jr.wR),Si=b.ZP.div.withConfig({displayName:"FontDropdown__Row",componentId:"gn8i8w-2"})(["display:flex;justify-content:space-between;gap:8px;width:88px;align-items:center;font-family:",",'Inter',sans-serif;font-weight:",";"],(e=>{let{$font:t}=e;return t??"Inter"}),(e=>{let{$weight:t}=e;return t??"normal"})),ki=(0,b.ZP)(He.Z).withConfig({displayName:"FontDropdown__DropdownTrigger",componentId:"gn8i8w-3"})(["padding:0px 8px;justify-content:flex-start;width:100%;line-height:16px;"]),Zi=e=>{let{value:t,items:o,onChange:n,dropdownProps:r}=e;const{height:i}=(0,F.Z)(),l=[];for(const a of o){l.length>0&&l.push({type:"separator"}),a.name&&l.push({type:"label",text:a.name,paddingVertical:5,paddingHorizontal:8});for(const e of a.typeFamilies)l.push({type:"option",id:e.name,checked:e.id===(null===t||void 0===t?void 0:t.id),action:()=>{n(e)},text:(0,S.jsx)(Si,{$font:e.family,children:e.name})})}const s=wi(),c=(0,a.useCallback)((()=>{s()}),[s]);return(0,S.jsx)(qr.Z,Ii(Ii({menuWidth:106,menuPosition:"below",menuAlign:"left",dynamicMenuWidth:216,maxHeight:Math.min(i?.5*i+50:500,500),itemsOrFn:l,dataTestId:null===r||void 0===r?void 0:r.dataTestId,onOpenDropdown:c},r),{},{children:(0,S.jsx)(ki,{type:"button","data-testid":"typeFamily_dropdown_trigger",onMouseOver:c,children:(0,S.jsxs)(Si,{children:[(0,S.jsx)(_i,{children:null===t||void 0===t?void 0:t.name}),(0,S.jsx)(Ei,{"data-testid":"typefaceWeight_dropdown_arrow"})]})})}))},Di=e=>{let{value:t,font:o,items:n,onChange:r,dropdownProps:i}=e;const{height:l}=(0,F.Z)(),{t:s}=(0,y.$G)(),c=n.map((e=>({id:e.id??e.weight.toString(),checked:e.weight===(null===t||void 0===t?void 0:t.weight),action:()=>{r(e)},text:(0,S.jsx)(Si,{$font:o,$weight:e.weight,children:e.variantName??s("themes.regularFontType")})}))),d=wi(o),p=(0,a.useCallback)((()=>{d()}),[d]);return(0,S.jsx)(qr.Z,Ii(Ii({menuWidth:106,menuPosition:"below",menuAlign:"left",dynamicMenuWidth:216,maxHeight:Math.min(l?.5*l+50:500,500),itemsOrFn:c,onOpenDropdown:p},i),{},{children:(0,S.jsx)(ki,{type:"button","data-testid":"typefaceWeight_dropdown_trigger",onMouseOver:p,children:(0,S.jsxs)(Si,{children:[(0,S.jsx)(_i,{children:(null===t||void 0===t?void 0:t.variantName)??s("themes.regularFontType")}),(0,S.jsx)(Ei,{"data-testid":"typefaceWeight_dropdown_arrow"})]})})}))};var Mi=o(77717);const Ri=b.ZP.div.withConfig({displayName:"CustomizePanelColorPicker__ColorPickerBackground",componentId:"sc-14ermo3-0"})(["background-color:",";border-radius:20px;width:","px;display:flex;box-shadow:",";"],(e=>e.theme.colors.sidebar),240,(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow})),Ai=b.ZP.div.withConfig({displayName:"CustomizePanelColorPicker__ColorPickerWrapper",componentId:"sc-14ermo3-1"})(["padding-top:12px;"]);var Li=e=>{let{top:t,right:o,color:n,setColor:r,setColorComplete:i}=e;const{colorPickerContainerRef:a}=(0,ci.R)();return(0,S.jsx)(Mi.Z,{top:t,left:o-240,zIndex:T.y$,children:(0,S.jsx)(Ri,{ref:a,onMouseDown:Lt.Z,children:(0,S.jsx)(Ai,{children:(0,S.jsx)(vn.default,{color:n,setColor:r,setColorComplete:i})})})})};const Ni=b.ZP.div.withConfig({displayName:"styles__CustomColorButtonWrapper",componentId:"sc-1b0g9v8-0"})(["display:flex;flex-wrap:wrap;gap:8px;"]),Hi=b.ZP.div.withConfig({displayName:"styles__ButtonWrapper",componentId:"sc-1b0g9v8-1"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);gap:8px;width:100%;"]),Vi=b.ZP.div.withConfig({displayName:"styles__StyledSegmentedControlsContainer",componentId:"sc-1b0g9v8-2"})(["padding-bottom:12px;"]),Bi=b.ZP.div.withConfig({displayName:"styles__Content",componentId:"sc-1b0g9v8-3"})(["margin-top:8px;margin-bottom:12px;"]),Fi=b.ZP.div.withConfig({displayName:"styles__FontSection",componentId:"sc-1b0g9v8-4"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr) minmax(0,1fr);width:100%;gap:8px;"]),$i=b.ZP.div.withConfig({displayName:"styles__FontDropdownsSection",componentId:"sc-1b0g9v8-5"})(["display:flex;flex-direction:column;gap:6px;"]),Gi=b.ZP.label.withConfig({displayName:"styles__ToggleWrapper",componentId:"sc-1b0g9v8-6"})(["display:flex;margin-left:auto;cursor:pointer;height:auto;"]),zi=(0,b.ZP)(ne).withConfig({displayName:"styles__TextColorPropertyRowText",componentId:"sc-1b0g9v8-7"})(["display:flex;padding-top:12px;padding-top:8px;padding-bottom:0px;height:auto;"]);let Ui;!function(e){e.TOME="Tome",e.PAGE="Page"}(Ui||(Ui={}));var Wi,qi=e=>{let{panelMode:t,closeColorPicker:o,setPanelMode:n}=e;const r=(0,No.Z)((e=>()=>{o(),n(e)}),[o,n]),{t:i}=(0,y.$G)();return(0,S.jsx)(Vi,{children:(0,S.jsx)(Fe,{role:"listbox","data-testid":"customize_panel_mode_toggle",children:Object.values(Ui).map((e=>(0,S.jsx)(He.Z,{isSegment:!0,onClick:r(e),selected:t===e,children:`${i("sidebar.customizePanel.mode",{mode:e})}`},e)))})})};function Ki(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Yi(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ki(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ki(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}!function(e){e.PAGE_COLOR="pageColor",e.TITLE_COLOR="titleColor",e.BODY_COLOR="bodyColor",e.NONE="none"}(Wi||(Wi={}));var Ji;!function(e){e.HEADING="HEADING",e.PARAGRAPH="PARAGRAPH"}(Ji||(Ji={}));const Xi=e=>{let{checked:t,onClick:o}=e;return(0,S.jsx)(Gi,{"data-disable-event-propagation":!0,children:(0,S.jsx)(ht.Z,{inputId:"customize_panel_auto_color_toggle",width:"21px",height:"12px",radius:4,checked:t,onBgColor:!0,onClick:e=>{e.currentTarget.blur(),o(e)}})})};var Qi;!function(e){e.UPDATE_COLOR="UPDATE_COLOR",e.UPDATE_COLORS="UPDATE_COLORS",e.UPDATE_ACTIVE_COLOR_PROPERTY="UPDATE_ACTIVE_COLOR_PROPERTY",e.UPDATE_ACTIVE_COLOR_CHANGE="UPDATE_ACTIVE_COLOR_CHANGE",e.UPDATE_HEADING_FONT_ID="UPDATE_HEADING_FONT_ID",e.UPDATE_PARAGRAPH_FONT_ID="UPDATE_PARAGRAPH_FONT_ID"}(Qi||(Qi={}));const ea=(e,t)=>{switch(t.type){case Qi.UPDATE_ACTIVE_COLOR_PROPERTY:return Yi(Yi({},e),{},{[e.activeColorChange]:t.payload});case Qi.UPDATE_ACTIVE_COLOR_CHANGE:return e.activeColorChange===t.payload?e:Yi(Yi({},e),{},{activeColorChange:t.payload});case Qi.UPDATE_COLORS:return Yi(Yi({},e),t.payload);case Qi.UPDATE_HEADING_FONT_ID:return Yi(Yi({},e),{},{headingFontId:t.payload});case Qi.UPDATE_PARAGRAPH_FONT_ID:return Yi(Yi({},e),{},{paragraphFontId:t.payload});default:return e}};function ta(e){const t=Oi(e.pageColor);return zr()(e.titleColor).hex()===zr()(t.titleColor).hex()&&zr()(e.bodyColor).hex()===zr()(t.bodyColor).hex()}var oa=e=>{var t,o,n,r,i,l,s,c,d,p,u,m,g,h,f,b,C;let{tomeId:v,pageId:x,pageTheme:O,tomeTheme:P,fontData:j,nonTileSidebarRef:w}=e;const T=(0,a.useRef)(!1),I=(0,a.useMemo)((()=>new Yr.Z(O)),[O]),E=(0,a.useMemo)((()=>new Yr.Z(P)),[P]),{0:_,1:k}=(0,a.useState)(O.id===P.id?Ui.TOME:Ui.PAGE),Z=_===Ui.TOME?E:I,{0:D,1:M}=(0,a.useReducer)(ea,{activeColorChange:Wi.NONE,pageColor:Z.colors.pageColor,titleColor:Z.colors.titleColor,bodyColor:Z.colors.bodyColor,headingFontId:null===(t=Z.headingTypeface)||void 0===t||null===(o=t.baseline)||void 0===o?void 0:o.id,paragraphFontId:null===(n=Z.paragraphTypeface)||void 0===n||null===(r=n.baseline)||void 0===r?void 0:r.id}),{0:R,1:A}=(0,a.useState)(ta(I.colors)),{0:L,1:H}=(0,a.useState)(ta(E.colors)),V=_===Ui.TOME?L:R;(0,a.useEffect)((()=>{T.current||(A(ta(I.colors)),H(ta(E.colors))),T.current=!1}),[I.colors,I.id,E.colors,E.id]);const{updateThemeCssVars:F}=(0,ci.R)(),$=(0,B.ye)(B.TT.FONTS),G=(0,Ur.m)(),{propertyPanelRef:U}=(0,N.TR)(),{clientId:W,apolloClient:q}=(0,N.bp)(),K=(0,a.useCallback)((e=>{!function(e){let{tomeId:t,pageId:o,themeId:n,previousThemeId:r,apolloClient:i,clientId:a}=e;const l=(0,di.Z)(),s=Yr.Z.fromCacheFragment(r,i.cache),c=[{operation:z.C8.UpdatePage,id:o,page:{themeId:n,autoThemeColor:!0}}];null!==s&&void 0!==s&&s.isAnonymous&&c.push({operation:z.C8.DeleteTheme,id:r});const d={id:l,tomeId:t,clientId:a,apply:c,revert:(0,gi.oF)(c,i.cache)};(0,gi.iO)(i,d)}({tomeId:v,pageId:x,themeId:e,previousThemeId:I.id,apolloClient:q,clientId:W}),A(ta(I.colors))}),[q,W,I.id,I.colors,x,v]),Y=(0,a.useCallback)((()=>{M({type:Qi.UPDATE_ACTIVE_COLOR_CHANGE,payload:Wi.NONE})}),[]),{data:J,loading:X}=(0,z.CHH)({variables:{tomeId:v},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"}),Q=(null===J||void 0===J||null===(i=J.tome)||void 0===i||null===(l=i.org)||void 0===l?void 0:l.themes)??[],{data:ee}=(0,z.hC_)({variables:{tomeId:v,pageId:x},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"}),oe=null===ee||void 0===ee||null===(s=ee.page)||void 0===s?void 0:s.theme,re=null===ee||void 0===ee||null===(c=ee.tome)||void 0===c?void 0:c.theme,{data:ie}=(0,z.sn6)({variables:{tomeId:v}}),ae=(0,$r.Z)([...Q,...oe?[oe]:[]],(e=>e.id)),le=(0,$r.Z)([...Q,...re?[re]:[]],(e=>e.id));(0,a.useEffect)((()=>{M({type:Qi.UPDATE_COLORS,payload:{pageColor:Z.colors.pageColor,titleColor:Z.colors.titleColor,bodyColor:Z.colors.bodyColor}})}),[Z.colors.pageColor,Z.colors.titleColor,Z.colors.bodyColor]),(0,a.useEffect)((()=>{var e,t;M({type:Qi.UPDATE_HEADING_FONT_ID,payload:null===(e=Z.headingTypeface)||void 0===e||null===(t=e.baseline)||void 0===t?void 0:t.id})}),[null===(d=Z.headingTypeface)||void 0===d||null===(p=d.baseline)||void 0===p?void 0:p.id]),(0,a.useEffect)((()=>{var e,t;M({type:Qi.UPDATE_PARAGRAPH_FONT_ID,payload:null===(e=Z.paragraphTypeface)||void 0===e||null===(t=e.baseline)||void 0===t?void 0:t.id})}),[null===(u=Z.paragraphTypeface)||void 0===u||null===(m=u.baseline)||void 0===m?void 0:m.id]);const se=(0,a.useCallback)((e=>{if(!e)return;const t=e.trim();return(0,vi.B)(t||"")?zr()(t).hex():void 0}),[]),ce=(0,a.useCallback)(((e,t)=>{const o=Yi({pageColor:D.pageColor,titleColor:D.titleColor,bodyColor:D.bodyColor},D.activeColorChange!==Wi.NONE&&{[D.activeColorChange]:e});if(t){const{titleColor:t,bodyColor:n}=Oi(e);o.bodyColor=n,o.titleColor=t}return{colors:o}}),[D.activeColorChange,D.titleColor,D.pageColor,D.bodyColor]),de=(0,a.useCallback)(((e,t)=>{const o=se(e);if(!o)return;const{colors:n}=ce(o,t);switch(_){case Ui.TOME:E.isAnonymous?Ci(v,E.id,{colors:n},q,W):yi({tomeId:v,pageId:x,previousThemeId:E.id,colors:n,headingTypeface:E.headingTypeface,paragraphTypeface:E.paragraphTypeface,apolloClient:q,clientId:W});break;case Ui.PAGE:I.isAnonymous&&I.id!==E.id?Ci(v,I.id,{colors:n},q,W):bi({tomeId:v,pageId:x,colors:n,headingTypeface:I.headingTypeface,paragraphTypeface:I.paragraphTypeface,apolloClient:q,clientId:W})}T.current=!0}),[se,ce,_,E.isAnonymous,E.id,I.isAnonymous,I.id,E.headingTypeface,E.paragraphTypeface,I.headingTypeface,I.paragraphTypeface,v,x,q,W]),pe=(0,a.useCallback)((()=>{if(_===Ui.PAGE){const e=!R;ta(I.colors)||de(D.pageColor,e),A(e)}if(_===Ui.TOME){const e=!L;ta(E.colors)||de(D.pageColor,e),H(e)}}),[_,R,I.colors,de,D.pageColor,L,E.colors]),ue=(0,a.useCallback)((e=>{const t=se(e);if(!t)return;const o=D.activeColorChange===Wi.PAGE_COLOR&&V,{colors:n}=ce(t,o);M({type:Qi.UPDATE_COLORS,payload:n}),_===Ui.TOME&&F(E.id,n),_===Ui.PAGE&&F(I.id,n)}),[ce,se,F,_,E.id,I.id,D.activeColorChange,V]),me=(0,a.useCallback)((e=>{null!==e.target.closest("[data-disable-event-propagation]")||D.activeColorChange===Wi.NONE||M({type:Qi.UPDATE_ACTIVE_COLOR_CHANGE,payload:Wi.NONE})}),[D.activeColorChange]),{headingFontId:ge,paragraphFontId:he}=D,fe=(0,a.useMemo)((()=>(0,er.Rk)(j,ge,er.uF)),[j,ge]),be=(0,a.useMemo)((()=>{var e;if(ge){const e=j.fontIDToFontDataMap[ge];if(e)return e}return(0,er.AK)(null===(e=j.typeFamilyToWeightsDataMap[er.uF])||void 0===e?void 0:e.normal,er.dR,"ROUND_UP")}),[ge,j.fontIDToFontDataMap,j.typeFamilyToWeightsDataMap]),ye=(0,a.useMemo)((()=>(0,er.Rk)(j,he,er.yc)),[j,he]),Ce=(0,a.useMemo)((()=>{var e;if(he){const e=j.fontIDToFontDataMap[he];if(e)return e}return(0,er.AK)(null===(e=j.typeFamilyToWeightsDataMap[er.yc])||void 0===e?void 0:e.normal,er.w2,"ROUND_DOWN")}),[he,j.fontIDToFontDataMap,j.typeFamilyToWeightsDataMap]);(0,a.useEffect)((()=>{const e=null===w||void 0===w?void 0:w.current;return e&&e.addEventListener("click",me),()=>{null===e||void 0===e||e.removeEventListener("click",me)}}),[me,w]);const ve=(0,No.Z)((e=>t=>{t.stopPropagation();const o=e===D.activeColorChange?Wi.NONE:e;M({type:Qi.UPDATE_ACTIVE_COLOR_CHANGE,payload:o})}),[D.activeColorChange]),xe=(0,a.useCallback)((e=>{if(!e)return;const t=_===Ui.TOME?E.id:I.id;Ci(v,t,{name:e},q,W)}),[_,v,E.id,q,W,I.id]),Oe=(0,a.useCallback)((e=>{e||(_===Ui.PAGE&&A(!1),_===Ui.TOME&&H(!1))}),[_,A,H]),Pe=(0,a.useCallback)((e=>{const t=D.activeColorChange===Wi.PAGE_COLOR;Oe(t);de(e,t&&V)}),[D.activeColorChange,Oe,V,de]),je=null===(g=U.current)||void 0===g?void 0:g.getBoundingClientRect(),we=(0,a.useCallback)((e=>{!function(e,t,o,n,r){const i=[{operation:z.C8.UpdateTome,id:e,tome:{themeId:t}}];n.cache.readFragment({id:`Tome:${e}`,fragment:z.s0Y,fragmentName:"TomePagesFragment"}).pages.forEach((e=>{o&&e.theme.id!==o||i.push({operation:z.C8.UpdatePage,id:e.id,page:{id:e.id,themeId:t}})}));const a=(0,gi.oF)(i,n.cache),l={id:(0,di.Z)(),tomeId:e,clientId:r,apply:i,revert:a};(0,gi.iO)(n,l)}(v,e,E.id,q,W),H(ta(E.colors))}),[q,W,v,E.id,E.colors]),Te=(0,a.useCallback)((()=>{K(E.id)}),[K,E.id]),Ie=_===Ui.TOME?!E.isAnonymous:!I.isAnonymous,Ee=(0,a.useCallback)((e=>t=>{const o=_===Ui.TOME,n=e===Ji.HEADING,r=n?t.id:D.headingFontId,i=n?D.paragraphFontId:t.id,a=(0,er.QL)(j,r),l=(0,er.QL)(j,i);o&&!E.isAnonymous?yi({tomeId:v,pageId:x,previousThemeId:E.id,colors:{pageColor:E.colors.pageColor,titleColor:E.colors.titleColor,bodyColor:E.colors.bodyColor},headingTypeface:a,paragraphTypeface:l,apolloClient:q,clientId:W}):o||I.isAnonymous&&I.id!==E.id?Ci(v,o?E.id:I.id,{headingTypeface:a,paragraphTypeface:l,headingFontId:r,paragraphFontId:i},q,W):bi({tomeId:v,pageId:x,colors:{pageColor:I.colors.pageColor,titleColor:I.colors.titleColor,bodyColor:I.colors.bodyColor},headingTypeface:a,paragraphTypeface:l,apolloClient:q,clientId:W}),M({type:n?Qi.UPDATE_HEADING_FONT_ID:Qi.UPDATE_PARAGRAPH_FONT_ID,payload:t.id})}),[q,W,D.headingFontId,D.paragraphFontId,j,x,I.colors.bodyColor,I.colors.pageColor,I.colors.titleColor,I.id,I.isAnonymous,_,v,E.colors.bodyColor,E.colors.pageColor,E.colors.titleColor,E.id,E.isAnonymous]),_e=(0,a.useCallback)((e=>t=>{const o=t,n=j.typeFamilyToWeightsDataMap[o.name].normal,r=e===Ji.HEADING,i=(0,er.AK)(n,r?(null===be||void 0===be?void 0:be.weight)??er.dR:(null===Ce||void 0===Ce?void 0:Ce.weight)??er.w2,r?"ROUND_UP":"ROUND_DOWN");i&&(M({type:r?Qi.UPDATE_HEADING_FONT_ID:Qi.UPDATE_PARAGRAPH_FONT_ID,payload:i.id}),Ee(e)(i))}),[null===Ce||void 0===Ce?void 0:Ce.weight,null===be||void 0===be?void 0:be.weight,j.typeFamilyToWeightsDataMap,Ee]),{t:Se}=(0,y.$G)(),ke=_===Ui.TOME?"sidebar.tomeTheme":"sidebar.pageTheme";return(0,S.jsx)(te,{children:(!X||Q.length>0)&&O&&ae&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(Bi,{children:[(0,S.jsx)(qi,{panelMode:_,setPanelMode:k,closeColorPicker:Y}),(0,S.jsx)(ne,{children:Se(ke)}),_===Ui.TOME?(0,S.jsx)(si,{selected:E.id,themes:le,onChange:we}):(0,S.jsx)(si,{selected:I.id,themes:ae,onChange:K}),(0,S.jsx)(ne,{style:{marginTop:12},children:Se("sidebar.page")}),(0,S.jsxs)(Ni,{children:[(0,S.jsx)(Wr.Z,{color:D.pageColor,label:Se("sidebar.background"),selected:D.activeColorChange===Wi.PAGE_COLOR,onButtonClick:ve(Wi.PAGE_COLOR),"data-disable-event-propagation":!0}),!$&&(0,S.jsxs)("div",{style:{marginTop:4},children:[(0,S.jsx)(ne,{children:Se("sidebar.textColor")}),(0,S.jsxs)(Ni,{children:[(0,S.jsx)(Wr.Z,{color:D.titleColor,label:Se("sidebar.heading"),selected:D.activeColorChange===Wi.TITLE_COLOR,onButtonClick:ve(Wi.TITLE_COLOR),"data-disable-event-propagation":!0}),(0,S.jsx)(Wr.Z,{color:D.bodyColor,label:Se("sidebar.paragraph"),selected:D.activeColorChange===Wi.BODY_COLOR,onButtonClick:ve(Wi.BODY_COLOR),"data-disable-event-propagation":!0})]}),(0,S.jsxs)(zi,{children:[Se("sidebar.autoColor"),_===Ui.PAGE&&(0,S.jsx)(Xi,{checked:R,onClick:pe}),_===Ui.TOME&&(0,S.jsx)(Xi,{checked:L,onClick:pe})]})]}),$&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(Fi,{style:{marginTop:8},children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(ne,{children:Se("sidebar.heading")}),(0,S.jsxs)($i,{children:[(0,S.jsx)(Zi,{value:fe,items:j.typeFamilySections,onChange:_e(Ji.HEADING),dropdownProps:{dataTestId:"heading_type_family_dropdown"}},"typeFamily"),(0,S.jsx)(Di,{value:be,font:null===fe||void 0===fe?void 0:fe.family,items:fe?j.typeFamilyToWeightsDataMap[fe.name].normal:[],onChange:Ee(Ji.HEADING),dropdownProps:{dataTestId:"heading_weight_dropdown"}},"weight"),(0,S.jsx)(Ni,{children:(0,S.jsx)(Wr.Z,{color:D.titleColor,label:Se("sidebar.heading"),selected:D.activeColorChange===Wi.TITLE_COLOR,onButtonClick:ve(Wi.TITLE_COLOR),"data-disable-event-propagation":!0})})]})]},"heading"),(0,S.jsxs)("div",{children:[(0,S.jsx)(ne,{children:Se("sidebar.paragraph")}),(0,S.jsxs)($i,{children:[(0,S.jsx)(Zi,{value:ye,items:j.typeFamilySections,onChange:_e(Ji.PARAGRAPH),dropdownProps:{menuAlign:"right",dataTestId:"paragraph_type_family_dropdown"}},"typeFamily"),(0,S.jsx)(Di,{value:Ce,font:null===ye||void 0===ye?void 0:ye.family,items:ye?j.typeFamilyToWeightsDataMap[ye.name].normal:[],onChange:Ee(Ji.PARAGRAPH),dropdownProps:{menuAlign:"right",dataTestId:"paragraph_weight_dropdown"}},"weight"),(0,S.jsx)(Ni,{children:(0,S.jsx)(Wr.Z,{color:D.bodyColor,label:Se("sidebar.paragraph"),selected:D.activeColorChange===Wi.BODY_COLOR,onButtonClick:ve(Wi.BODY_COLOR),"data-disable-event-propagation":!0})})]})]},"paragraph")]}),(0,S.jsxs)(zi,{style:{paddingTop:0},children:[Se("sidebar.autoColor"),_===Ui.PAGE&&(0,S.jsx)(Xi,{checked:R,onClick:pe}),_===Ui.TOME&&(0,S.jsx)(Xi,{checked:L,onClick:pe})]})]}),(0,S.jsxs)(Hi,{style:{marginTop:4},children:[_===Ui.PAGE&&(0,S.jsx)(He.Z,{onClick:Te,disabled:I.id===E.id,children:Se("sidebar.reset")}),(0,S.jsx)(He.Z,{onClick:G.open,disabled:Ie,children:`${Se("sidebar.save")} ${Se("sidebar.customizePanel.theme")}`})]})]}),(0,S.jsx)(Ur.Z,{ref:G.ref,title:`${Se("sidebar.customizePanel.saveTheme")}`,subtitle:null!==ie&&void 0!==ie&&null!==(h=ie.tome)&&void 0!==h&&null!==(f=h.org)&&void 0!==f&&f.name?Se("sidebar.customizePanel.subtitle",{context:"organization",organization:null===ie||void 0===ie||null===(b=ie.tome)||void 0===b||null===(C=b.org)||void 0===C?void 0:C.name}):Se("sidebar.customizePanel.subtitle"),primaryButtonText:Se("sidebar.save"),onSubmit:xe,placeholder:Se("sidebar.themeName")})]}),D.activeColorChange!==Wi.NONE&&(0,S.jsx)(Li,{top:je.top,right:je.left-8,color:D[D.activeColorChange],setColor:ue,setColorComplete:Pe})]})})};var na=e=>{var t,o,n,r;let{tome:i,page:s,currentPanel:c,maxHeight:d,onTileDragStart:p,onTileDragEnd:u,draggable:m,startDrag:g}=e;const h=(0,l.sJ)(kn.Qf),f=(0,a.useRef)(null),{data:b}=(0,z.OXH)({variables:{tomeId:i.id}}),C=(0,a.useMemo)((()=>{var e,t;return(0,er.Zq)(null===b||void 0===b||null===(e=b.tome)||void 0===e||null===(t=e.org)||void 0===t?void 0:t.typeFamilies)}),[null===b||void 0===b||null===(t=b.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.typeFamilies]),{t:v}=(0,y.$G)(),x=(0,S.jsxs)(S.Fragment,{children:[c===_.Z.ADD_TILE&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(Sr,{tomeId:i.id,maxHeight:d,onTileDragStart:p,onTileDragEnd:u})}),c===_.Z.RECORD&&s&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(Fr,{videoStatus:null===(n=s.overlay)||void 0===n?void 0:n.videoStatus,tomeId:i.id,pageId:s.id,videoId:null===(r=s.overlay)||void 0===r?void 0:r.videoId})}),c===_.Z.CUSTOMIZE&&s&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(oa,{nonTileSidebarRef:f,tomeId:i.id,pageId:s.id,pageTheme:s.theme,tomeTheme:i.theme,fontData:C})}),c===_.Z.ANNOTATION&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(Qn,{tomeId:i.id,annotations:s.tiles.flatMap((e=>e.annotations)).filter((e=>!!e))})})]});let O=c;return c===_.Z.RECORD?O=v("sidebar.nonTileSidebar.record"):c===_.Z.CUSTOMIZE?O=v("sidebar.nonTileSidebar.setTheme"):c===_.Z.ANNOTATION&&(O=v(null!==h?"sidebar.nonTileSidebar.editAnnotation":"sidebar.nonTileSidebar.addAnnotation")),(0,S.jsx)(co,{ref:f,hasHeader:c!==_.Z.ADD_TILE,headerText:`${v("sidebar.header",{header:O})}`,contentNoPadding:!0,panelContent:x,draggable:m,startDrag:g})},ra=o(86760);function ia(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function aa(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ia(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ia(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const la=(0,b.ZP)(f.animated.div).withConfig({displayName:"PropertyPanel__PanelContainer",componentId:"sc-1lja238-0"})(["width:","px;display:flex;align-items:center;position:absolute;top:50%;translate:0 calc(-50% - ","px);right:","px;cursor:default;"," transition:opacity 0.1s ease-in;will-change:transition,transform,opacity;"],(e=>e.$width),(e=>e.theme.headerHeight/2),(e=>e.$toolbarWidth+e.theme.panelSpacing),(e=>{let{$draggablePanelsFlag:t}=e;return t&&`z-index: ${T.IT};`})),sa=(0,b.ZP)(d.E.div).withConfig({displayName:"PropertyPanel__PanelStyles",componentId:"sc-1lja238-1"})(["margin-right:","px;padding:0;border-radius:16px;z-index:",";width:240px;height:fit-content;background:",";box-shadow:",";",""],(e=>e.theme.panelSpacing),T.Mf,(e=>e.theme.colors.sidebar),(e=>e.theme.colors.panelBoxShadow),ra.Z),ca=[_.Z.TILE,_.Z.COLOR_PICKER,_.Z.TEXT_COLOR_PICKER,_.Z.IMAGE_GENERATION_HISTORY,_.Z.IMAGE_EDIT,_.Z.OUTPAINTING,_.Z.IMAGE_CREATE],da=(0,a.forwardRef)(((e,t)=>{let{tome:o,width:n,toolbarWidth:r,height:i,style:s}=e;const d=(0,b.Fg)(),p=(0,l.sJ)(H.Vx),u=(0,V.yW)(o.pages,p),m=(0,c.l)(H.Dm),g=(0,$.Z)(m),h=(0,E.Z5)(),{0:f,1:y}=(0,a.useState)(!1),{0:C,1:v}=(0,a.useState)({top:0,bottom:0,left:0,right:0}),x=(0,E.f3)(),O=(0,E.t2)(),P=(0,E.sD)(),{propertyPanelRef:j}=(0,N.TR)(),{width:w=0,height:T=0}=(0,F.Z)(),I=(0,a.useCallback)((()=>{var e;const t=null===(e=j.current)||void 0===e?void 0:e.getBoundingClientRect();t&&v({top:12-t.top,left:12-t.left,right:w-(t.left+t.width)-12,bottom:T-(t.top+t.height)-12})}),[j,T,w]);(0,L.Z)({ref:j,onResize:()=>{I()}});const k=(0,l.sJ)(H.uz),Z=(0,a.useCallback)((()=>{k()}),[k]);(0,a.useEffect)((()=>{I()}),[T,w,m,I]),(0,a.useEffect)((()=>{m&&x&&(P?O.resetIsManuallySet():g&&m!==g&&""!==g&&(h>1||x===_.Z.TEXT_COLOR_PICKER)&&O.popPropertyPanel())}),[P,x,g,O,h,m]);const D=(0,a.useCallback)((()=>{I()}),[I]);(0,a.useImperativeHandle)(t,(()=>({triggerReMeasure:D})));const M=(0,B.ye)(B.TT.DRAGGABLE_PANELS),R=(0,A.o)(),G=(0,a.useCallback)((e=>R.start(e)),[R]),z=(0,a.useCallback)((()=>{y(!0)}),[]),U=(0,a.useCallback)((e=>{let{dismiss:t=!1}=e;y(!1),t&&O.closePropertyPanel()}),[O]);if(!x)return null;const W=M,q=x!==_.Z.ADD_TILE,K=i-2*d.headerHeight-32-43*(q?1:0),Y=ca.includes(x)?(0,S.jsx)(En,{tomeId:o.id,currentPanel:x,draggable:W,startDrag:W?G:void 0}):(0,S.jsx)(na,{tome:o,page:u,currentPanel:x,maxHeight:K,draggable:W,startDrag:W?G:void 0,onTileDragStart:z,onTileDragEnd:U});return(0,S.jsx)(la,{style:aa(aa({},s),f?{opacity:0,pointerEvents:"none"}:{opacity:1}),$width:n,$toolbarWidth:r,"data-testid":"property_panel_container",onClick:Z,$draggablePanelsFlag:M,children:W?(0,S.jsx)(sa,{drag:!0,dragListener:!1,dragMomentum:!1,dragControls:R,dragElastic:.1,dragConstraints:C,ref:j,children:Y},m):(0,S.jsx)(sa,{ref:j,children:Y})})}));var pa=da,ua=o(57819),ma=o(22817);var ga=e=>{let{tomeId:t}=e;const{apolloClient:o,clientId:n}=(0,N.bp)(),{user:r,loading:i,error:l}=(0,a.useContext)(dr.Z),c=!i&&!l&&!!r,d=(0,a.useRef)(),p=(0,a.useRef)();return(0,a.useEffect)((()=>(c&&p.current!==t&&(p.current&&d.current&&d.current.unsubscribe(),d.current=function(e,t,o){return e.subscribe({query:z.e9Y,variables:{tomeId:t,clientId:o}}).subscribe({next(t){let{data:o}=t;if(o&&o.tomeEdit)switch(o.tomeEdit.type){case z._tx.Generic:{const{edit:t}=o.tomeEdit;(0,gi.Bw)(t,e.cache);break}case z._tx.CreateComment:{const{comment:t}=o.tomeEdit;(0,ua.I0)(e.cache,t);break}case z._tx.UpdateComment:{const{comment:t}=o.tomeEdit;(0,ua.QA)(e.cache,t);break}case z._tx.DeleteComment:{const{comment:t}=o.tomeEdit;(0,ua.PS)(e.cache,t);break}case z._tx.Presence:{const t=o.tomeEdit;ma.z.updateTomePresenceWithPresenceEdit(e.cache,t),ma.z.updatePagePresenceWithPresenceEdit(e.cache,t);break}default:s.v.addError(new Error(`Unknown edit type: ${o.tomeEdit.type}`),{edit:o.tomeEdit})}else s.v.addError(new Error("No tomeEdit data in subscription"),{data:o})},error(e){console.error("err",e),s.v.addError(e)}})}(o,t,n),p.current=t),()=>{d.current&&(d.current.unsubscribe(),d.current=void 0,p.current=void 0)})),[o,t,n,c]),null},ha=o(3853),fa=o(57142),ba=o(86781);var ya=e=>{const[t,o]=(0,l.FV)(H.Vx),n=(0,V.xh)(e,t),r=n>0,i=n<e.length-1,s=(0,a.useCallback)((()=>{i&&o(e[n+1].id)}),[n,i,e,o]),c=(0,a.useCallback)((()=>{r&&o(e[n-1].id)}),[n,r,e,o]);return(0,a.useMemo)((()=>({hasPrevPage:r,hasNextPage:i,nextPage:s,prevPage:c})),[i,r,s,c])};var Ca=e=>{let{timeout:t,visibilityBasedOnMouseEvent:o,disabled:n}=e;const r=(0,a.useRef)(),{0:i,1:l}=(0,a.useState)(!1),s=(0,a.useCallback)((()=>l(!1)),[l]),c=(0,a.useCallback)((()=>l(!0)),[l]),d=(0,a.useCallback)((()=>{r.current=setTimeout((()=>{c()}),t)}),[t,r,c]),p=(0,a.useCallback)((()=>{r.current&&clearTimeout(r.current),s()}),[r,s]),u=(0,a.useCallback)((()=>{n||(r.current&&clearTimeout(r.current),d())}),[n,d]),m=(0,a.useCallback)((e=>{o(e)?p():u()}),[o,p,u]);return(0,a.useEffect)((()=>(n?(r.current&&clearTimeout(r.current),document.removeEventListener("mousemove",m)):(document.addEventListener("mousemove",m),d()),()=>{r.current&&clearTimeout(r.current),document.removeEventListener("mousemove",m)})),[n,r,m,d]),{isHidden:i,show:s,hide:c}};function va(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function xa(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?va(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):va(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Oa=(0,b.ZP)(d.E.div).withConfig({displayName:"FooterNavigation__FooterWrapper",componentId:"oll5g3-0"})(["height:","px;position:fixed;bottom:0;width:100%;display:flex;align-items:center;justify-content:space-between;padding:","px;margin-bottom:","px;"],40,16,16),Pa=(0,b.ZP)(He.Z).withConfig({displayName:"FooterNavigation__FooterNavButton",componentId:"oll5g3-1"})(["width:","px;height:","px;"],40,40);var ja=e=>{let{pages:t,isFullscreen:o}=e;const n=(0,a.useRef)(null),{currentPageRef:r}=(0,N.TR)(),i=(0,l.sJ)(w.wo),{0:s,1:c}=(0,a.useState)(!1),{0:d,1:u}=(0,a.useState)(!1),{hasPrevPage:m,hasNextPage:g,prevPage:h,nextPage:f}=ya(t),y=(0,b.Fg)(),C={width:y.largerIconSize,height:y.largerIconSize},v=(0,a.useCallback)((e=>{var t;if(!n.current)return!1;const o=n.current.getBoundingClientRect();if(e.clientY>=o.top)return u(!1),u(!1),!0;const i=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect();return e.clientX<(null===i||void 0===i?void 0:i.left)?(c(!0),!0):e.clientX>(null===i||void 0===i?void 0:i.right)?(u(!0),!0):(c(!1),u(!1),!1)}),[r]),{isHidden:x}=Ca({visibilityBasedOnMouseEvent:v,timeout:3e3,disabled:o}),O=(0,a.useMemo)((()=>({animate:{opacity:t.length<2||x||o||i?0:1},transition:I.Z2,initial:{opacity:1},exit:{opacity:0}})),[t.length,x,o,i]);return(0,S.jsx)(p.M,{children:(0,S.jsxs)(Oa,xa(xa({ref:n,"data-testid":"footer_navigation"},O),{},{children:[(0,S.jsx)(Pa,{variant:"text",disabled:!m,onClick:h,"aria-label":"Previous page",iconStyles:{margin:0,transform:s&&m?"translateX(-4px)":"none",transition:"transform 0.3s ease-out"},startIcon:(0,S.jsx)(fa.Z,{style:C}),style:m?{}:{visibility:"hidden"}}),(0,S.jsx)(Pa,{variant:"text",disabled:!g,onClick:f,"aria-label":"Next page",iconStyles:{margin:0,transform:d&&g?"translateX(4px)":"none",transition:"transform 0.3s ease-out"},startIcon:(0,S.jsx)(ba.Z,{style:C}),style:g?{}:{visibility:"hidden"}})]}))})},wa=o(41664),Ta=o.n(wa),Ia=o(37982),Ea=o(52260),_a=o(33159),Sa=o(87495),ka=o(57451);function Za(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Da(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Za(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ma=b.ZP.div.withConfig({displayName:"PageProgressIndicator__IndicatorStyles",componentId:"ijfywb-0"})(["display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%;"]),Ra=b.ZP.div.withConfig({displayName:"PageProgressIndicator__ProgressSegment",componentId:"ijfywb-1"})(["width:100%;height:2px;border-top-left-radius:",";border-bottom-left-radius:",";border-top-right-radius:",";border-bottom-right-radius:",";background-color:",";"],(e=>{let{$withLeftRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withLeftRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withRightRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withRightRadius:t}=e;return t?"4px":"0"}),(e=>{let{$active:t,theme:o}=e;return t?o.colors.contrast60:o.colors.contrast16})),Aa=b.ZP.div.withConfig({displayName:"PageProgressIndicator__ProgressSegmentHover",componentId:"ijfywb-2"})(["width:",";margin-left:","px;",""],(e=>{let{$width:t}=e;return"number"===typeof t?`${t}px`:t}),(e=>{let{$space:t}=e;return t}),(e=>{let{$interactive:t,$active:o,theme:n}=e;return t&&(0,b.iv)(["cursor:pointer;padding:4px 0;&:hover ","{background-color:",";}"],Ra,o?n.colors.contrast60:n.colors.contrast25)}));var La=e=>{let{pageIds:t,maxComponentWidthPx:o,activePageId:n,onSegmentClick:r,isMobile:i,numPages:a}=e;const l=n?t.indexOf(n):-1;let s=40,c=3;(i||40*a+3*(a-1)>o)&&(s=(o-3*(a-1))/a,s<24&&(s=100/a+"%",c=0));const d=Array.from(Array(a).keys());return(0,S.jsx)(Ma,{"data-testid":`active_page_index_${l}`,"data-tome-bypass-tap-navigation":!0,children:(0,S.jsx)(st.Z,{placement:"bottom",style:{width:"100%",justifyContent:"center"},children:d.map((e=>{const o=t[e]||`fake_page_id_${e}`,n=!t[e];return(0,S.jsx)(Aa,Da(Da({$active:e<=l,$width:s,$space:0===e?0:c,onClick:()=>{n||r(o)},$interactive:!i},i?{}:{renderTooltip:()=>`Page ${e+1} of ${a}`}),{},{children:(0,S.jsx)(Ra,{"data-testid":"progress_segment",$active:e<=l,$withLeftRadius:c>0||0===e,$withRightRadius:c>0||e===a-1})}),o)}))})})},Na=o(4832),Ha=o(60559);const Va=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderLeft",componentId:"sc-883y9v-0"})(["display:flex;justify-content:flex-start;flex:1;min-width:calc(33% - ","px);margin-left:10px;overflow:hidden;"],(e=>{let{$gap:t}=e;return t})),Ba=b.ZP.div.withConfig({displayName:"Headerstyles__HeaderMiddle",componentId:"sc-883y9v-1"})(["display:flex;justify-content:center;overflow:hidden;flex:'initial';",""],(e=>{let{$presentMode:t,$gap:o}=e;return t&&(0,b.iv)(["flex:1;margin-left:","px;margin-right:","px;"],o,o)})),Fa=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderRight",componentId:"sc-883y9v-2"})(["position:relative;display:flex;justify-content:flex-end;flex:",";margin-right:10px;overflow:hidden;min-width:","px;"],(e=>{let{$presentMode:t}=e;return t?"1":"0 0 auto"}),205),$a=b.ZP.div.withConfig({displayName:"Headerstyles__HeaderWrapper",componentId:"sc-883y9v-3"})(["z-index:",";pointer-events:none;&::before{background-image:",";content:'';height:","px;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1;opacity:",";transition:opacity 0.3s ease;}"],T.bf,(e=>{let{$presentMode:t,theme:o}=e;return t?o.gradients.headerGradientPresent:o.gradients.headerGradient}),Ha.Zk,(e=>{let{$showScrim:t}=e;return t?1:0})),Ga=b.ZP.div.withConfig({displayName:"Headerstyles__Header",componentId:"sc-883y9v-4"})(["display:flex;width:100%;z-index:",";cursor:default;height:","px;position:relative;color:",";"," *,"," *,"," *{pointer-events:",";}"],T.bf,(e=>{let{theme:t}=e;return t.headerHeight}),(e=>{let{theme:t}=e;return t.colors.contrast}),Va,Ba,Fa,(e=>{let{$pointerEventsEnabled:t}=e;return t?"auto":"none"})),za=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderComponent",componentId:"sc-883y9v-5"})(["display:flex;flex-direction:row;align-items:center;justify-content:center;position:relative;height:","px;"],(e=>{let{theme:t}=e;return t.headerHeight})),Ua=(0,b.ZP)(za).withConfig({displayName:"Headerstyles__HeaderRightHeaderComponent",componentId:"sc-883y9v-6"})(["margin-left:8px;"]),Wa=(0,b.ZP)(He.Z).attrs((e=>({variant:"text",opacity:e.theme.opacity.headerButtonText,iconOpacity:e.theme.opacity.headerButtonIcons}))).withConfig({displayName:"Headerstyles__HeaderButton",componentId:"sc-883y9v-7"})(["height:32px;width:40px;"]),qa=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__Transition",componentId:"sc-883y9v-8"})(["position:absolute;left:0;top:0;"]),Ka=b.ZP.div.withConfig({displayName:"MobileHeader__MobileHeaderStyles",componentId:"sc-1pm5ycw-0"})(["position:fixed;width:100%;z-index:",";"],T.bf),Ya=b.ZP.div.withConfig({displayName:"MobileHeader__PageProgressIndicatorStyles",componentId:"sc-1pm5ycw-1"})(["padding:8px ","px 0;width:100%;"],24),Ja=(0,b.ZP)(d.E.div).withConfig({displayName:"MobileHeader__AttributionRow",componentId:"sc-1pm5ycw-2"})(["display:flex;width:100%;padding:0 ","px;justify-content:space-between;"],24),Xa=b.ZP.div.withConfig({displayName:"MobileHeader__AttributionLeft",componentId:"sc-1pm5ycw-3"})(["display:flex;align-items:center;flex:1;overflow-x:hidden;"]),Qa=b.ZP.div.withConfig({displayName:"MobileHeader__AttributionRight",componentId:"sc-1pm5ycw-4"})(["display:flex;margin-left:12px;align-items:center;color:",";"],(e=>{let{theme:t}=e;return t.colors.headerLogo})),el=b.ZP.span.withConfig({displayName:"MobileHeader__ButtonInner",componentId:"sc-1pm5ycw-5"})(["display:flex;align-items:center;"]);var tl=e=>{var t,o,n;let{isInExpandMode:r,tome:i,className:s}=e;const c=(0,ka.Z)(),{workspaceUrl:d,apolloClient:p}=(0,N.bp)(),[u,m]=(0,l.FV)(H.Vx),g=(0,l.sJ)(Ea.R),h=(0,l.sJ)(H.SM),{user:f,loading:b}=(0,a.useContext)(dr.Z),C=!(!f||!f.id),v=(0,V.yW)(i.pages,u),{t:x}=(0,y.$G)(),O=(0,a.useCallback)((()=>{_a.ZP.reportTryTomeClickEvent({apolloClient:p,tomeId:i.id,pageId:u})}),[i,u,p]),P=(0,Sa.iR)(void 0,"/signup",{utmMedium:"referral",utmSource:h?"public_tome_embedded":"public_tome",utmCampaign:i.id,utmContent:"public_tome_logo"}),j=(0,Na.I)(null===i||void 0===i||null===(t=i.org)||void 0===t?void 0:t.logo),w=(null===(o=i.org)||void 0===o?void 0:o.showTomeBranding)??!0,T=c?window.innerWidth:400;return(0,a.useEffect)((()=>{document.body.style.setProperty("--mobile-header-top-padding",g?"52px":"10px")}),[g]),(0,S.jsxs)(Ka,{className:s,children:[i.pages.length>1&&!r&&(0,S.jsx)(Ya,{children:(0,S.jsx)(La,{pageIds:i.pages.map((e=>e.id)),activePageId:u,onSegmentClick:m,maxComponentWidthPx:T-48,isMobile:!0,numPages:i.numPages})}),!r&&(0,S.jsxs)(Ja,{animate:{height:g?52:0,opacity:g?1:0},initial:{height:g?52:0,opacity:g?1:0},transition:I.Z2,"data-testid":"mobile_header_attribution",style:{pointerEvents:g?"auto":"none"},children:[(0,S.jsx)(Xa,{children:j&&(0,S.jsx)(Na.Z,{show:i.showLogo,logo:null===(n=i.org)||void 0===n?void 0:n.logo,theme:v.theme})}),!b&&(0,S.jsxs)(Qa,{"data-tome-bypass-tap-navigation":"MobileHeader__AttributionRight",children:[C&&(0,S.jsx)(Ta(),{href:d,children:(0,S.jsx)(Ia.Z,{style:{height:24,width:24,opacity:.8}})}),!C&&w&&(0,S.jsx)(Ta(),{href:P,children:(0,S.jsxs)(Wa,{onClick:O,variant:"text",style:{width:"unset",padding:"0px"},children:[(0,S.jsx)(Ia.Z,{style:{height:18,width:18}}),(0,S.jsxs)(el,{children:["\xa0",x("tome.header.mobileHeader.tryTomeButtonLabel")]})]})})]})]})]})},ol=o(30587),nl=o(16320);const rl=b.ZP.span.withConfig({displayName:"BadgeChip__StyledComponent",componentId:"nuq6re-0"})(["position:relative;"]),il=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeIcon",componentId:"nuq6re-1"})(["display:flex;align-items:center;& > svg{height:14px;width:14px;}"]),al=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeChildren",componentId:"nuq6re-2"})(["display:flex;"]),ll=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeDisplay",componentId:"nuq6re-3"})(["display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;align-content:center;align-items:center;box-sizing:border-box;z-index:1;border-radius:",";font-size:",";font-weight:400;height:22px;min-width:20px;padding:12px;background-color:",";color:",";"],(e=>{let{theme:t}=e;return t.borderRadius.xs}),(e=>{let{theme:t}=e;return t.fontSizes.sm}),(e=>{let{color:t,theme:o}=e;return"destructive"===t?o.colors.redBadgeBackground:"inherit"}),(e=>{let{color:t,theme:o}=e;return"destructive"===t?o.colors.redBadge:"inherit"}));var sl=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(rl,{as:e.component,ref:t,children:(0,S.jsx)(st.Z,{content:e.toolTipContent,placement:"bottom",perpendicularOffset:-20,children:(0,S.jsxs)(ll,{color:e.color,children:[(0,S.jsx)(il,{children:e.icon}),(0,S.jsx)(al,{children:e.children})]})})}))),cl=o(1653),dl=o(47901),pl=o(76661);var ul=pl.Ps`
  mutation CREATE_PERMISSION_MUTATION(
    $id: String!
    $tomeId: String!
    $email: String!
    $role: TomeRole!
  ) {
    createPermissionWithUser(
      input: { id: $id, tomeId: $tomeId, email: $email, role: $role }
    ) {
      ... on Permission {
        ...PermissionFragment
      }
      ... on PermissionError {
        message
      }
    }
  }
  ${z.VJv}
`;var ml=pl.Ps`
  mutation DELETE_PERMISSION_MUTATION($id: String!) {
    deletePermission(input: { id: $id }) {
      ... on PermissionSuccess {
        id
        tome {
          id
        }
      }
      ... on PermissionError {
        message
      }
    }
  }
`;var gl=pl.Ps`
  mutation UPDATE_PERMISSION_MUTATION($id: String!, $role: TomeRole!) {
    updatePermission(input: { id: $id, role: $role }) {
      ... on Permission {
        ...PermissionFragment
      }
      ... on PermissionError {
        message
      }
    }
  }
  ${z.VJv}
`;function hl(e,t,o){const n=e.writeFragment({id:`Permission:${t.id}`,fragment:z.VJv,data:t,fragmentName:"PermissionFragment"});e.modify({id:e.identify(o),fields:{permissions:e=>e.every((e=>e.__ref!==(null===n||void 0===n?void 0:n.__ref)))?[...e,n]:e}})}function fl(e){const{__typename:t,message:o}=e;return!("PermissionError"!==t||!o)&&((0,H.ak)({message:o}),!0)}const bl={value:"NONE",label:"No access"},yl={value:"VIEWER",label:"Can play",description:"Tome opens in present mode for visitors"},Cl=[yl,{value:"COMMENTER",label:"Can comment"},{value:"EDITOR",label:"Can edit"},{value:"FULL",label:"Full access"}],vl=[bl,...Cl],xl=[bl,yl];var Ol=o(48811);function Pl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function jl(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Pl(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Pl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var wl=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,jl(jl({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M8.80235 18.5039C8.94529 18.2101 9.33262 18.161 9.56361 18.392L21.8601 30.6886C22.0473 30.8757 22.0562 31.1764 21.8803 31.3743L9.46525 45.3412C9.23616 45.5989 8.82154 45.5521 8.68189 45.2369C8.24352 44.2472 8 43.1521 8 42V22C8 20.7464 8.28835 19.5601 8.80235 18.5039Z"}),(0,S.jsx)("path",{d:"M12.2693 49.0787C11.9958 48.9342 11.9445 48.5728 12.15 48.3416L24.6745 34.2516C24.8656 34.0366 25.1983 34.0268 25.4018 34.2302L27.7574 36.5858C30.1005 38.9289 33.8995 38.9289 36.2426 36.5858L38.5982 34.2302C38.8017 34.0268 39.1344 34.0366 39.3255 34.2516L51.85 48.3416C52.0555 48.5728 52.0042 48.9342 51.7307 49.0787C50.6168 49.6669 49.3473 50 48 50H16C14.6527 50 13.3832 49.6669 12.2693 49.0787Z"}),(0,S.jsx)("path",{d:"M54.5348 45.3412C54.7638 45.5989 55.1785 45.5521 55.3181 45.2369C55.7565 44.2472 56 43.1521 56 42V22C56 20.7464 55.7116 19.5601 55.1977 18.5039C55.0547 18.2101 54.6674 18.161 54.4364 18.392L42.1399 30.6886C41.9527 30.8757 41.9438 31.1764 42.1197 31.3743L54.5348 45.3412Z"}),(0,S.jsx)("path",{d:"M12.392 15.5636C12.161 15.3326 12.2101 14.9453 12.5039 14.8024C13.5601 14.2884 14.7464 14 16 14H48C49.2536 14 50.4399 14.2884 51.4961 14.8023C51.7899 14.9453 51.839 15.3326 51.608 15.5636L33.4142 33.7574C32.6332 34.5384 31.3668 34.5384 30.5858 33.7574L12.392 15.5636Z"})]}))));const Tl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__Wrapper",componentId:"tr8c03-0"})(["display:flex;flex-direction:row;align-items:center;height:32px;.control{margin-left:auto;}"]),Il=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__IconStyles",componentId:"tr8c03-1"})(["svg{flex-shrink:0;}"]),El=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItem",componentId:"tr8c03-2"})(["margin:0;padding-left:8px;flex-grow:1;display:flex;align-items:baseline;overflow:hidden;"]),_l=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemHeading",componentId:"tr8c03-3"})(["font-size:",";font-weight:400;line-height:17px;",""],(e=>{let{theme:t}=e;return t.fontSizes.sm}),Jr.wR),Sl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemPending",componentId:"tr8c03-4"})(["color:",";font-size:",";padding:0 0.5em;"],(e=>{let{theme:t}=e;return t.colors.contrast40}),(e=>{let{theme:t}=e;return t.fontSizes.sm})),kl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemGuest",componentId:"tr8c03-5"})(["color:",";font-size:",";padding:0 0.5em;"],(e=>{let{theme:t}=e;return t.colors.guestBadgeText}),(e=>{let{theme:t}=e;return t.fontSizes.sm})),Zl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__OwnerLabel",componentId:"tr8c03-6"})(["font-size:13px;min-height:28px;line-height:16px;height:28px;padding:6px 8px;color:",";"],(e=>{let{theme:t}=e;return t.colors.ownerBadgeText}));function Dl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ml(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Dl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Rl=e=>{let{icon:t,heading:o,disabled:n,handler:r=(()=>{}),currentValue:i="",options:a=[],pending:l=!1,guest:s=!1}=e;const c=(0,b.Fg)(),{t:d}=(0,y.$G)(),p={control:(e,t)=>Ml(Ml({},e),{},{flexWrap:"nowrap",width:t.selectProps.controlWidth,boxSizing:"border-box",border:0,borderRadius:"6px",boxShadow:"none",fontSize:"13px",lineHeight:"16px",height:"28px",minHeight:"28px",padding:"6px 8px",color:t.isDisabled?c.colors.contrast20:c.colors.secondaryUiText,"&:hover":{backgroundColor:c.colors.menuControlHover},backgroundColor:c.colors.sheetBg,cursor:"pointer",whiteSpace:"nowrap"}),dropdownIndicator:(e,t)=>Ml(Ml({},e),{},{paddingRight:0,paddingTop:"3px",paddingBottom:"3px",paddingLeft:"6px",color:t.isDisabled?c.colors.contrast20:"currentColor"}),group:()=>({borderTop:`1px solid ${c.colors.contrast8}`}),indicatorsContainer:(e,t)=>Ml(Ml({},e),{},{height:"16px",padding:"0",margin:0,display:t.isDisabled?"none":"block",stroke:c.colors.secondaryUiText}),singleValue:()=>({display:"flex",flexShrink:0}),valueContainer:e=>Ml(Ml({},e),{},{padding:0,flexWrap:"nowrap"}),menu:(e,t)=>Ml(Ml({},e),{},{width:t.selectProps.menuWidth,fontSize:"13px",lineHeight:"16px",marginTop:"-28px",padding:"6px",color:c.colors.secondaryUiText,backgroundColor:c.colors.menuBackgroundLayer[0],right:0})},u=(0,S.jsx)(je,{onChange:r,handler:r,styles:p,options:a,disabled:n,currentValue:i??"",menuWidth:"156px",backgroundColor:c.colors.transparent});return(0,S.jsxs)(Tl,{children:[(0,S.jsx)(Il,{children:t}),(0,S.jsxs)(El,{children:[(0,S.jsx)(_l,{title:o,children:o}),l&&(0,S.jsx)(Sl,{children:d("tome.sharingSheetRow.pendingUserMenuItemLabel")}),s&&!l&&(0,S.jsx)(kl,{children:d("tome.sharingSheetRow.guestUserMenuItemLabel")})]}),u]})};const Al=b.ZP.div.withConfig({displayName:"SharingSheetstyles__SharingSheetWrapper",componentId:"sc-19huyep-0"})(["cursor:default;position:absolute;top:","px;right:12px;pointer-events:auto;color:",";> div{background:",";box-shadow:",";width:360px;border-radius:18px;padding:6px 12px 12px 12px;}z-index:",";"],(e=>e.theme.headerHeight),(e=>e.theme.colors.primaryUiText),(e=>{let{theme:t}=e;return t.colors.sheetBg}),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow}),T.Ue),Ll=b.ZP.div.withConfig({displayName:"SharingSheetstyles__SharingSheetIconWrap",componentId:"sc-19huyep-1"})(["height:20px;width:20px;background-color:",";border-radius:10px;overflow:hidden;display:flex;& ","{height:16px;margin:2px;opacity:0.5;}"],(e=>{let{theme:t}=e;return t.colors.iconBg}),we.K),Nl=b.ZP.hr.withConfig({displayName:"SharingSheetstyles__SharingSheetSeparator",componentId:"sc-19huyep-2"})(["border:0;height:1px;margin:4px 0;background-color:",";"],(e=>{let{theme:t}=e;return t.colors.separator}));var Hl=e=>{var t;let{tome:o}=e;const{apolloClient:n}=(0,N.bp)(),{data:r}=(0,z.BYn)({variables:{id:o.id},fetchPolicy:"cache-and-network"}),i=(0,b.Fg)(),{t:a}=(0,y.$G)(),{canManage:l}=o.currentUserPermission,s=(e,t)=>{"remove"===t?function(e,t){e.mutate({mutation:ml,variables:{id:t},update(e,t){let{data:{deletePermission:o}}=t;fl(o)||function(e,t){e.modify({id:`Tome:${t.tome.id}`,fields:{permissions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:o}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>t.id!==o("id",e)))}}})}(e,o)}})}(n,e):function(e,t,o){e.mutate({mutation:gl,variables:{id:t,role:o},update(e,t){let{data:{updatePermission:o}}=t;fl(o)||function(e,t){e.modify({id:e.identify(t),fields:{role:e=>t.role??e}})}(e,o)}})}(n,e,t)};return(0,S.jsx)(S.Fragment,{children:null===r||void 0===r||null===(t=r.tome)||void 0===t?void 0:t.permissions.map((e=>(0,S.jsx)(Rl,{handler:t=>s(e.id,t),icon:e.user.pending?(0,S.jsx)(Ll,{children:(0,S.jsx)(wl,{})}):(0,S.jsx)(Ol.Z,{user:e.user,size:20}),pending:e.user.pending,guest:e.isGuest||!1,currentValue:e.role,heading:e.user.name||e.user.email,options:[...Cl,{options:[{label:a("tome.sharingSheetIndividuals.removeAccessLabel"),value:"remove",color:i.colors.red,colorHover:i.colors.contrast,backgroundColorHover:i.colors.red}]}],disabled:!l},e.user.id)))})},Vl=o(1027);var Bl=e=>{const{items:t,isMenuOpen:o,onDismiss:n}=e,{0:r,1:i}=(0,a.useState)(0),l=(0,a.useCallback)((e=>r===e),[r]),s=(0,a.useCallback)((e=>{i(e)}),[i]),c=(0,a.useCallback)((e=>{if(!o)return;e.preventDefault();let n=r+1;for(;n<t.length;){const e=t[n],{type:o="option",disabled:r}=e;if(!r&&"option"===o)break;n+=1}n!==t.length&&i(n)}),[r,i,t]),d=(0,a.useCallback)((e=>{if(!o)return;e.preventDefault();let n=r-1;for(;n>=0;){const e=t[n],{type:o="option",disabled:r}=e;if(!r&&"option"===o)break;n-=1}n<0||i(n)}),[r,i,t]),p=(0,a.useCallback)((e=>{var n,i;t.length>0&&o&&(null===(n=t[r])||void 0===n||null===(i=n.action)||void 0===i||i.call(n),e.preventDefault())}),[t,r]),u=(0,a.useCallback)((e=>{o&&(i(0),e.preventDefault()),n()}),[n,i]),m=(0,a.useCallback)((e=>{"ArrowDown"===e.key?c(e):"ArrowUp"===e.key?d(e):"Enter"===e.key?p(e):"Escape"===e.key&&u(e)}),[c,d,p,u]);return(0,a.useMemo)((()=>({isIndexSelected:l,setIndex:s,onKeyPress:m})),[l,s,m])},Fl=o(9517);const $l=b.ZP.div.withConfig({displayName:"SharingSheetInvitestyles__MenuWrapper",componentId:"obue3a-0"})(["position:absolute;left:","px;top:","px;z-index:",";"],(e=>e.$left),(e=>e.$top),T.m6),Gl=b.ZP.form.withConfig({displayName:"SharingSheetInvitestyles__Form",componentId:"obue3a-1"})(["display:flex;margin:7px 0px;input{background:",";margin:0;border-top-right-radius:0;border-bottom-right-radius:0;padding:0px 12px;height:28px;min-height:28px;}> div{margin:0;display:box;width:200px;> div[class*='control']{padding-top:1px;height:28px;background:",";border-radius:0 "," "," 0;> div:first-child{height:28px;padding:0;> div{text-align:right;width:100%;flex:none;}}}> div[class*='menu']{margin-top:8px;width:200px;right:0;}}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.borderRadius.sm}),(e=>{let{theme:t}=e;return t.borderRadius.sm}));function zl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ul(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?zl(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):zl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Wl=e=>{var t,o;let{tome:n}=e;const r=(0,a.useRef)(null),{0:i,1:l}=(0,a.useState)(""),{0:s,1:c}=(0,a.useState)(z.yrp.Full),d=(0,b.Fg)(),{t:p}=(0,y.$G)(),{0:u,1:m}=(0,a.useState)(!1),{data:g,loading:h}=(0,z.vj0)(),{apolloClient:f}=(0,N.bp)(),{user:C,flags:v,loading:x}=(0,a.useContext)(dr.Z);let O=[];h||x||null===g||void 0===g||null===(t=g.me)||void 0===t||null===(o=t.org)||void 0===o||!o.members||(O=function(e){let{tome:t,members:o,value:n,currentUser:r}=e;return o.filter((e=>{var o;return(null===(o=e.name)||void 0===o?void 0:o.toLowerCase().startsWith(n.toLowerCase()))&&!t.permissions.some((t=>t.user.id===e.id))&&e.id!==(null===r||void 0===r?void 0:r.id)&&e.id!==t.author.id}))}({tome:n,members:g.me.org.members.map((e=>{let{user:t}=e;return t})),value:i,currentUser:C}));const P=Vl.G(i),j=P&&0===O.length,{data:w,loading:T}=(0,z.v7f)({skip:!j,variables:{email:i},fetchPolicy:"no-cache"});if(!T&&null!==w&&void 0!==w&&w.user&&O.push(w.user),0===O.length&&P&&null!==v&&void 0!==v&&v.externalSharing){const e={id:"pending",name:i,email:i,pending:!0,profileImage:null,__typename:"User"};O.push(e)}let I,E;if(r.current){const e=r.current;I=e.offsetTop+e.offsetHeight+6,E=e.offsetLeft}const _=!h&&i.length>0&&O.length>0&&!u&&!!r.current,k=(0,a.useCallback)((()=>{_?m(!0):r.current&&(r.current.value="")}),[_,m,r]),Z=e=>{!function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=ui()();e.mutate({mutation:ul,variables:{id:i,tomeId:t.id,role:n,email:o.email},optimisticResponse:()=>({createPermissionWithUser:{__typename:"Permission",id:i,user:o,tome:t,role:n,isGuest:r}}),update(e,o){let{data:{createPermissionWithUser:n}}=o;fl(n)||hl(e,n,t)}})}(f,n,e,s),r.current&&(r.current.value=""),m(!0)},D=O.map((e=>({text:e.name||"",image:e.profileImage&&(0,S.jsx)(Ol.Z,{user:e,size:20,delayMs:0,style:{marginRight:8}})||e.pending&&(0,S.jsx)(wl,{style:{width:20,height:20,marginRight:8}})||void 0,action:()=>{Z(e)},id:e.id}))),{isIndexSelected:M,onKeyPress:R,setIndex:A}=Bl({items:D,isMenuOpen:_,onDismiss:k}),L=(0,a.useCallback)((e=>Ul(Ul({},e),{},{onMouseEnter:()=>{A(e.index)}})),[A]);const V={control:(e,t)=>Ul(Ul({},e),{},{width:t.selectProps.controlWidth,border:0,boxShadow:"none",fontSize:"13px",height:"28px",minHeight:"28px",lineHeight:"16px",paddingLeft:"4px",color:d.colors.secondaryUiText,cursor:"pointer","&:hover":{}}),singleValue:()=>({color:d.colors.secondaryUiText}),indicatorsContainer:()=>({stroke:d.colors.secondaryUiText}),dropdownIndicator:e=>{let{display:t}=e;return{display:t,padding:"8px 8px 8px 6px"}}};return(0,a.useEffect)((()=>()=>{(0,H.ii)(!1)}),[]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(Gl,{onSubmit:e=>{e.preventDefault()},children:[(0,S.jsx)(ee.Z,{ref:r,placeholder:p("tome.sharingSheetInvite.enterEmailsOrNamesPlaceholderText"),onChange:e=>{l(e.target.value),m(!1),A(0)},onKeyDown:R,onFocus:()=>{(0,H.ii)(!0)},onBlur:()=>{(0,H.ii)(!1)}}),(0,S.jsx)(je,{onChange:c,onFocus:function(){m(!0)},onBlur:function(){m(!1)},styles:V,currentValue:s,options:Cl})]}),_&&(0,S.jsx)($l,{$left:E,$top:I,children:(0,S.jsx)(Fl.ZP,{items:D,width:316,isIndexSelected:M,getItemProps:L})})]})},ql=o(39225),Kl=o(30362);function Yl(e){let{tome:t,sameOrg:o}=e;const{apolloClient:n,clientId:r}=(0,N.bp)(),i=t.org;if(!i)return null;const{canManage:a}=t.currentUserPermission,l=!a||!o,s=(0,S.jsx)(Ll,{children:(0,S.jsx)(Kl.Z,{})});return(0,S.jsx)(Rl,{heading:i.name,currentValue:t.orgScope,icon:s,disabled:l,handler:e=>{const o={};o.orgScope="NONE"===e?null:e,(0,ql.W8)(t.id,o,n,r)},options:vl})}var Jl=e=>{let{owner:t}=e;const{t:o}=(0,y.$G)();return(0,S.jsxs)(Tl,{children:[(0,S.jsx)(Il,{children:(0,S.jsx)(Ol.Z,{user:t,size:20})}),(0,S.jsx)(El,{children:(0,S.jsx)(_l,{title:o("tome.ownerRow.OwnerLabel"),children:t.name??o("tome.ownerRow.unknownOwnerName")})}),(0,S.jsx)(Zl,{children:o("tome.ownerRow.OwnerLabel")})]})},Xl=o(80308);var Ql=e=>{let{tome:t,publicSharing:o}=e;const{t:n}=(0,y.$G)(),{canManage:r}=t.currentUserPermission,{apolloClient:i,clientId:a}=(0,N.bp)();return(0,S.jsx)(Rl,{icon:(0,S.jsx)(Ll,{children:(0,S.jsx)(Xl.Z,{})}),handler:e=>{const o={};o.publicScope="NONE"===e?null:e,(0,ql.W8)(t.id,o,i,a)},options:xl,heading:n("tome.shareSheetPublic.anyoneWithTheLinkCanViewTomeLabel"),disabled:!r||!o,currentValue:t.publicScope})};function es(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ts(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?es(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):es(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var os=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,ts(ts({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0209 16.0209C12.0209 13.8118 13.8117 12.0209 16.0209 12.0209H20.0209C22.23 12.0209 24.0209 13.8118 24.0209 16.0209V20.0209C24.0209 22.23 22.23 24.0209 20.0209 24.0209H16.0209H16.0209C13.8117 24.0209 12.0209 22.23 12.0209 20.0209V16.0209ZM16.0209 19.0209C16.0209 19.5732 16.4686 20.0209 17.0209 20.0209H19.0209C19.5732 20.0209 20.0209 19.5732 20.0209 19.0209V17.0209C20.0209 16.4686 19.5732 16.0209 19.0209 16.0209H17.0209C16.4686 16.0209 16.0209 16.4686 16.0209 17.0209V19.0209ZM14.0209 32.0209H15.5209C15.797 32.0209 16.0209 31.797 16.0209 31.5209V30.0209C16.0209 28.9163 16.9163 28.0209 18.0209 28.0209C19.1254 28.0209 20.0209 28.9163 20.0209 30.0209V31.5209C20.0209 31.797 20.2447 32.0209 20.5209 32.0209H22.0209C23.1254 32.0209 24.0209 32.9163 24.0209 34.0209C24.0209 35.1255 23.1254 36.0209 22.0209 36.0209H14.0209C12.9163 36.0209 12.0209 35.1255 12.0209 34.0209C12.0209 32.9163 12.9163 32.0209 14.0209 32.0209ZM12.0209 44.0209C12.0209 41.8118 13.8117 40.0209 16.0209 40.0209H20.0209C22.23 40.0209 24.0209 41.8118 24.0209 44.0209V48.0209C24.0209 50.23 22.23 52.0209 20.0209 52.0209H16.0209H16.0209C13.8117 52.0209 12.0209 50.23 12.0209 48.0209V44.0209ZM16.0209 47.0209C16.0209 47.5732 16.4686 48.0209 17.0209 48.0209H19.0209C19.5732 48.0209 20.0209 47.5732 20.0209 47.0209V45.0209C20.0209 44.4686 19.5732 44.0209 19.0209 44.0209H17.0209C16.4686 44.0209 16.0209 44.4686 16.0209 45.0209V47.0209ZM50.0209 52.0209H46.0209C44.9163 52.0209 44.0209 51.1255 44.0209 50.0209C44.0209 48.9163 44.9163 48.0209 46.0209 48.0209H50.0209C51.1254 48.0209 52.0209 48.9163 52.0209 50.0209C52.0209 51.1255 51.1254 52.0209 50.0209 52.0209ZM52.0209 38.0209C52.0209 39.1255 51.1254 40.0209 50.0209 40.0209H48.5209C48.2447 40.0209 48.0209 40.2448 48.0209 40.5209V42.0209C48.0209 43.1255 47.1254 44.0209 46.0209 44.0209C44.9163 44.0209 44.0209 43.1255 44.0209 42.0209V38.0209C44.0209 36.9163 44.9163 36.0209 46.0209 36.0209H47.5209C47.797 36.0209 48.0209 35.797 48.0209 35.5209V32.5209C48.0209 32.2448 47.797 32.0209 47.5209 32.0209H46.0209C44.9163 32.0209 44.0209 31.1255 44.0209 30.0209C44.0209 28.9163 44.9163 28.0209 46.0209 28.0209H50.0209C51.1254 28.0209 52.0209 28.9163 52.0209 30.0209V38.0209ZM44.0209 12.0209H48.0209C50.23 12.0209 52.0209 13.8118 52.0209 16.0209V20.0209C52.0209 22.23 50.23 24.0209 48.0209 24.0209H44.0209C41.8117 24.0209 40.0209 22.23 40.0209 20.0209V16.0209V16.0208C40.0209 13.8117 41.8117 12.0208 44.0209 12.0208V12.0209ZM44.0209 19.0209C44.0209 19.5732 44.4686 20.0209 45.0209 20.0209H47.0209C47.5732 20.0209 48.0209 19.5732 48.0209 19.0209V17.0209C48.0209 16.4686 47.5732 16.0209 47.0209 16.0209H45.0209C44.4686 16.0209 44.0209 16.4686 44.0209 17.0209V19.0209ZM30.0209 16.0209C28.9163 16.0209 28.0209 15.1255 28.0209 14.0209C28.0209 12.9163 28.9163 12.0209 30.0209 12.0209H34.0209C35.1254 12.0209 36.0209 12.9163 36.0209 14.0209V23.5209C36.0209 23.797 36.2447 24.0209 36.5209 24.0209H38.0209C39.1254 24.0209 40.0209 24.9163 40.0209 26.0209C40.0209 27.1255 39.1254 28.0209 38.0209 28.0209H34.0209C32.9163 28.0209 32.0209 27.1255 32.0209 26.0209V24.5209C32.0209 24.2448 31.797 24.0209 31.5209 24.0209H30.0209C28.9163 24.0209 28.0209 23.1255 28.0209 22.0209C28.0209 20.9163 28.9163 20.0209 30.0209 20.0209H31.5209C31.797 20.0209 32.0209 19.797 32.0209 19.5209V16.0209H30.0209ZM28.0209 32.5209C28.0209 32.2448 27.797 32.0209 27.5209 32.0209H26.0209C24.9163 32.0209 24.0209 31.1255 24.0209 30.0209C24.0209 28.9163 24.9163 28.0209 26.0209 28.0209H30.0209C31.1254 28.0209 32.0209 28.9163 32.0209 30.0209V34.0209C32.0209 35.1255 31.1254 36.0209 30.0209 36.0209C28.9163 36.0209 28.0209 35.1255 28.0209 34.0209V32.5209ZM30.0209 40.0209H31.5209C31.797 40.0209 32.0209 39.797 32.0209 39.5209V38.0209C32.0209 36.9163 32.9163 36.0209 34.0209 36.0209H35.5209C35.797 36.0209 36.0209 35.797 36.0209 35.5209V34.0209C36.0209 32.9163 36.9163 32.0209 38.0209 32.0209C39.1254 32.0209 40.0209 32.9163 40.0209 34.0209V38.0209C40.0209 39.1255 39.1254 40.0209 38.0209 40.0209H36.5209C36.2447 40.0209 36.0209 40.2448 36.0209 40.5209V42.0209C36.0209 43.1255 35.1254 44.0209 34.0209 44.0209H30.0209C28.9163 44.0209 28.0209 43.1255 28.0209 42.0209C28.0209 40.9163 28.9163 40.0209 30.0209 40.0209ZM38.0209 44.0209C39.1254 44.0209 40.0209 44.9163 40.0209 46.0209V50.0209C40.0209 51.1255 39.1254 52.0209 38.0209 52.0209H30.0209C28.9163 52.0209 28.0209 51.1255 28.0209 50.0209C28.0209 48.9163 28.9163 48.0209 30.0209 48.0209H35.5209C35.797 48.0209 36.0209 47.797 36.0209 47.5209V46.0209C36.0209 44.9164 36.9162 44.021 38.0208 44.0209H38.0209Z"})}))));const ns="page";var rs=function(e,t){let o=e;t&&(o=`${o}?${function(e){const t=new URLSearchParams;return t.set(ns,e),t.toString()}(t)}`),navigator.clipboard.writeText(o)},is=o(35247);const as=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CopyLinkRowWrapper",componentId:"pnc4wa-0"})(["width:100%;height:28px;margin-top:6px;display:flex;flex-direction:row;"]),ls=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CurrentPageCheckboxWrapper",componentId:"pnc4wa-1"})(["width:100%;height:16px;margin-left:3.125px;margin-top:6px;display:flex;flex-direction:row;"]),ss=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CopyLinkText",componentId:"pnc4wa-2"})(["font-size:",";color:",";padding-left:10px;cursor:pointer;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),cs=(0,b.ZP)(He.Z).withConfig({displayName:"SharingSheetCopyLink__SharingButton",componentId:"pnc4wa-3"})(["margin-left:8px;width:90px;min-width:90px;"]),ds=(0,b.ZP)(cs).withConfig({displayName:"SharingSheetCopyLink__QrCodeButton",componentId:"pnc4wa-4"})(["margin-left:auto;width:36px;min-width:36px;padding:0;"]);var ps=e=>{let{sharingSheetOpen:t,activePageId:o,toggleQrCode:n,showQrCode:r,canonicalUrl:i}=e;const{0:l,1:s}=(0,a.useState)(!1),{0:c,1:d}=(0,a.useState)(!1),{t:p}=(0,y.$G)();(0,a.useEffect)((()=>{s(!1)}),[t]);return(0,S.jsxs)(as,{children:[(0,S.jsxs)(ls,{children:[(0,S.jsx)(is.Z,{height:13.75,width:13.75,checked:c,onClick:()=>d((e=>!e))}),(0,S.jsx)(ss,{onClick:()=>d((e=>!e)),children:p("tome.sharingSheetCopyLink.linkToCurrentPageCheckboxText")})]}),(0,S.jsx)(ds,{onClick:n,selected:r,"aria-label":p("tome.sharingSheetCopyLink.ToggleQRCodeButtonLabel"),children:(0,S.jsx)(os,{style:{width:20,height:20}})}),(0,S.jsx)(cs,{onClick:()=>(rs(i,c&&o?o:void 0),void s(!0)),children:p(l?"tome.sharingSheetCopyLink.copiedLinkButtonLabel":"tome.sharingSheetCopyLink.copyLinkButtonLabel")})]})};const us=b.ZP.div.withConfig({displayName:"SharingSheet__QRCodeWrapper",componentId:"sc-18a3uq1-0"})(["width:100%;margin-top:6px;padding:8px 12px 0 12px;"]),ms=b.ZP.div.withConfig({displayName:"SharingSheet__QRCodeStyles",componentId:"sc-18a3uq1-1"})(["background-color:",";width:100%;height:100%;padding:16px;margin:auto;"],(e=>{let{theme:t}=e;return t.colors.sheetBg}));var gs=e=>{let{sharingSheetOpen:t,setSharingSheetOpen:o,tome:n,shareButtonRef:r,activePageId:i}=e;const l=(0,b.Fg)(),s=(0,a.useRef)(null),{0:c,1:d}=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{d((e=>!e))}),[]),u=(0,a.useCallback)((()=>{o(!1)}),[o]);(0,dl.Z)({handleClose:u,enabled:t});const{user:m,flags:g,loading:h,activeMembership:f}=(0,a.useContext)(dr.Z);if(h||!m)return null;const{canManage:y}=n.currentUserPermission,{publicSharing:C}=g||{};let v=!1;var x;null!==f&&void 0!==f&&f.org&&n.author.org&&(v=n.author.org.id===f.org.id||(null===(x=n.org)||void 0===x?void 0:x.id)===f.org.id);return(0,S.jsx)(Al,{children:t&&(0,S.jsxs)(sr.Z,{exemptContainerRefs:[r,s],onClick:()=>o(!1),children:[y&&(0,S.jsx)(Wl,{tome:n}),(0,S.jsx)(Jl,{owner:n.author}),f&&(0,S.jsx)(Yl,{tome:n,sameOrg:v}),(0,S.jsx)(Hl,{tome:n}),(0,S.jsx)(Nl,{}),(0,S.jsx)(Ql,{tome:n,publicSharing:C}),(0,S.jsx)(ps,{sharingSheetOpen:t,activePageId:i,showQrCode:c,toggleQrCode:p,canonicalUrl:n.canonicalUrl}),c&&(0,S.jsx)(us,{"data-testid":"qr_code",children:(0,S.jsx)(ms,{children:(0,S.jsx)(cl.Z,{value:window.location.href,size:278,bgColor:l.colors.sheetBg,fgColor:l.colors.contrast})})})]})})},hs=o(55245);var fs=()=>{const[e,t]=(0,l.FV)(H.Fc);return(0,a.useEffect)((()=>{const e=()=>{void 0!==window.document.webkitIsFullScreen?t(window.document.webkitIsFullScreen):t(!!window.document.fullscreenElement)};window.document.onfullscreenchange=e,window.document.onwebkitfullscreenchange=e}),[t]),e};var bs=e=>{let{timeout:t,disabled:o}=e;const n=(0,a.useRef)(),{0:r,1:i}=(0,a.useState)(!1),l=(0,a.useCallback)((()=>{i(!1)}),[i]),s=(0,a.useCallback)((()=>{i(!0)}),[i]);return(0,a.useEffect)((()=>{const e=()=>{n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{o||i(!0)}),t),i(!1)};return o?(n.current&&clearTimeout(n.current),window.removeEventListener("mousemove",e)):(e(),window.addEventListener("mousemove",e)),()=>window.removeEventListener("mousemove",e)}),[n,t,o]),(0,a.useEffect)((()=>{o&&(n.current&&clearTimeout(n.current),i(!1))}),[o]),(0,a.useEffect)((()=>{r?document.documentElement.classList.add("hideCursor"):document.documentElement.classList.remove("hideCursor")}),[r]),{showCursor:l,hideCursor:s}};function ys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Cs(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ys(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ys(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const vs=(e,t)=>(0,S.jsx)(we.Z,Cs(Cs({ref:t,width:"6",height:"6",viewBox:"0 0 6 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,S.jsx)("circle",{cx:"3",cy:"3",r:"2.5",fill:"#ED00EB"})}));var xs=(0,a.forwardRef)(vs),Os=o(95911);const Ps=m()((()=>Promise.all([o.e(2432),o.e(5453),o.e(8080),o.e(7443),o.e(5218),o.e(3489)]).then(o.bind(o,13489))),{loading:e=>{let{error:t}=e;return(0,S.jsx)(Os.ex,{error:t})},loadableGenerated:{webpack:()=>[13489]}}),js=m()((()=>Promise.all([o.e(2432),o.e(5453),o.e(8080),o.e(7443),o.e(5218),o.e(8546)]).then(o.bind(o,58546))),{loading:e=>{let{error:t}=e;return(0,S.jsx)(Os.ex,{error:t})},loadableGenerated:{webpack:()=>[58546]}}),ws=b.ZP.div.withConfig({displayName:"CommentsSheet__CommentsSheetWrapper",componentId:"sc-1k8z3r9-0"})(["cursor:default;position:absolute;top:","px;right:12px;pointer-events:auto;> div{box-shadow:",";background:",";width:","px;border-radius:18px;padding:12px 0 12px 0;}z-index:",";"],(e=>e.theme.headerHeight),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow}),(e=>e.theme.colors.sheetBg),340,T.Ue),Ts=(0,b.ZP)(Fe).withConfig({displayName:"CommentsSheet__StyledSegmentedControls",componentId:"sc-1k8z3r9-1"})(["display:flex;& button{flex:1;text-transform:capitalize;}"]),Is=b.ZP.div.withConfig({displayName:"CommentsSheet__SheetStyles",componentId:"sc-1k8z3r9-2"})([""]),Es=b.ZP.div.withConfig({displayName:"CommentsSheet__ToggleContainerStyles",componentId:"sc-1k8z3r9-3"})(["padding:0 16px 0 16px;z-index:",";"],T.tF),_s=b.ZP.div.withConfig({displayName:"CommentsSheet__ContentStyles",componentId:"sc-1k8z3r9-4"})(["margin-top:0px;"]);var Ss=e=>{let{commentsSheetOpen:t,tome:o}=e;const n=(0,l.sJ)(H.Vx),{0:r,1:i}=(0,a.useState)("This page"),{user:s}=(0,a.useContext)(dr.Z),c=(0,a.useCallback)((()=>{(0,H.k$)(!1)}),[]);(0,dl.Z)({handleClose:c,enabled:t}),(0,a.useEffect)((()=>{i("This page")}),[t]);const{commentsSheetRef:d}=(0,N.TR)(),p=(0,ua.Ti)(o),u=(0,V.yW)(o.pages,n);return(0,S.jsx)(ws,{ref:d,children:s&&t&&(0,S.jsxs)(Is,{"data-testid":"comments_sheet",children:[(0,S.jsx)(Es,{children:(0,S.jsx)(Ts,{role:"listbox",children:["All","This page"].map((e=>(0,S.jsx)(He.Z,{"aria-selected":r===e,onClick:()=>i(e),value:e,isSegment:!0,selected:r===e,iconOpacity:1,endIcon:"All"===e&&p?(0,S.jsx)(xs,{style:{width:5,height:5,opacity:1}}):null,children:e},e)))})}),(0,S.jsx)(_s,{children:(0,S.jsx)(S.Fragment,{children:"This page"===r?(0,S.jsx)(Ps,{tome:o,page:u}):(0,S.jsx)(js,{tome:o,setPageView:i})})})]})})};function ks(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Zs(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ks(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ks(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Ds=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Zs(Zs({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M41.3065 8.52829C40.478 7.79872 39.2149 7.87896 38.4853 8.7075L27.7047 20.7804C27.3471 21.1497 27.2971 21.6497 27.7047 22.0497L41.3766 35.7763C41.7471 36.1496 42.4471 36.1596 42.8123 35.7763L47.4818 30.3496C47.8026 29.9849 47.9797 29.5159 47.98 29.0301C47.9807 27.9256 47.0859 27.0295 45.9813 27.0288H35.857L41.8609 10.7202C42.1468 9.94519 41.9264 9.07418 41.3065 8.52829ZM22.6906 55.5213C23.5191 56.2508 24.7822 56.1706 25.5118 55.3421L36.2924 43.2691C36.65 42.8999 36.7 42.3999 36.2924 41.9999L22.6205 28.2733C22.25 27.8999 21.55 27.8899 21.1847 28.2733L16.5153 33.7C16.1945 34.0647 16.0174 34.5337 16.0171 35.0194C16.0164 36.124 16.9112 37.02 18.0158 37.0208H28.1401L22.1362 53.3294C21.8503 54.1044 22.0706 54.9754 22.6906 55.5213ZM13.4204 10.5506L53.4318 50.5857C54.2136 51.3669 54.2141 52.6339 53.433 53.4157C52.6518 54.1975 51.3847 54.1981 50.6029 53.4169L10.591 13.3818C9.8092 12.6004 9.8088 11.3333 10.5901 10.5515C11.3714 9.76965 12.6386 9.76925 13.4204 10.5506Z",fill:"#D05B41"})})))),Ms=o(82326),Rs=o(37887);var As=o(50456).ZP`
  query tomePresence($id: String!) {
    tome(id: $id) {
      ...TomeViewsFragment
    }
  }
  ${z.CIe}
`,Ls=o(21025);var Ns=e=>{var t,o,n,r;let{tomeId:i}=e;const{width:l}=(0,F.Z)(),{t:s}=(0,y.$G)(),c=(0,a.useMemo)((()=>(0,Ls.tQ)(l??0)),[l]),{data:d}=(0,z.sn6)({variables:{tomeId:i},fetchPolicy:"network-only",nextFetchPolicy:"cache-first"}),p=(0,Rs.a)(As,{variables:{id:i},nextFetchPolicy:"cache-only"});if(p.error)throw p.error;if(p.loading||void 0===p.data)return{seenHeadViewModels:[],overflowViewModels:[],anonymousViewers:0,userOrgName:""};const u=(null===(t=p.data)||void 0===t||null===(o=t.tome)||void 0===o?void 0:o.views)||[],m=p.data.tome.anonymousViews,g=(0,Ls.K3)(u).map(Ls.Pr);return m&&m>0&&g.push({label:`${m.toLocaleString()}${s("controllers.tomePresenceViewModel.viewers_with_count",{count:m})}`,isActive:!1,activityId:"anonymousCountRow"}),{seenHeadViewModels:(0,Ls.UO)(u).map(Ls.Pr).splice(0,c),overflowViewModels:g,anonymousViewers:m??0,userOrgName:(null===d||void 0===d||null===(n=d.tome)||void 0===n||null===(r=n.org)||void 0===r?void 0:r.name)??""}},Hs=o(30934);var Vs=e=>{let{tomeId:t,navigateToPage:o}=e;const{seenHeadViewModels:n,overflowViewModels:r,anonymousViewers:i,userOrgName:a}=Ns({tomeId:t});return(0,S.jsx)(Hs.Z,{seenHeadsViewModels:n,overflowViewModels:r,avatarSize:20,animated:!0,navigateToPage:o,anonymousViewers:i,userOrgName:a})};var Bs=function(e){return e.canView&&!e.canEdit&&!e.canComment&&!e.canManage};var Fs=()=>{const{titleEditableLabelRef:e}=(0,N.TR)(),t=(0,a.useCallback)((()=>{e.current&&e.current.focus()}),[e]);return{titleEditableLabelRef:e,focusOnTitle:t}},$s=o(49335),Gs=o(57509);const zs=b.ZP.div.withConfig({displayName:"HeaderPermissionsIndicator__StyledIndicator",componentId:"sc-4gqf27-0"})(["font-size:13px;line-height:16px;color:",";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;@media ","{display:none;}"],(e=>e.theme.colors.contrast40),Gs.Hb.tablet);var Us=e=>{let{permissions:t}=e;const{t:o}=(0,y.$G)(),n=(0,c.l)(H.Ad),r=(0,a.useCallback)((()=>n.length>0?o("tome.header.headerPermissionsIndicator.readOnlyPermissionIndicatorLabel"):t.isAuthor||t.canEdit?null:t.canComment?o("tome.header.headerPermissionsIndicator.commentOnlyPermissionIndicatorLabel"):t.canView?o("tome.header.headerPermissionsIndicator.viewOnlyPermissionIndicatorLabel"):null),[t,n,o])();return r?(0,S.jsx)(zs,{children:r}):null};const Ws=["style"];function qs(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ks(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?qs(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):qs(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ys=(e,t)=>{const{style:o}=e,n=(0,i.Z)(e,Ws);return(0,S.jsx)(we.Z,Ks(Ks({ref:t,style:Ks({},o),viewBox:"0 0 64 64"},n),{},{children:(0,S.jsx)("path",{d:"M20 46.6906V17.3094C20 14.643 22.8944 12.9835 25.1956 14.3305L50.292 29.021C52.5693 30.3541 52.5693 33.6459 50.292 34.979L25.1956 49.6695C22.8944 51.0165 20 49.357 20 46.6906Z"})}))};var Js=(0,a.forwardRef)(Ys),Xs=o(40312);const Qs=["visible","children","as"];function ec(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function tc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ec(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ec(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const oc=e=>{let{visible:t,children:o,as:n}=e,r=(0,i.Z)(e,Qs);const a=n||d.E.div;return(0,S.jsx)(p.M,{children:t&&(0,S.jsx)(a,tc(tc({},r),{},{transition:I.Oo,initial:{opacity:0},animate:{opacity:t?1:0},exit:{opacity:0},children:o}))})},nc=e=>{let{enterPresentMode:t}=e;const{t:o}=(0,y.$G)();return(0,S.jsx)(st.Z,{content:o("tome.header.control.togglePresentMode.enterPresentMode"),shortcuts:[(0,Xs.C6)(),"P"],placement:"bottom",perpendicularOffset:-20,children:(0,S.jsx)(Wa,{onClick:t,"aria-label":o("tome.header.control.togglePresentMode.playAriaLabel"),onZ0:!0,icon:(0,S.jsx)(Js,{style:{width:28,height:28}})})})},rc=e=>{let{permission:t,exitPresentMode:o}=e;const{workspaceUrl:n}=(0,N.bp)(),r=(0,l.sJ)(H.SM),{t:i}=(0,y.$G)();if(t.canEdit||t.canComment)return(0,S.jsx)(st.Z,{content:i("tome.header.control.togglePresentMode.exitPresentMode"),shortcuts:["esc"],placement:"bottom",perpendicularOffset:-10,children:(0,S.jsx)(Wa,{onClick:o,"aria-label":i("tome.header.control.togglePresentMode.exitPlayAriaLabel"),icon:(0,S.jsx)(Jt.Z,{style:{width:28,height:28}})})});const a=(0,S.jsx)(Wa,{"aria-label":i("tome.header.control.togglePresentMode.exitPlayAriaLabel"),icon:(0,S.jsx)(Jt.Z,{style:{width:28,height:28}})});return(0,S.jsx)(st.Z,{content:i("tome.header.control.togglePresentMode.exitPresentMode"),shortcuts:["esc"],placement:"bottom",perpendicularOffset:-10,children:(0,S.jsx)("div",{children:r?(0,S.jsx)("a",{href:n,target:"_blank",children:a}):(0,S.jsx)(Ta(),{href:n,children:a})})})};var ic=e=>{let{permission:t,presentMode:o,exitPresentMode:n,enterPresentMode:r}=e;return(0,S.jsxs)(za,{style:{marginLeft:8,width:40},children:[(0,S.jsx)(oc,{visible:!o,as:qa,children:(0,S.jsx)(za,{children:(0,S.jsx)(nc,{enterPresentMode:r})})}),(0,S.jsx)(oc,{visible:o,as:qa,initial:!1,children:(0,S.jsx)(za,{children:(0,S.jsx)(rc,{permission:t,exitPresentMode:n})})})]})},ac=o(92010),lc=o(65653),sc=o(14773);const cc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__TitleRow",componentId:"sc-19y4g0p-0"})(["display:flex;transform-origin:0% 0% 0px;"]),dc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__Title",componentId:"sc-19y4g0p-1"})(["font-weight:500;font-size:15px;line-height:20px;white-space:nowrap;overflow:hidden;color:",";"],(e=>{let{$presentMode:t,theme:o}=e;return t?o.colors.attributionTitle:o.colors.attributionTitlePresentMode})),pc=b.ZP.div.withConfig({displayName:"Attribution__TitleOverflow",componentId:"sc-19y4g0p-2"})(["",""],Jr.wR),uc=(0,b.ZP)(He.Z).withConfig({displayName:"Attribution__UpgradeButton",componentId:"sc-19y4g0p-3"})(["height:22px;padding:0 6px;min-width:0;margin-left:8px;"]),mc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__AttributionContent",componentId:"sc-19y4g0p-4"})([""]),gc={notPresentMode:{x:40,transitionStart:{overflow:"visible"},width:"100%"},presentMode:{x:10,transitionEnd:{overflow:"hidden"}},mobile:{x:0,transitionEnd:{overflow:"hidden"},width:"100%"}};var hc=e=>{let{title:t,presentMode:o,renameTome:n=(()=>null),titleEditableLabelRef:r,isEditor:i=!1,isMobile:l,showUpgradeButton:s=!1}=e;const{t:c}=(0,y.$G)(),{openSettings:d}=(0,lc.r)(),{apolloClient:p}=(0,N.bp)(),u=(0,a.useRef)(null),m=[];l?m.push("mobile"):o?m.push("presentMode"):m.push("notPresentMode");const g=(0,a.useCallback)((()=>{_a.ZP.reportPaymentEvent({apolloClient:p,trackEventType:_a.nM.CLICK_TOME_UPGRADE_BUTTON}),d(sc.u.PLANS)}),[p,d]);return(0,S.jsx)(mc,{ref:u,transition:I.Oo,initial:!1,variants:gc,animate:m,children:(0,S.jsxs)(cc,{id:"HeaderTitle",transition:I.Oo,initial:!1,animate:{y:14,x:0},style:{position:o?"unset":"fixed"},children:[(0,S.jsx)(dc,{$presentMode:o,children:o?(0,S.jsx)(pc,{children:t}):(0,S.jsx)(ac.Z,{labelId:"tome-attribution",dataTestId:"tome_title",ref:r,plainContent:t,disabled:!i||o,onContentChange:n,maxCharacterLimit:128,selectAllOnFocus:!0,shouldSetGlobalState:!0,style:{zIndex:1}})}),s&&(0,S.jsx)(uc,{"aria-label":c("upgradeButton.ariaLabel"),"data-testid":"tome_upgrade",onClick:g,children:c("upgradeButton.label")})]})})},fc=o(19148),bc=o(39346);const yc=["tome","toggleCommentsPanel"],Cc=b.ZP.div.withConfig({displayName:"CommentsButtonWrapper__ContentStyles",componentId:"sc-1bkk4b6-0"})(["cursor:pointer;display:flex;"]);var vc=e=>{let{tome:t,toggleCommentsPanel:o}=e,n=(0,i.Z)(e,yc);const{t:r}=(0,y.$G)();return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(st.Z,{content:r("components.commentsButtonWrapper.commentsButtonTooltipLabel"),shortcuts:[(0,Xs.C6)(),"M"],placement:"bottom",children:(0,S.jsx)(Cc,{onClick:o,children:n.children()})})})},xc=o(46295);var Oc=(0,a.forwardRef)(((e,t)=>{let{visible:o,tome:n,toggleCommentsPanel:r,unreadBadge:i,commentsCount:a}=e;return(0,S.jsx)(oc,{visible:o,children:(0,S.jsx)(Ua,{ref:t,children:(0,S.jsx)(vc,{tome:n,toggleCommentsPanel:r,children:()=>(0,S.jsx)(Wa,{onZ0:!0,"aria-label":fc.ZP.t("tome.header.control.comments.commentsButtonLabel"),startIcon:(0,S.jsx)(bc.Z,{$visible:i,children:(0,S.jsx)(xc.Z,{style:{height:28,width:28}})}),iconStyles:{margin:2,marginLeft:-2,marginRight:a>0?4:0},style:{padding:"0 6px"},children:a>0&&a})})})})})),Pc=o(50319),jc=o(47314),wc=o(37308),Tc=o(77759),Ic=o(64972),Ec=o(56793);const _c=()=>{const e=window.document.documentElement;try{e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}catch(t){}};var Sc=o(78724),kc=o(98382),Zc=o.n(kc);let Dc,Mc;!function(e){e[e.ALWAYS=0]="ALWAYS",e[e.DIRTY=1]="DIRTY",e[e.EMPTY=2]="EMPTY"}(Dc||(Dc={})),function(e){e[e.NONE=0]="NONE",e[e.TITLE=1]="TITLE",e[e.KEYWORD=2]="KEYWORD"}(Mc||(Mc={}));class Rc{constructor(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Dc.ALWAYS,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0;this.id=e,this.title=t,this.placeholder=o,this.component=n,this.hasFallbackMode=r,this.contentDependency=i,this.keywords=a,this.featureFlag=l,this.userContextFilter=s}score(e){const t=e.toLowerCase(),o=Zc()(this.title.toLowerCase(),t);if(o>.1)return{score:o,type:Mc.TITLE};const n=Math.max(...this.keywords.map((e=>Zc()(e.toLowerCase(),t))),0);return{score:n,type:n>.1?Mc.KEYWORD:Mc.NONE}}}let Ac;function Lc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Nc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Lc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Lc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}!function(e){e.ADD_AIRTABLE_TILE="ADD_AIRTABLE_TILE",e.ADD_FIGMA_TILE="ADD_FIGMA_TILE",e.ADD_FRAMER_TILE="ADD_FRAMER_TILE",e.ADD_GIPHY_TILE="ADD_GIPHY_TILE",e.ADD_IMAGE_GENERATIVE_TILE="ADD_IMAGE_GENERATIVE_TILE",e.ADD_IMAGE_TILE="ADD_IMAGE_TILE",e.ADD_LOOKER_TILE="ADD_LOOKER_TILE",e.ADD_MIRO_TILE="ADD_MIRO_TILE",e.ADD_TABLE_TILE="ADD_TABLE_TILE",e.ADD_TEXT_TILE="ADD_TEXT_TILE",e.ADD_TWITTER_TILE="ADD_TWITTER_TILE",e.ADD_VIDEO_TILE="ADD_VIDEO_TILE",e.ADD_WEB_TILE="ADD_WEB_TILE",e.AUTOTOME="AUTOTOME",e.AUTOTOME_V2="AUTOTOME_V2",e.CHAT="CHAT",e.COPY_LINK="COPY_LINK",e.CREATE_IMAGE="CREATE_IMAGE",e.CREATE_PAGE="CREATE_PAGE",e.DOC_TO_TOME="DOC_TO_TOME",e.EXPORT_TO_PDF="EXPORT_TO_PDF",e.GETTING_STARTED_LINK="GETTING_STARTED_LINK",e.NEW_PAGE="NEW_PAGE",e.OPEN_CUSTOMIZE_PANEL="OPEN_CUSTOMIZE_PANEL",e.OPEN_RECORD_PANEL="OPEN_RECORD_PANEL",e.PROMPT_TIPS_LINK="PROMPT_TIPS_LINK",e.RENAME_TOME="RENAME_TOME",e.SHARE="SHARE",e.UPLOAD_IMAGE="UPLOAD_IMAGE",e.VOTE_IMAGE_LEFT="VOTE_IMAGE_LEFT",e.VOTE_IMAGE_RIGHT="VOTE_IMAGE_RIGHT",e.YOUTUBE_TO_TOME="YOUTUBE_TO_TOME"}(Ac||(Ac={}));var Hc=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Nc(Nc({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M30 20C30 18.8954 30.8954 18 32 18C33.1046 18 34 18.8954 34 20V30H44C45.1046 30 46 30.8954 46 32C46 33.1046 45.1046 34 44 34H34V44C34 45.1046 33.1046 46 32 46C30.8954 46 30 45.1046 30 44V34H20C18.8954 34 18 33.1046 18 32C18 30.8954 18.8954 30 20 30H30V20Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 18C10 13.5817 13.5817 10 18 10H46C50.4183 10 54 13.5817 54 18V46C54 50.4183 50.4183 54 46 54H18C13.5817 54 10 50.4183 10 46V18ZM14 18C14 15.7909 15.7909 14 18 14H46C48.2091 14 50 15.7909 50 18V46C50 48.2091 48.2091 50 46 50H18C15.7909 50 14 48.2091 14 46V18Z"})]}))));function Vc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Bc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Vc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Vc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Fc=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Bc(Bc({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.6917 41.7479C48.2942 42.0905 47.6999 42.0689 47.3284 41.6984L42.5471 36.9153C42.2705 36.638 42.1817 36.2246 42.32 35.8581V35.8581C44.4445 30.1735 41.5586 23.843 35.874 21.7184C33.3946 20.7918 30.6641 20.7912 28.1844 21.7169C27.8179 21.8551 27.4045 21.7661 27.1273 21.4895L23.9328 18.2937C23.6882 18.0499 23.6876 17.6541 23.9313 17.4095C24.0002 17.3404 24.0844 17.2884 24.177 17.2576H24.177C26.7041 16.4337 29.3463 16.0176 32.0044 16.0249C46.6744 16.0249 53.9603 27.6936 55.7744 31.098V31.098C56.0823 31.6741 56.0823 32.3658 55.7744 32.9419C53.9586 36.2768 51.5597 39.2593 48.6917 41.7479L48.6917 41.7479ZM13.4332 10.6159L53.4256 50.6281C54.2068 51.409 54.2072 52.6753 53.4263 53.4566C52.6455 54.2378 51.3791 54.2382 50.5979 53.4573L10.6055 13.4452C9.82419 12.6644 9.82383 11.398 10.6047 10.6167C11.3855 9.83543 12.6519 9.83507 13.4332 10.6159ZM16.6773 22.344L21.4812 27.15C21.757 27.4267 21.8461 27.8389 21.7092 28.2048C19.5983 33.8955 22.5002 40.22 28.1909 42.3309C30.6555 43.2451 33.3661 43.2457 35.831 42.3325C36.1969 42.1956 36.609 42.2849 36.8856 42.5608L40.0709 45.7476C40.3154 45.9914 40.316 46.3872 40.0723 46.6318C40.0034 46.7009 39.9192 46.7529 39.8266 46.7837C37.301 47.6065 34.6606 48.0221 32.0044 48.0148C17.3344 48.0148 10.0485 36.3462 8.23438 32.9419C7.92627 32.3659 7.92627 31.674 8.23438 31.098L8.23438 31.098C10.0491 27.7642 12.4467 24.7826 15.3134 22.2946C15.711 21.9518 16.3055 21.9734 16.6773 22.344V22.344Z"})}))));function $c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Gc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?$c(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):$c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var zc=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Gc(Gc({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M14 21C14 19.8954 14.8954 19 16 19H24C25.1046 19 26 18.1046 26 17C26 15.8954 25.1046 15 24 15H16C12.6863 15 10 17.6863 10 21V27C10 28.1046 10.8954 29 12 29C13.1046 29 14 28.1046 14 27V21Z"}),(0,S.jsx)("path",{d:"M50 21C50 19.8954 49.1046 19 48 19H40C38.8954 19 38 18.1046 38 17C38 15.8954 38.8954 15 40 15H48C51.3137 15 54 17.6863 54 21V27C54 28.1046 53.1046 29 52 29C50.8954 29 50 28.1046 50 27V21Z"}),(0,S.jsx)("path",{d:"M16 45C14.8954 45 14 44.1046 14 43V37C14 35.8954 13.1046 35 12 35C10.8954 35 10 35.8954 10 37V43C10 46.3137 12.6863 49 16 49H24C25.1046 49 26 48.1046 26 47C26 45.8954 25.1046 45 24 45H16Z"}),(0,S.jsx)("path",{d:"M50 43C50 44.1046 49.1046 45 48 45H40C38.8954 45 38 45.8954 38 47C38 48.1046 38.8954 49 40 49H48C51.3137 49 54 46.3137 54 43V37C54 35.8954 53.1046 35 52 35C50.8954 35 50 35.8954 50 37V43Z"})]}))));function Uc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Wc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Uc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var qc=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Wc(Wc({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M41.9899 31.9792C41.9899 37.5021 37.5146 41.9792 31.9941 41.9792C26.4736 41.9792 21.9984 37.5021 21.9984 31.9792C21.9984 26.4564 26.4736 21.9792 31.9941 21.9792C37.5146 21.9792 41.9899 26.4564 41.9899 31.9792ZM37.9916 31.9792C37.9916 35.293 35.3064 37.9792 31.9941 37.9792C28.6818 37.9792 25.9967 35.293 25.9967 31.9792C25.9967 28.6655 28.6818 25.9792 31.9941 25.9792C35.3064 25.9792 37.9916 28.6655 37.9916 31.9792Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M31.9999 14C16.1413 14 8.34537 26.6083 6.46618 30.1363C5.84479 31.3006 5.84461 32.6982 6.46564 33.8627C8.34386 37.3892 16.1398 50 31.9999 50C47.8586 50 55.6545 37.3917 57.5337 33.8637C58.1553 32.6994 58.1554 31.3017 57.5342 30.1373C55.656 26.6108 47.8601 14 31.9999 14ZM31.9999 46C18.5454 46 11.7686 35.3057 10.0041 32C11.7686 28.6943 18.5454 18 31.9999 18C45.4545 18 52.2312 28.6943 53.9958 32C52.2312 35.3057 45.4545 46 31.9999 46Z"})]}))));function Kc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Yc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Kc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Kc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Jc=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Yc(Yc({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 12C16 10.8954 15.1046 10 14 10C12.8954 10 12 10.8954 12 12V22C12 23.1046 12.8954 24 14 24H24C25.1046 24 26 23.1046 26 22C26 20.8954 25.1046 20 24 20H18.5836C20.7681 17.5575 23.5854 15.7502 26.7373 14.7865C30.3725 13.6751 34.2661 13.7431 37.8603 14.9807C41.4544 16.2182 44.5645 18.5618 46.7448 21.6756C48.9251 24.7894 50.0636 28.5135 49.9973 32.3142C49.9309 36.1148 48.6631 39.7969 46.3755 42.8327C44.0878 45.8685 40.8978 48.1021 37.2627 49.2135C33.6276 50.3249 29.7339 50.2569 26.1398 49.0193C23.1785 47.9997 20.5458 46.2292 18.491 43.8957C17.7611 43.0667 16.5218 42.838 15.617 43.4715C14.7122 44.1051 14.4856 45.3591 15.1987 46.2027C17.7503 49.2212 21.0771 51.5066 24.8375 52.8014C29.2303 54.314 33.9892 54.397 38.4322 53.0387C42.8751 51.6804 46.774 48.9504 49.57 45.2399C52.366 41.5295 53.9156 37.0292 53.9967 32.384C54.0778 27.7387 52.6862 23.1871 50.0214 19.3813C47.3566 15.5756 43.5554 12.7112 39.1625 11.1986C34.7697 9.68602 30.0108 9.60295 25.5678 10.9613C21.9042 12.0814 18.6104 14.1342 16 16.9003V12ZM16 19.9431V20H16.0755L16 19.9431Z"})})))),Xc=o(30466);function Qc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ed(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Qc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Qc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var td=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,ed(ed({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M39 10C38.4477 10 38 10.4477 38 11C38 11.5523 38.4477 12 39 12H44V52H39C38.4477 52 38 52.4477 38 53C38 53.5523 38.4477 54 39 54H51C51.5523 54 52 53.5523 52 53C52 52.4477 51.5523 52 51 52H46V12H51C51.5523 12 52 11.5523 52 11C52 10.4477 51.5523 10 51 10H39Z"}),(0,S.jsx)("path",{d:"M12 19C12 17.8954 12.8954 17 14 17H34C35.1046 17 36 17.8954 36 19C36 20.1046 35.1046 21 34 21H26V45C26 46.1046 25.1046 47 24 47C22.8954 47 22 46.1046 22 45V21H14C12.8954 21 12 20.1046 12 19Z"})]}))));function od(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function nd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?od(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):od(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var rd=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,nd(nd({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 19.2171V11C24 7.68629 26.6863 5 30 5H36.4006C38.0591 5 39.6435 5.68645 40.7778 6.89635L52.3772 19.269C52.5923 19.4985 52.7877 19.743 52.9624 20H53V20.056C53.6481 21.0331 54 22.1856 54 23.3727V39C54 42.3137 51.3137 45 48 45H40V53C40 56.3137 37.3137 59 34 59H16C12.6863 59 10 56.3137 10 53V25C10 21.6863 12.6863 19 16 19H22.4006C22.9462 19 23.4838 19.0743 24 19.2171ZM50 39C50 40.1046 49.1046 41 48 41H40V37.3727C40 36.1856 39.6481 35.0331 39 34.056V34H38.9624C38.7877 33.743 38.5923 33.4985 38.3772 33.269L28 22.2V11C28 9.89543 28.8954 9 30 9H35V18C35 21.3137 37.6863 24 41 24H50V39ZM47.5796 20H41C39.8954 20 39 19.1046 39 18V10.8485L47.5796 20ZM34 55C35.1046 55 36 54.1046 36 53V38H27C23.6863 38 21 35.3137 21 32V23H16C14.8954 23 14 23.8954 14 25V53C14 54.1046 14.8954 55 16 55H34ZM27 34H33.5796L25 24.8485V32C25 33.1046 25.8954 34 27 34Z"})}))));function id(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ad(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?id(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):id(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ld=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,ad(ad({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M48.0049 52H30.0156C26.7046 51.9961 24.0216 49.3119 24.0186 46V39.9717C24.0264 38.8675 24.9276 37.9787 26.0315 37.9865C27.1354 37.9943 28.024 38.8958 28.0162 40V46C28.0175 47.104 28.9119 47.9987 30.0156 48H48.005C49.1085 47.9985 50.0027 47.1039 50.0038 46V18C50.0029 16.896 49.1086 16.0012 48.005 16H30.0159C28.9121 16.001 28.0175 16.8958 28.0165 18V24.0283C28.0087 25.1325 27.1074 26.0213 26.0035 26.0135C24.8996 26.0057 24.0111 25.1042 24.0189 24V18C24.0219 14.6882 26.7047 12.004 30.0156 12H48.005C51.3158 12.0042 53.9983 14.6883 54.0014 18V46C53.9983 49.3117 51.3157 51.9959 48.0049 52Z"}),(0,S.jsx)("path",{d:"M32.5857 24.5858C33.3667 23.8047 34.633 23.8047 35.4141 24.5858L41.4141 30.5858C42.1951 31.3668 42.1951 32.6332 41.4141 33.4142L35.4141 39.4142C34.633 40.1953 33.3667 40.1953 32.5857 39.4142C31.8046 38.6332 31.8046 37.3668 32.5857 36.5858L35.1715 34H11.9999C10.8953 34 9.99988 33.1046 9.99988 32C9.99988 30.8954 10.8953 30 11.9999 30H35.1715L32.5857 27.4142C31.8046 26.6332 31.8046 25.3668 32.5857 24.5858Z"})]})))),sd=o(2685);function cd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function dd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):cd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var pd=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,dd(dd({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M34 12C34 10.8954 33.1046 10 32 10C30.8954 10 30 10.8954 30 12V35.1716L23.4142 28.5858C22.6332 27.8047 21.3668 27.8047 20.5858 28.5858C19.8047 29.3668 19.8047 30.6332 20.5858 31.4142L30.5858 41.4142C31.3668 42.1953 32.6332 42.1953 33.4142 41.4142L43.4142 31.4142C44.1953 30.6332 44.1953 29.3668 43.4142 28.5858C42.6332 27.8047 41.3668 27.8047 40.5858 28.5858L34 35.1716V12Z"}),(0,S.jsx)("path",{d:"M14 50C12.8954 50 12 50.8954 12 52C12 53.1046 12.8954 54 14 54H50C51.1046 54 52 53.1046 52 52C52 50.8954 51.1046 50 50 50H14Z"})]}))));let ud;!function(e){e[e.DELETE_TOME=0]="DELETE_TOME",e[e.RESTORE_TOME=1]="RESTORE_TOME",e[e.SIGN_IN=2]="SIGN_IN",e[e.TOGGLE_ANNOTATIONS_OVERLAYS=3]="TOGGLE_ANNOTATIONS_OVERLAYS",e[e.ENTER_FULLSCREEN=4]="ENTER_FULLSCREEN",e[e.ADD_LOGO=5]="ADD_LOGO",e[e.SHOW_LOGO=6]="SHOW_LOGO",e[e.HIDE_LOGO=7]="HIDE_LOGO",e[e.RENAME_TOME=8]="RENAME_TOME",e[e.DUPLICATE_TOME=9]="DUPLICATE_TOME",e[e.CREATE_PDF=10]="CREATE_PDF",e[e.OPEN_SETTINGS_PLANS=11]="OPEN_SETTINGS_PLANS"}(ud||(ud={}));const md=fc.ZP.t("tome.header.tomeMenuBuilding.addLogoMenuItemLabel"),gd=fc.ZP.t("tome.header.tomeMenuBuilding.exportToPDFMenuItemLabel");var hd=e=>{var t,o;let{deleted:n,userIsEditor:r,isLoggedIn:i,presentMode:c,redirectToLogin:d,userCanManage:p,usersOrgId:u,tomeThemeId:m,orgLogoAvailable:h,shouldShowLogo:f,closeOtherPanels:b}=e;const C=(0,g.useRouter)(),{tomeId:v}=(0,a.useContext)(Pi.z),{workspaceUrl:x,setWorkspaceUrl:O}=(0,N.bp)(),P=(0,a.useRef)(null),[j,T]=(0,l.FV)(kn.tF),{openSettings:I}=(0,lc.r)(),[E]=(0,Pc.D)(Tc.Z,{update(e,t){let{data:{deleteTome:o}}=t;(0,ql.h6)(e,o)},optimisticResponse:{__typename:"Mutation",deleteTome:{__typename:"Tome",id:v}}}),{t:_}=(0,y.$G)(),{clientId:k,apolloClient:Z}=(0,N.bp)(),D=r&&!c,M=(0,l.sJ)(w.wo),R=(0,B.ye)(B.TT.PDF_GENERATION),{priceType:A,remainingTomeCreationsForOrg:L}=(0,$s.Z)(),V=null!==A,F=R&&r,$=V&&F,G=!V&&F,U=0!==L,{controlCommandPrompt:W}=(0,Sc.br)(),{data:q}=(0,z.CHH)({variables:{tomeId:v},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",skip:!D}),K=(null===q||void 0===q||null===(t=q.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.themes)??[],Y=(0,a.useCallback)((()=>{C.push(x,void 0,{shallow:!0}),E({variables:{tomeId:v}}),(0,H.Sd)({message:_("tome.header.tomeMenu.tomeDeletedToastMessage")})}),[C,E,v,x,_]),[J]=(0,Pc.D)(Ic.Z,{update(e,t){let{data:{restoreTome:o}}=t;o&&(0,wc.W)(e,o)}}),X=(0,a.useCallback)((()=>{J({variables:{tomeId:v}}).then((e=>{let{data:t}=e;if(null!==t&&void 0!==t&&t.restoreTome){const e=new URL(x,"http://tome/");e.searchParams.set("tab","recent"),O(`${e.pathname}${e.search}`),(0,H.ak)({message:_("tome.header.tomeMenu.tomeRestoredToastMessage")})}else(0,H.ak)({message:_("tome.header.tomeMenu.noPermissionToRestoreTomeToastMessage")})})).catch((e=>{(0,H.ak)({message:_("tome.header.tomeMenu.errorOccurredRestoringTomeToastMessage")}),console.error("Error restoring Tome:",e),e.message=`Error restoring Tome: ${e.message}`,s.v.addError(e,{tomeId:v})}))}),[J,O,v,x,_]),Q=(0,Ec.Z)(),ee=(0,a.useCallback)((()=>{u&&Q({tomeId:v,orgId:u,onDuplicateComplete:(e,t)=>{window.Cypress||window.open(t,"_blank")},onDuplicateError:()=>{(0,H.ak)({message:_("tome.header.tomeMenu.permissionDeniedToastMessage")})}})}),[u,Q,v,_]),te=(0,a.useCallback)((()=>{d(!1)}),[d]),{focusOnTitle:oe}=Fs(),ne=(0,a.useCallback)((()=>{c&&T((e=>!e))}),[c,T]),re=(0,a.useCallback)((()=>{b()}),[b]),ie=(0,a.useCallback)((()=>{C.push(x,void 0,{shallow:!0}),I(sc.u.ORGANIZATION)}),[I,C,x]),ae=(0,a.useCallback)((()=>{const e={showLogo:!0};(0,ql.W8)(v,e,Z,k),(0,H.ak)({message:_("tome.header.tomeMenu.logoAppearanceInPlayModeToastMessage")})}),[Z,k,v,_]),le=(0,a.useCallback)((()=>{const e={showLogo:!1};(0,ql.W8)(v,e,Z,k),(0,H.ak)({message:_("tome.header.tomeMenu.logoWillBeHiddenInPlayModeToastMessage")})}),[Z,k,v,_]),se=[],ce=(e=>{let{userIsEditor:t,presentMode:o,shouldShowLogo:n,orgLogoAvailable:r,desiredRecordingState:i,displayAnnotationsOverlays:a,isLoggedIn:l,userCanManage:s,userCanCreatePdf:c,userCanAddLogo:d,userCanUpgradeToCreatePdf:p,userCanUpgradeToAddLogo:u,userCanDuplicateTome:m,deleted:g,commandFn:h}=e;const f=[],b={width:16,height:16,marginRight:8};if(m&&f.push({text:fc.ZP.t("tome.header.tomeMenuBuilding.duplicateTomeMenuItemLabel"),action:()=>{h(ud.DUPLICATE_TOME)},image:(0,S.jsx)(rd,{style:b})}),t&&!o&&f.push({text:fc.ZP.t("tome.header.tomeMenuBuilding.renameTomeMenuItemLabel"),action:()=>{h(ud.RENAME_TOME)},image:(0,S.jsx)(td,{style:b})}),c?f.push({id:"export-to-pdf",text:gd,action:()=>{h(ud.CREATE_PDF)},image:(0,S.jsx)(pd,{style:b})}):p&&f.push({text:gd,action:()=>{h(ud.OPEN_SETTINGS_PLANS)},image:(0,S.jsx)(pd,{style:b}),tag:sd.O.PRO}),t&&!o&&(r?n?f.push({text:fc.ZP.t("tome.header.tomeMenuBuilding.hideLogoMenuItemLabel"),action:()=>{h(ud.HIDE_LOGO)},image:(0,S.jsx)(Fc,{style:b})}):f.push({text:fc.ZP.t("tome.header.tomeMenuBuilding.showLogoMenuItemLabel"),action:()=>{h(ud.SHOW_LOGO)},image:(0,S.jsx)(qc,{style:b})}):d?f.push({text:md,action:()=>{h(ud.ADD_LOGO)},image:(0,S.jsx)(Hc,{style:b})}):u&&f.push({text:md,action:()=>{h(ud.OPEN_SETTINGS_PLANS)},image:(0,S.jsx)(Hc,{style:b}),tag:sd.O.PRO})),o&&!i&&f.push({image:(0,S.jsx)(zc,{style:b}),text:fc.ZP.t("tome.header.tomeMenuBuilding.viewFullscreenMenuItemLabel"),action:()=>{h(ud.ENTER_FULLSCREEN)}}),o){let e=(0,S.jsx)(Fc,{style:b}),t=`${fc.ZP.t("tome.header.tomeMenuBuilding.hideOverlaysMenuItemLabel")}`;a||(e=(0,S.jsx)(qc,{style:b}),t=`${fc.ZP.t("tome.header.tomeMenuBuilding.showOverlaysMenuItemLabel")}`),f.push({image:e,text:t,action:()=>{h(ud.TOGGLE_ANNOTATIONS_OVERLAYS)}})}return!l&&o&&(f.push({type:"separator"}),f.push({image:(0,S.jsx)(ld,{style:b}),text:fc.ZP.t("tome.header.tomeMenuBuilding.signInMenuItemLabel"),action:()=>{h(ud.SIGN_IN)}})),s&&!o&&(f.push({type:"separator"}),g?f.push({type:"option",text:fc.ZP.t("tome.header.tomeMenuBuilding.restoreMenuItemLabel"),action:()=>{h(ud.RESTORE_TOME)},image:(0,S.jsx)(Jc,{style:b})}):f.push({text:fc.ZP.t("tome.header.tomeMenuBuilding.deleteMenuItemLabel"),action:()=>{h(ud.DELETE_TOME)},variant:"destructive",image:(0,S.jsx)(Xc.Z,{style:b})})),f})({deleted:n,userCanManage:p,userCanCreatePdf:$,userCanAddLogo:V,userCanUpgradeToCreatePdf:G,userCanUpgradeToAddLogo:!V,userCanDuplicateTome:U,presentMode:c,isLoggedIn:i,displayAnnotationsOverlays:j,desiredRecordingState:M,shouldShowLogo:f,orgLogoAvailable:h,userIsEditor:r,commandFn:e=>{(e=>{switch(e){case ud.DELETE_TOME:Y();break;case ud.RESTORE_TOME:X();break;case ud.SIGN_IN:te();break;case ud.TOGGLE_ANNOTATIONS_OVERLAYS:ne();break;case ud.ENTER_FULLSCREEN:_c();break;case ud.ADD_LOGO:ie();break;case ud.SHOW_LOGO:ae();break;case ud.HIDE_LOGO:le();break;case ud.RENAME_TOME:oe();break;case ud.DUPLICATE_TOME:i?ee():te();break;case ud.CREATE_PDF:W({action:Sc.$C.INVOKE_COMMAND,commandId:Ac.EXPORT_TO_PDF});break;case ud.OPEN_SETTINGS_PLANS:I(sc.u.PLANS)}})(e)}});return se.push(...ce),se.length<1?null:(0,S.jsx)(qr.Z,{menuWidth:220,menuPosition:"below",menuAlign:"right",itemsOrFn:se,styles:{display:"flex"},onOpenDropdown:re,exemptContainerClickRefs:[P],rebuildMenuTrigger:K.map((e=>e.id)).join("-").concat(`-active-${m}`),children:(0,S.jsx)(za,{style:{marginLeft:8,width:40},children:(0,S.jsx)(Wa,{"aria-label":_("tome.header.tomeMenu.ariaLabelSettingsButtonText"),variant:"text",style:{padding:"0 6px"},onZ0:!c,icon:(0,S.jsx)(jc.Z,{style:{width:28,height:28}})})})})};const fd=b.ZP.span.withConfig({displayName:"TryTomeButton__ButtonInner",componentId:"sc-1erbku7-0"})(["display:flex;align-items:center;"]);var bd=e=>{let{tomeId:t}=e;const{apolloClient:o}=(0,N.bp)(),n=(0,l.sJ)(H.SM),r=(0,l.sJ)(H.Vx),{t:i}=(0,y.$G)(),s=(0,a.useCallback)((()=>{_a.ZP.reportTryTomeClickEvent({apolloClient:o,tomeId:t,pageId:r})}),[o,t,r]),c=(0,S.jsx)(za,{style:{marginLeft:8},children:(0,S.jsxs)(Wa,{variant:"text",style:{width:"unset",padding:"0 6px"},onClick:s,children:[(0,S.jsx)(Ia.Z,{style:{height:18,width:18}}),(0,S.jsxs)(fd,{children:["\xa0",i("tome.header.tryTomeButton.tryTomeButtonLabel")]})]})}),d=(0,Sa.iR)(void 0,"/signup",{utmMedium:"referral",utmSource:n?"public_tome_embedded":"public_tome",utmCampaign:t,utmContent:"public_tome_logo"});return n?(0,S.jsx)("a",{href:d,target:"_blank",children:c}):(0,S.jsx)(Ta(),{href:d,children:c})};function yd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Cd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?yd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var vd=e=>{var t,o,n,r,i;let{tome:s,presentMode:d,expandMode:u,enterPresentMode:m,exitPresentMode:h}=e;const[f,b]=(0,l.FV)(H.Vx),C=(0,g.useRouter)(),{apolloClient:v,clientId:O,workspaceUrl:P,setWorkspaceUrl:j}=(0,N.bp)(),T=(0,E.t2)(),{t:_}=(0,y.$G)(),k=(0,Na.I)(null===s||void 0===s||null===(t=s.org)||void 0===t?void 0:t.logo),Z=(0,l.sJ)(H.SM),D=fs(),M=(0,l.sJ)(H.GP),R=(0,l.sJ)(w.wo),A=(0,a.useCallback)((e=>e.clientY<108),[]),{isHidden:L,show:B}=Ca({visibilityBasedOnMouseEvent:A,timeout:3e3,disabled:!d}),{showCursor:F}=bs({timeout:3e3,disabled:!D}),$=(0,nl.Z)(),[G,U]=(0,l.FV)(H.B8),W=(0,a.useRef)(null),q=(0,c.l)(H.k$),K=(0,a.useRef)(null),{loading:Y,user:J,flags:X,activeMembership:Q}=(0,a.useContext)(dr.Z),ee=!M&&(null===X||void 0===X?void 0:X.offlineReadOnly);(0,a.useEffect)((()=>{ee&&(0,H.ak)({message:_("tome.header.tomeHeader.offlineConnectivityMessage")})}),[ee,_]),(0,a.useEffect)((()=>{d&&q&&(0,H.k$)(!1)}),[d,q]);const te=!(!J||!J.id),{titleEditableLabelRef:oe}=Fs(),ne=(0,a.useCallback)((e=>e===s.title?null:e&&0!==e.length?((0,ql.W8)(s.id,{title:e},v,O),null):s.title),[v,O,s.id,s.title]),re=(0,V.yW)(s.pages,f),{0:ie,1:ae}=(0,a.useState)((0,ua.zh)(re)),le=re&&(null===(o=re.comments)||void 0===o?void 0:o.length)||0;(0,a.useEffect)((()=>{ae((0,ua.zh)((0,V.yW)(s.pages,f)))}),[f,s.pages]);const se=(0,a.useCallback)((e=>{(0,hs.rf)(C,{pageId:f,showComments:e,openInNewTab:Z})}),[f,C,Z]),ce=(0,a.useCallback)((e=>{e!==f&&"string"===typeof e&&b(e)}),[f,b]);(0,a.useEffect)((()=>{var e;const t=new URL(P,"http://tome/");null!==Q&&void 0!==Q&&Q.org&&(t.pathname=null===(e=Q.org)||void 0===e?void 0:e.slug),j(`${t.pathname}${t.search}`)}),[j,Q,P]);const de=s.currentUserPermission.isAuthor||s.currentUserPermission.canEdit,pe=(0,a.useCallback)((()=>te?((0,H.k$)(!q),T.closePropertyPanel(),q?null:ae(!1)):(se(!0),null)),[q,te,T,se]),ue=(0,a.useCallback)((()=>{te||se(!1),U(!G),T.closePropertyPanel(),q&&(0,H.k$)(!1)}),[q,te,T,se,G,U]),me=(0,a.useCallback)((()=>{(0,H.k$)(!1),U(!1),T.closePropertyPanel()}),[U,T]);(0,a.useEffect)((()=>{d||(B(),F())}),[d,B,F]);const ge=window.innerWidth,he=(0,ol.ZP)("(max-width: 1024px)")?32:48,fe=(ge-2*he)/3,be=L||D||R,ye=(0,a.useMemo)((()=>({animate:{opacity:be?0:1},transition:I.Z2,initial:{opacity:1},exit:{opacity:0}})),[be]),Ce=(0,l.sJ)(H.$s),ve=(0,x.s)(),xe=(0,l._8)((e=>{let{snapshot:t}=e;return()=>{t.getLoadable($e.z1).getValue().size>0||(0,Ms.r)()?ve.open():(T.closePropertyPanel(),(0,H.k$)(!1),C.push(P,void 0,{shallow:!0}))}}),[ve,T,C,P]),Oe=(0,S.jsx)(Ua,{ref:W,children:(0,S.jsx)(Wa,{variant:"text",onClick:ue,style:{width:"unset",padding:"0 6px"},onZ0:!d,children:_("tome.header.tomeHeader.headerShareButtonLabel")})}),Pe=(0,S.jsx)(Ua,{children:(0,S.jsx)(Wa,{variant:"text",onClick:()=>{rs(s.canonicalUrl),(0,H.ak)({message:_("tome.header.tomeHeader.linkCopiedToastMessage")})},style:{width:"unset",padding:"0 6px"},onZ0:!d,children:_("tome.header.tomeHeader.copyTomeLinkButtonLabel")})}),je=(()=>{var e,t,o;if(s.currentUserPermission.how!==z.TSR.Public&&!Bs(s.currentUserPermission))return Oe;if(!0===Y||"undefined"===typeof J||"undefined"===typeof Q)return $?Pe:null;return(null===Q||void 0===Q||null===(e=Q.org)||void 0===e?void 0:e.id)===(null===s||void 0===s||null===(t=s.author)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id)?Oe:$?Pe:null})(),we=(null===(n=s.org)||void 0===n?void 0:n.showTomeBranding)??!0,{priceType:Te}=(0,$s.Z)();return(0,S.jsx)($a,{$showScrim:!D&&Ce,$presentMode:d,children:(0,S.jsxs)(Ga,{"data-testid":"tome_header",$pointerEventsEnabled:!R,children:[(0,S.jsx)(p.M,{children:!u&&!D&&(0,S.jsxs)(Va,Cd(Cd({$gap:he},ye),{},{children:[!d&&te&&(0,S.jsxs)(za,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:I.Oo,style:{position:"absolute",left:10,zIndex:1},"data-testid":"tome_header_workspace_button",children:[(0,S.jsx)(Wa,{"aria-label":_("tome.header.tomeHeader.navigateToWorkspaceButtonLabel"),"data-testid":"navigate_to_workspace",onClick:xe,style:{padding:"2px 6px",width:"32px",minWidth:"32px"},onZ0:!0,icon:(0,S.jsx)(Ut.Z,{style:{width:28,height:28}})}),(0,S.jsx)(x.Z,{ref:ve.ref,title:_("tome.header.tomeHeader.leaveThisTomeConfirmationModalTitle"),subtitle:_("tome.header.tomeHeader.ChangesMayNotBeSavedMessageConfirmationModalSubtitle"),dismissible:!0,buttonColor:"default",cancelButtonText:_("tome.header.tomeHeader.leavingTomeCancelButtonLabel"),cancelButtonAction:()=>ve.close(),primaryButtonContent:_("tome.header.tomeHeader.leavingTomeOkButtonLabel"),primaryButtonAction:()=>{T.closePropertyPanel(),(0,H.k$)(!1),C.push(P)}})]},"header_component_for_buttons"),!d&&(0,S.jsx)(hc,{title:s.title,presentMode:d,isEditor:de,renameTome:ne,titleEditableLabelRef:oe,showUpgradeButton:de&&null===Te},"attribution"),k&&d&&(0,S.jsx)(za,{style:{marginLeft:6},children:(0,S.jsx)(Na.Z,{show:s.showLogo,logo:null===(r=s.org)||void 0===r?void 0:r.logo,theme:re.theme})}),!d&&(0,S.jsx)(za,{style:{marginLeft:8},children:(0,S.jsx)(Us,{permissions:s.currentUserPermission})}),ee&&(0,S.jsx)(za,{style:{marginLeft:8},children:(0,S.jsx)(sl,{icon:(0,S.jsx)(Ds,{}),color:"destructive",toolTipContent:_("tome.header.tomeHeader.tooltipReadOnlyMessage"),children:_("tome.header.tomeHeader.offlineConnectivityBadgeLabel")})})]}))}),(0,S.jsx)(p.M,{children:!D&&(0,S.jsx)(Ba,{$presentMode:d,$gap:he,children:d&&!u&&s.pages.length>1&&(0,S.jsx)(za,{style:{width:"100%"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:I.Oo,children:(0,S.jsx)(La,{pageIds:s.pages.map((e=>e.id)),maxComponentWidthPx:fe,activePageId:f,onSegmentClick:b,isMobile:!1,numPages:s.numPages})})})}),(0,S.jsx)(p.M,{children:!u&&!D&&(0,S.jsxs)(Fa,Cd(Cd({$presentMode:d},ye),{},{children:[(0,S.jsx)(oc,{visible:!d,as:Ua,children:(0,S.jsx)(Vs,{tomeId:s.id,navigateToPage:ce})}),(0,S.jsx)(Oc,{ref:K,visible:!d,tome:s,toggleCommentsPanel:pe,unreadBadge:ie,commentsCount:le}),je,(0,S.jsx)(hd,{deleted:s.deleted,userIsEditor:de,isLoggedIn:te,presentMode:d,redirectToLogin:se,userCanManage:s.currentUserPermission.canManage,usersOrgId:null===Q||void 0===Q||null===(i=Q.org)||void 0===i?void 0:i.id,tomeThemeId:s.theme.id,orgLogoAvailable:k,shouldShowLogo:s.showLogo,closeOtherPanels:me}),te&&(0,S.jsx)(ic,{presentMode:d,exitPresentMode:h,enterPresentMode:m,permission:s.currentUserPermission}),!te&&we&&(0,S.jsx)(bd,{tomeId:s.id})]}))}),(0,S.jsx)(gs,{sharingSheetOpen:G,setSharingSheetOpen:U,tome:s,shareButtonRef:W,activePageId:f}),(0,S.jsx)(Ss,{commentsSheetOpen:q,tome:s})]})})},xd=o(9008),Od=o.n(xd),Pd=o(95636);function jd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?jd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):jd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Td=e=>{let{tome:t}=e;const o=t.canonicalUrl,n=t.published&&t.description||`by ${t.author.name}`,r=wd(wd(wd(wd(wd({"@context":"https://schema.org","@type":"CreativeWork",name:t.title},t.author.name?{author:{name:t.author.name}}:{}),t.author.org?{publisher:{name:t.author.org.name}}:{}),t.published&&t.description?{abstract:t.description}:{}),t.previewImageUrl?{thumbnailUrl:t.previewImageUrl}:{}),{},{url:o});return(0,S.jsxs)(Od(),{children:[(0,S.jsx)("title",{children:t.title}),!t.published&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("meta",{name:"robots",content:"nofollow, noindex"})}),(0,S.jsx)("meta",{name:"description",content:n}),t.author.name&&(0,S.jsx)("meta",{name:"author",content:t.author.name}),(0,S.jsx)("meta",{property:"og:site_name",content:"Tome"}),(0,S.jsx)("meta",{property:"og:title",content:t.title}),(0,S.jsx)("meta",{property:"og:description",content:n}),(0,S.jsx)("meta",{property:"og:url",content:o}),(0,S.jsx)("link",{rel:"canonical",href:o}),(0,S.jsx)("link",{rel:"preconnect",href:Pd.z}),(0,S.jsx)("link",{rel:"preconnect",href:"https://rum.browser-intake-datadoghq.com/"}),(0,S.jsx)("link",{rel:"preconnect",href:"https://api.segment.io"}),(0,S.jsx)("link",{rel:"preconnect",href:"https://cdn.segment.com"}),(0,S.jsx)("link",{rel:"preconnect",href:Pd.n}),(0,S.jsx)("link",{rel:"preconnect",href:"https://vitals.vercel-insights.com/v1/vitals"}),(0,S.jsx)("link",{rel:"dns-prefetch",href:Pd.z}),(0,S.jsx)("link",{rel:"dns-prefetch",href:"https://rum.browser-intake-datadoghq.com/"}),(0,S.jsx)("link",{rel:"dns-prefetch",href:"https://api.segment.io"}),(0,S.jsx)("link",{rel:"dns-prefetch",href:"https://cdn.segment.com"}),(0,S.jsx)("link",{rel:"dns-prefetch",href:Pd.n}),(0,S.jsx)("link",{rel:"dns-prefetch",href:"https://vitals.vercel-insights.com/v1/vitals"}),(0,S.jsx)("link",{rel:"dns-prefetch",href:"https://media.giphy.com"}),t.previewImageUrl&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("meta",{property:"og:image",content:t.previewImageUrl}),(0,S.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,S.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(r)}})]})};var Id=e=>{var t,o;let{pages:n,presentMode:r,isMobile:i}=e;const{loading:l,user:s}=(0,a.useContext)(dr.Z),{t:c}=(0,y.$G)(),d=(0,a.useRef)(!1),p=(null===(t=n[0])||void 0===t||null===(o=t.overlay)||void 0===o?void 0:o.videoStatus)===z.Kwn.Ready;(0,a.useLayoutEffect)((()=>{l||r&&!s&&!d.current&&n.length>1&&!p&&(i?(0,H.ak)({message:c("tome.usePageBasedTriggers.tapToLeftAndRightToNavigateToastMessage"),duration:3e3,delay:1e3}):(0,H.ak)({message:c("tome.usePageBasedTriggers.useArrowKeysToNavigateToastMessage"),duration:3e3,delay:1e3}),d.current=!0)}),[r,i,l,s,n.length,p,c])};const Ed="ACTIVE_PAGE:";var _d=e=>{const t=(0,a.useRef)();(0,a.useEffect)((()=>{t.current=t=>{const o=null===e||void 0===e?void 0:e(t);return"string"===typeof o?(t.returnValue=o,o):t.defaultPrevented?(t.returnValue="",""):o}}),[e]),(0,a.useEffect)((()=>{const e=e=>t.current(e);return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[])};var Sd=function(e){let{id:t,tome:o}=e;const[n,r]=(0,l.FV)(H.Vx),i=(0,l.Zl)(H.pt),s=o.numPages>0?o.pages[0].id:null,c=(0,a.useRef)("");(0,a.useEffect)((()=>{var e;const t=null===(e=o.pages[0])||void 0===e?void 0:e.id;n&&t&&!o.pages.some((e=>e.id===n))&&r(t)}),[o.pages.length]),(0,a.useEffect)((()=>{if(c.current===t)return;const e=(o=window.location.search,new URLSearchParams(o).get(ns));var o;if(null!==e)r(e),c.current=t;else{const e=function(e){const t=Ed+e;let o=localStorage.getItem(t);if(o){localStorage.removeItem(t);try{o=JSON.parse(o)}catch{o={}}o=o.expiry>=(new Date).getTime()?o.pageId:""}else o="";return o}(t);e?(r(e),c.current=t):s&&(r(s),c.current=t)}new URLSearchParams(window.location.search).has("showComments")&&(0,H.k$)(!0),function(e){const t=window.location,o=new URLSearchParams(t.search);let n=!1;if(e.forEach((e=>{o.has(e)&&(o.delete(e),n=!0)})),n){const e=[`${t.origin}${t.pathname}`,o.toString()].filter(Boolean).join("?");h().replace(e,void 0,{shallow:!0})}}(["page","showComments"])}),[t,s,c,r]),(0,a.useEffect)((()=>()=>{r("")}),[r]);const d=(0,a.useCallback)((()=>{!function(e,t){const o=Ed+e,n={pageId:t,expiry:(new Date).getTime()+1e4};localStorage.setItem(o,JSON.stringify(n))}(t,n)}),[n,t]);(0,a.useEffect)((()=>{i([])}),[i]);const p=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{t.getLoadable($e.z1).getValue().size>0&&e.preventDefault(),(0,Ms.r)()&&e.preventDefault(),d()}}),[d]);return _d(p),(0,S.jsx)(S.Fragment,{})},kd=o(24656),Zd=o(36947),Dd=o(87987);var Md=()=>{const e=(0,c.l)(H.Dm),t=(0,l.rb)(H.uz);return(0,a.useEffect)((()=>{null===e&&t()}),[e,t]),null};function Rd(e,t){if(e<Math.ceil(t/2))return[0,t];const o=Math.floor(t/2);return[e-o+1,e+o+1]}var Ad=e=>{let{activePageIndex:t,windowSize:o,data:n,itemSize:r,renderItem:i}=e;const[a,l]=Rd(t,o),s=[];for(let c=a;c<Math.min(l,n.length);c++)s.push(i(n[c],c,c*r));return(0,S.jsx)(S.Fragment,{children:s})},Ld=o(86062),Nd=o(55204),Hd=o(98982),Vd=o(20286),Bd=o(31678),Fd=o(12329);var $d=e=>{const{colorScheme:t,annotationContent:o}=e;return(0,S.jsx)(Fd.pT,{"data-testid":"annotation_label_cluster_item",$colorScheme:t,children:(0,S.jsx)(Fd.__,{$colorScheme:t,scale:1,children:(0,S.jsx)("div",{style:{maxWidth:"254px"},children:o})})})};const Gd=b.ZP.div.withConfig({displayName:"AnnotationLabelCluster__LabelClusterStyles",componentId:"sc-13ofvmt-0"})(["display:flex;gap:12px;align-items:",";overflow-x:scroll;",""],(e=>e.$topAlign?"flex-start":"flex-end"),ra.Z),zd=b.ZP.div.withConfig({displayName:"AnnotationLabelCluster__ClusterLabelContainer",componentId:"sc-13ofvmt-1"})(["min-width:fit-content;"]);var Ud=e=>{const{annotations:t,topAlign:o}=e;return(0,S.jsx)(Gd,{$topAlign:o,children:t.map((e=>(0,S.jsx)(zd,{children:(0,S.jsx)($d,{colorScheme:e.style.colorScheme,annotationContent:e.content})},e.id)))})};const Wd=(0,a.forwardRef)(((e,t)=>{let{annotations:o,dotSize:n,solidDots:r,onClick:i}=e;const a=Math.floor(n+5)/2;return(0,S.jsx)(Fd.dQ,{ref:t,onClick:i,children:o.slice(0).reverse().map(((e,t)=>(0,S.jsxs)(Fd.bd,{"data-testid":"annotation_dot_cluster_item",$left:(n+5-10)*(o.length-1-t),$size:n+5,children:[(0,S.jsx)(Fd.ni,{r:a-1}),(0,S.jsx)(Fd.HR,{"data-testid":"annotation_dot_cluster_contents",$solid:r,$colorScheme:e.style.colorScheme,r:a-4,"data-tome-bypass-tap-navigation":"AnnotationDotCluster__ClusterDot"})]},e.id)))})}));var qd=Wd;var Kd;!function(e){e.CLOSED="closed",e.ABOVE="above",e.BELOW="below"}(Kd||(Kd={}));const Yd=b.ZP.div.withConfig({displayName:"AnnotationCluster__AnnotationClusterStyles",componentId:"o6k68e-0"})(["height:","px;"],18),Jd=b.ZP.div.withConfig({displayName:"AnnotationCluster__LabelPositioner",componentId:"o6k68e-1"})(["position:absolute;z-index:",";padding:",";width:100%;",""],T.Ue,"18px 0 12px",(e=>e.$location===Kd.ABOVE?"bottom: 0px;":e.$location===Kd.BELOW?"top: 18px;":""));var Xd=e=>{const{annotations:t,onActivePage:o}=e,{0:n,1:r}=(0,a.useState)(Kd.CLOSED),i=(0,a.useRef)(null);(0,a.useEffect)((()=>{o||r(Kd.CLOSED)}),[o]);const l=(0,a.useCallback)((e=>{e.stopPropagation(),r((e=>{var t;if(e!==Kd.CLOSED)return Kd.CLOSED;const o=(null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect().top)??0;return window.innerHeight-o>100?Kd.BELOW:Kd.ABOVE}))}),[]),s=n!==Kd.CLOSED;return(0,S.jsxs)(Yd,{children:[(0,S.jsx)(qd,{ref:i,annotations:t,dotSize:18,solidDots:!s,onClick:l}),s&&(0,S.jsx)("div",{style:{position:"relative"},children:(0,S.jsx)(Jd,{$location:n,children:(0,S.jsx)(Ud,{annotations:t,topAlign:n===Kd.BELOW})})})]})},Qd=o(83887),ep=o(67156),tp=o(90370),op=o(27453),np=o(71652);function rp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ip(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?rp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):rp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ap=b.ZP.div.withConfig({displayName:"MobilePage__MobilePageContainerScroller",componentId:"sc-2trv23-0"})(["flex-grow:1;overflow:",";width:100%;","{height:auto;}"],(e=>{let{$isInExpandMode:t}=e;return t?"hidden":"auto"}),np.f),lp=b.ZP.div.withConfig({displayName:"MobilePage__StackedPage",componentId:"sc-2trv23-1"})(["position:relative;height:fit-content;width:100%;overflow-y:scroll;"]),sp=b.ZP.div.withConfig({displayName:"MobilePage__StackedPageGradient",componentId:"sc-2trv23-2"})(["background-image:",";height:","px;pointer-events:none;position:fixed;top:0;width:100%;z-index:",";"],(e=>{let{theme:t}=e;return t.gradients.headerGradientPresent}),160,T.bf),cp=b.ZP.div.withConfig({displayName:"MobilePage__PageStyles",componentId:"sc-2trv23-3"})(["height:100%;"," overflow:auto;width:100%;padding-top:","px;padding-bottom:160px;",";"],(e=>{let{$isInExpandMode:t}=e;return t&&(0,b.iv)(["min-height:100vh;"])}),(e=>{let{$globalTomeOverlay:t}=e;return t?110:62}),(e=>{let{$isSingleTextTilePage:t,$isSingleMediaTilePage:o}=e;return(o||t)&&(0,b.iv)(["padding-top:","px;min-height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;"],62)})),dp=b.ZP.div.withConfig({displayName:"MobilePage__Wrapper",componentId:"sc-2trv23-4"})(["margin:",";padding:",";width:100%;"],(e=>`${e.$padding}px 0`),(e=>`0 ${e.$padding}px`)),pp=b.ZP.div.withConfig({displayName:"MobilePage__AnnotationWrapper",componentId:"sc-2trv23-5"})(["margin-bottom:32px;padding:",";width:100%;"],(e=>`0 ${e.$padding}px`)),up=(e,t)=>{var o,n;let{page:r,preview:i,active:s,isBot:c=!1,isInExpandMode:d,canEdit:p,tomeId:u,sizes:m,isFirstPage:g,pageKind:h}=e;const{apolloClient:f,clientId:b}=(0,N.bp)();(0,Bd.L)(r.theme),(0,a.useEffect)((()=>{!i&&s&&ma.z.reportViewPresence(f,b,u,r.id)}),[s,i,f,b,u,r.id]);const y=(0,op.Z)({tomeId:u,pageId:r.id,pageKind:h,layout:r.layout,tiles:r.tiles,pixelsPerHeightUnit:m.rowSizes.unitRowHeight,rowPadding:m.pageSizes.padding,persistToBackend:!i}),{frontendPageLayout:C}=y,v=1===(null===r||void 0===r||null===(o=r.tiles)||void 0===o?void 0:o.length)&&(null===r||void 0===r?void 0:r.tiles[0].type)===z.YUT.Text,x=1===(null===r||void 0===r||null===(n=r.tiles)||void 0===n?void 0:n.length)&&[z.YUT.Image,z.YUT.Video,z.YUT.Giphy].includes(null===r||void 0===r?void 0:r.tiles[0].type),O=(0,l.Zl)(Ea.R),P=(0,a.useRef)(0),j=(0,a.useRef)(null),w=(0,l.sJ)((0,Nd.J)(u)),T=(0,Hd.Z)(m.pageSizes.height);(0,a.useEffect)((()=>{P.current=0,j.current&&(j.current.scrollTop=0)}),[s]);let I=null;if(j.current){const e=j.current.getBoundingClientRect().height,t=j.current.scrollHeight;I=t-e}const E=(0,a.useCallback)((e=>{const t=e.currentTarget,o=null===t||void 0===t?void 0:t.scrollTop;null!==I&&o<=I&&o>=0&&(o>=P.current?O(!1):O(!0),P.current=o)}),[I,O]);(0,a.useEffect)((()=>{const e=j.current;return null===e||void 0===e||e.addEventListener("scroll",E,{passive:!0}),()=>{null===e||void 0===e||e.removeEventListener("scroll",E,{passive:!0})}}),[E,j]);const _=(0,a.useMemo)((()=>(0,Ld.Z)(r.theme.id,r.theme.colors)),[r.theme.id,r.theme.colors]);return(0,S.jsx)(ap,ip(ip({},s?{"data-testid":"active_page"}:{}),{},{$isInExpandMode:d,ref:j,style:{backgroundColor:_.colors.page},children:(0,S.jsxs)(np.Z,{theme:r.theme,loadFonts:!0,children:[s&&!w&&(0,S.jsx)(Qd.Z,{overlayData:r.overlay,pageId:r.id,canEdit:p,tomeId:u,display:!0,pageHeight:m.pageSizes.height,pageWidth:m.pageSizes.width,isMobile:!0,playMode:!1}),(0,S.jsxs)(lp,{ref:t,children:[(0,S.jsx)(sp,{}),(0,S.jsx)(cp,{$isInExpandMode:d,$isSingleMediaTilePage:v,$isSingleTextTilePage:x,$globalTomeOverlay:w,style:{transition:"opacity 0.5s cubic-bezier(0.33, 1, 0.68, 1)",opacity:c||T?1:0},children:C.tiles.map(((e,t)=>{var o;const{tileId:n}=e,l=null===(o=r.tiles)||void 0===o?void 0:o.find((e=>e.id===n));if(!l)return null;const c=C.rowByTileId(n);if(!c)return null;const d=q.Zp.includes(l.type);let f;f=d?ep.bS:c.row.relativeHeight?c.row.relativeHeight:1;const b=f*ep.Cj*m.rowSizes.unitRowHeight,y=c.isSingleTile()||d?b:2*b;return(0,S.jsxs)(a.Fragment,{children:[(0,S.jsx)(dp,{style:{height:(0,tp.g)(l.type)!==tp.Y.FIXED?y:"auto"},$padding:m.pageSizes.padding,children:(0,S.jsx)(Vd.n,{canEdit:p,isMobile:!0,isSingle:!0,preview:i,tile:l,tomeId:u,sizes:m,page:r,activeDragInProgress:!1,index:t,isFirstPage:g,isPageActive:s,disableAnnotations:!1,disableExpand:!1,isTileEndpoint:!1,rowIndex:t,tileIndex:0,rowHeight:y,pageKind:h})}),l.annotations&&l.annotations.length>0&&(0,S.jsx)(pp,{$padding:m.pageSizes.padding,children:(0,S.jsx)(Xd,{onActivePage:s,annotations:l.annotations})})]},l.id)}))})]})]})}))};var mp=(0,a.memo)((0,a.forwardRef)(up)),gp=o(70131);var hp=e=>{let{children:t,shouldObserve:o,threshold:n,onChange:r}=e;return o?(0,S.jsx)(gp.df,{as:"div",threshold:n,onChange:e=>r(e),children:t}):(0,S.jsx)(S.Fragment,{children:t})};var fp=(e,t)=>{const{prevPage:o,nextPage:n,hasPrevPage:r,hasNextPage:i}=ya(e),{scrollingPageRef:l}=(0,a.useContext)(M.Z),{currentPageRef:s}=(0,N.TR)();(0,a.useEffect)((()=>{!t&&null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[t,l]);const c=(0,a.useCallback)((e=>{var t;const r=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();e.clientX<(null===r||void 0===r?void 0:r.left)&&o(),e.clientX>(null===r||void 0===r?void 0:r.right)&&n(),null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[s,n,o,l]),d=(0,a.useCallback)((e=>{var t;const o=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();null!==l&&void 0!==l&&l.current&&(e.clientX<(null===o||void 0===o?void 0:o.left)&&r?l.current.style.cursor="w-resize":e.clientX>(null===o||void 0===o?void 0:o.right)&&i?l.current.style.cursor="e-resize":l.current.style.cursor="initial")}),[s,i,r,l]),p=(0,a.useCallback)((()=>{null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[l]);return(0,a.useMemo)((()=>({handlePageContainerClick:c,handlePageContainerMouseMove:d,handlePageContainerMouseLeave:p})),[c,p,d])};function bp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function yp(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?bp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):bp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Cp=b.ZP.div.withConfig({displayName:"TomeSlider__MobileSliderContainer",componentId:"sc-9hehdy-0"})(["display:flex;outline:none;overflow-x:scroll;overflow-y:hidden;scroll-snap-type:x mandatory;::-webkit-scrollbar:horizontal{display:none;}"]),vp=(0,b.ZP)(d.E.div).withConfig({displayName:"TomeSlider__SliderContainer",componentId:"sc-9hehdy-1"})(["outline:none;display:grid;position:absolute;"]),xp=(0,b.iv)(["display:flex;align-items:center;overflow-y:",";"],(e=>{let{$isInExpandMode:t}=e;return t?"hidden":"scroll"})),Op=b.ZP.div.withConfig({displayName:"TomeSlider__MobilePageContainer",componentId:"sc-9hehdy-2"})([""," display:flex;flex-direction:column;height:100vh;min-width:100vw;overflow-y:hidden;scroll-snap-align:start;scroll-snap-stop:always;width:100vw;"],xp),Pp=b.ZP.div.withConfig({displayName:"TomeSlider__DesktopPageContainer",componentId:"sc-9hehdy-3"})([""," flex-direction:column;position:absolute;display:",";justify-content:center;height:100vh;top:0;bottom:0;"],xp,(e=>e.$active?"inherit":"none")),jp=a.forwardRef(((e,t)=>{let{tome:o,canEdit:n,useEditablePage:r,presentMode:i,isBot:s,isMobile:d,isInExpandMode:p,width:u,pageVerticalMargin:m,pageContainerWidth:g,pageContainerHeight:h,fullscreenMode:f}=e;const[y,C]=(0,l.FV)(H.Vx),v=(0,l.sJ)(w.wo),x=(0,l.Zl)(H.$s),O=(0,c.l)(H.k6),P=(0,a.useRef)(0),j=(0,V.xh)(o.pages,y)??P.current;P.current=j;const T=u,I=(0,a.useMemo)((()=>Ha._C.fromPageAndWindowDimension(g,h,d)),[g,h,d]),E=(0,a.useRef)(null),_=(0,b.Fg)(),k=(0,a.useRef)(null),Z=(0,$.Z)(y);(0,a.useEffect)((()=>{if(d&&E.current){const e=j*T-E.current.scrollLeft;if(Math.abs(e)<T/2)return;E.current.scrollLeft=j*T,Z!==y&&(k.current=y)}}),[E,d,y,j,T,Z]);let D=-1;if(d&&E.current){const e=E.current.scrollLeft,t=Math.round(e/T);Math.abs(t*T-e)<.1*T&&(D=t)}const R=(0,a.useCallback)((e=>d?{}:{style:{width:"100vw",height:"100vh",transformOrigin:"top",transform:`translate3d(${e}px, 0px, 0px)`,padding:`${m}px 0`}}),[d,m]),A=d?Op:Pp,L=d?mp:Dd.ZP,{currentPageRef:B}=(0,N.TR)(),{0:F,1:G}=(0,a.useState)(d?{height:"100%",width:"100%"}:{alignItems:"center",flexDirection:"row",height:"100vh",width:"100vw"});(0,a.useEffect)((()=>{if(d)G({height:"100%",width:"100%"});else{G({alignItems:"center",flexDirection:"row",height:"100vh",transform:`translate3d(${-j*T-T/2}px, -${_.headerHeight}px, 0px)`})}}),[_.headerHeight,d,j,T]);const z=(0,a.useRef)(new Map),U=(0,No.Z)(((e,t)=>o=>{null!==o?z.current.set(e,o):z.current.delete(e),t&&!B.current&&(B.current=o)}),[B]);(0,a.useEffect)((()=>{B.current=z.current.get(y)}),[y,B]);const{setScrollingPageRef:W}=(0,a.useContext)(M.Z),q=d?Cp:vp,K=(0,a.useCallback)((e=>{e.target.scrollTop>=m*O-_.headerHeight?x(!0):x(!1)}),[x,m,O,_.headerHeight]);(0,a.useEffect)((()=>{x(!1)}),[y,x]);const{handlePageContainerClick:Y,handlePageContainerMouseMove:J,handlePageContainerMouseLeave:X}=fp(o.pages,i),Q=i&&!p&&!f&&!d&&!v,ee=Rd(j,10);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(q,{"data-testid":"slider_container",style:F,ref:(0,Zd.l)([t,E]),children:(0,S.jsx)(Ad,{activePageIndex:j,windowSize:d?Number.MAX_SAFE_INTEGER:10,data:o.pages,itemSize:T,renderItem:(e,t,i)=>{return(0,S.jsx)(hp,{shouldObserve:d,threshold:[.6],onChange:o=>{o&&t!==D&&(k.current===e.id?k.current=null:k.current||C(e.id))},children:(0,S.jsx)(A,yp(yp({"data-testid":"page_container",$active:t===j,$isInExpandMode:p,ref:t!==j||d?void 0:W,onClick:Q?Y:void 0,onMouseMove:Q?J:void 0,onMouseEnter:Q?J:void 0,onMouseLeave:Q?X:void 0},R(i)),{},{onScroll:d?void 0:K,children:!d||(a=t,a>=ee[0]&&a<ee[1])?(0,S.jsx)(L,{active:t===j,isBot:s,isVisible:!!d||t===j,isInExpandMode:p,ref:U(e.id,t===j),page:e,canEdit:!d&&n,useEditablePage:!d&&r,tomeId:o.id,sizes:I,isFirstPage:0===t,preview:!1,pageVerticalMargin:m,pageKind:kd.s.MAIN}):null}),e.id)},e.id);var a}})}),(0,S.jsx)(Md,{})]})}));var wp,Tp=jp,Ip=o(33504);function Ep(){return Ep=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ep.apply(this,arguments)}var _p,Sp,kp=function(e){return a.createElement("svg",Ep({width:28,height:28,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),wp||(wp=a.createElement("path",{d:"M15.094 6.125a1.094 1.094 0 00-2.188 0v6.781H6.125a1.094 1.094 0 000 2.188h6.781v6.781a1.094 1.094 0 102.188 0v-6.781h6.781a1.094 1.094 0 100-2.188h-6.781V6.125z",fill:"#fff"})))};function Zp(){return Zp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Zp.apply(this,arguments)}var Dp,Mp=function(e){return a.createElement("svg",Zp({width:28,height:28,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),_p||(_p=a.createElement("path",{d:"M14 18.375a4.375 4.375 0 100-8.75 4.375 4.375 0 000 8.75z",fill:"#fff"})),Sp||(Sp=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.5 14c0 5.799-4.701 10.5-10.5 10.5S3.5 19.799 3.5 14 8.201 3.5 14 3.5 24.5 8.201 24.5 14zm-1.75 0a8.75 8.75 0 11-17.5 0 8.75 8.75 0 0117.5 0z",fill:"#fff"})))};function Rp(){return Rp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Rp.apply(this,arguments)}var Ap=function(e){return a.createElement("svg",Rp({width:28,height:28,viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Dp||(Dp=a.createElement("path",{d:"M32 8c13.255 0 24 10.745 24 24 0 6.617-5.98 11-13 11h-5c-1.768 0-4 .323-4 3 0 2.627 2 4.28 2 7 0 1.616-1.273 3-4 3C18.745 56 8 45.255 8 32S18.745 8 32 8zm13.5 27a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zm-7-11a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zm-13 0a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zM14 30.5a4.5 4.5 0 109.003.002 4.5 4.5 0 00-9.004-.003l.002.001z",fill:"#fff"})))};function Lp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Np(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Lp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Lp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Hp=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Np(Np({ref:t,style:{width:"1em",height:"1em"},viewBox:"0 0 28 28"},e),{},{children:[(0,S.jsx)("path",{d:"M5.25 8.75C5.25 6.817 6.817 5.25 8.75 5.25H19.25C21.183 5.25 22.75 6.817 22.75 8.75V12.9062C22.75 13.0271 22.6521 13.125 22.5312 13.125H16.625C14.692 13.125 13.125 14.692 13.125 16.625V22.5312C13.125 22.6521 13.0271 22.75 12.9062 22.75H8.75C6.817 22.75 5.25 21.183 5.25 19.25V8.75Z"}),(0,S.jsx)("path",{d:"M20.9094 14.875H16.625C15.6585 14.875 14.875 15.6585 14.875 16.625V20.9094C14.875 21.1043 15.1106 21.2019 15.2484 21.0641L21.0641 15.2484C21.2019 15.1106 21.1043 14.875 20.9094 14.875Z"})]}))));const Vp=["children","selected","Component"];function Bp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Fp(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Bp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Bp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const $p=b.ZP.div.withConfig({displayName:"Toolbarstyles__ToolbarStyles",componentId:"sc-1hfd498-0"})(["margin-right:","px;width:","px;overflow:hidden;z-index:",";position:absolute;top:","px;right:0;display:flex;justify-content:center;"],(e=>e.theme.panelSpacing),(e=>e.$width),T.Mf,(e=>-e.theme.headerHeight)),Gp=b.ZP.div.withConfig({displayName:"Toolbarstyles__ToolbarInner",componentId:"sc-1hfd498-1"})(["display:flex;flex-direction:column;justify-content:center;"]),zp=b.ZP.div.withConfig({displayName:"Toolbarstyles__IconStyleActiveArea",componentId:"sc-1hfd498-2"})(["padding:6px;display:flex;align-self:center;background:",";border-radius:6px;cursor:pointer;svg{height:28px;width:28px;}svg path{opacity:",";}svg path:not(.ignore-fill){fill:",";}"],(e=>{let{selected:t,theme:o}=e;return t?o.colors.iconSelectedBg:"transparent"}),(e=>{let{selected:t}=e;return t?1:.5}),(e=>e.selected?e.theme.colors.iconSelected:e.theme.colors.icon)),Up=b.ZP.button.attrs((()=>({type:"button"}))).withConfig({displayName:"Toolbarstyles__IconStyleContainer",componentId:"sc-1hfd498-3"})(["border:none;background-color:transparent;padding:4px 0;&:hover{","{background:",";}}"],zp,(e=>{let{selected:t,theme:o}=e;return t?o.colors.iconHoverSeletedBg:o.colors.iconHoverBg})),Wp=e=>{let{children:t,selected:o,Component:n=Up}=e,r=(0,i.Z)(e,Vp);return(0,S.jsx)(n,Fp(Fp({selected:o},r),{},{children:(0,S.jsx)(zp,{selected:o,children:t})}))},qp=(0,b.ZP)(Up).withConfig({displayName:"Toolbarstyles__TileIconStyles",componentId:"sc-1hfd498-4"})(["svg path:not(.ignore-fill){fill:",";}&:hover{","{background:",";}}"],(e=>e.selected?e.theme.colors.contentAccent:e.theme.colors.icon),zp,(e=>!e.selected&&e.theme.colors.iconHoverBg));var Kp=e=>{let{width:t,height:o}=e;const n=(0,E.t2)(),r=(0,E.f3)(),i=(0,E.xs)(),s=(0,l.Zl)(kn.Hl),d=(0,a.useCallback)((e=>{r===e?((0,H.PS)(!1),s(!1),n.closePropertyPanel()):(e===_.Z.ANNOTATION&&s(!0),n.setPropertyPanel(e))}),[r,n,s]),{t:p}=(0,y.$G)(),{toolbarRef:u}=(0,N.TR)(),m=(0,c.l)(H.Dm),{data:g}=(0,Rs.a)(Ip.Z,{variables:{id:m},skip:null==m}),h=(0,B.ye)(B.TT.ANNOTATIONS),f=g?g.tile:null,[b]=f?(0,q.An)(f.type):[null],C=(0,l.sJ)(H.uz),v=(0,a.useCallback)((()=>{d(_.Z.TILE),C()}),[d,C]),x=f&&b&&(0,S.jsx)(Wp,{"data-testid":`${b.label.toLowerCase()}_tile_icon_button`,selected:i(_.Z.TILE),onClick:v,renderTooltip:()=>p("components.toolbar.tileTypeTooltipLabel",{tileTypeLabel:`${null===b||void 0===b?void 0:b.label}`}),disableTooltip:!!r,Component:qp,role:"tab","aria-label":p("components.toolbar.tileTypeLabelText",{tileTypeLabel:`${b.label}`}),"aria-selected":r===_.Z.TILE,children:(0,S.jsx)(b.icon,{style:{width:28,height:28}})},b.label.toLowerCase()),O=(0,S.jsx)(Wp,{selected:r===_.Z.ANNOTATION,onClick:()=>{d(_.Z.ANNOTATION),(0,H.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.annotateIconTooltipLabel"),tooltipShortcuts:[(0,Xs.C6)(),"A"],role:"tab","aria-selected":r===_.Z.ANNOTATION,children:(0,S.jsx)(Hp,{"data-testid":"annotation_toolbar_icon",style:{height:28,width:28}})},"annotation");return(0,S.jsx)($p,{$width:t,"data-testid":"toolbar",style:"number"===typeof o?{height:o}:{},children:(0,S.jsx)(Gp,{ref:u,role:"tablist",children:(0,S.jsxs)(st.Z,{offset:9,placement:"left",children:[x,(0,S.jsx)(Wp,{selected:r===_.Z.ADD_TILE,onClick:()=>{d(_.Z.ADD_TILE),(0,H.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.addTileTooltipLabel"),tooltipShortcuts:[(0,Xs.C6)(),"T"],role:"tab","aria-selected":r===_.Z.ADD_TILE,children:(0,S.jsx)(kp,{"data-testid":"add_tile_toolbar_icon"})},"add_tile"),(0,S.jsx)(Wp,{selected:r===_.Z.RECORD,onClick:()=>{d(_.Z.RECORD),(0,H.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.recordNarrationTooltipLabel"),tooltipShortcuts:[(0,Xs.C6)(),"R"],role:"tab","aria-selected":r===_.Z.RECORD,children:(0,S.jsx)(Mp,{"data-testid":"record_toolbar_icon"})},"record"),h&&O,(0,S.jsx)(Wp,{selected:r===_.Z.CUSTOMIZE,onClick:()=>{d(_.Z.CUSTOMIZE),(0,H.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.setThemeTooltipLabel"),tooltipShortcuts:[(0,Xs.C6)(),"O"],role:"tab","aria-selected":r===_.Z.CUSTOMIZE,children:(0,S.jsx)(Ap,{"data-testid":"color_palette_icon"})},"customize")]})})})},Yp=o(30383),Jp=o(43002);const Xp=e=>{var t;return!!(null===(t=e.target.closest("[data-tome-bypass-tap-navigation]"))||void 0===t?void 0:t.getAttribute("data-tome-bypass-tap-navigation"))};var Qp=e=>{let{enabled:t=!1,pages:o}=e;const n=(0,a.useRef)(null),r=(0,l.sJ)(H.Vx),{0:i,1:s}=(0,a.useState)(!1),{0:c,1:d}=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(window.Cypress)return s(!0),()=>{};s(!1),d(!1);const e=setTimeout((()=>{s(!0)}),300);return()=>{clearTimeout(e)}}),[r]);const p=(0,a.useCallback)((e=>{const t=e/window.innerWidth*100;return{leftTap:t<40,rightTap:t>=40}}),[]),u=(0,a.useCallback)((e=>{if(i||(e.preventDefault(),e.stopPropagation()),Xp(e)&&i)return;e.stopPropagation();const{leftTap:t,rightTap:a}=p(e.pageX);if(t){var l;const e=(0,V.xh)(o,r)||0;null===(l=n.current)||void 0===l||l.scroll({left:window.innerWidth*(e-1)})}if(a){var s;const e=(0,V.xh)(o,r)||0;null===(s=n.current)||void 0===s||s.scroll({left:window.innerWidth*(e+1)})}}),[i,p,o,r]),m=(0,a.useCallback)((e=>{if(Xp(e))return;const{leftTap:t}=p(e.pageX),n=(0,V.xh)(o,r)||0;d(t&&n>0)}),[p,o,r]),g=(0,a.useCallback)((()=>{d(!1)}),[]);return t?{handleTap:u,handlePointerDown:m,handlePointerUp:g,isHoldingLeft:c,sliderRef:n}:{handleTap:void 0,handlePointerDown:void 0,handlePointerUp:void 0,isHoldingLeft:!1,sliderRef:n}},eu=o(15487),tu=o(46253),ou=o(71048),nu=o(41822),ru=o(6355);const iu=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__ScrimOverlay",componentId:"avkij0-0"})(["position:fixed;pointer-events:none;inset:0;background-color:",";width:100vw;height:100vh;"],(e=>{let{theme:t}=e;return t.colors.onboardingAutotomeScrim})),au=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__SpecialModalContent",componentId:"avkij0-1"})(["position:fixed;width:100%;height:100%;overflow:hidden;"]),lu=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__DialogBackground",componentId:"avkij0-2"})(["position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:340px;box-shadow:",";background:",";border-radius:12px;padding:24px;"],(e=>{let{theme:t}=e;return t.colors.panelBoxShadow}),(e=>{let{theme:t}=e;return t.colors.dialogBackground})),su=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__HStack",componentId:"avkij0-3"})(["display:flex;flex-direction:row;height:24px;align-items:end;justify-content:space-between;margin-bottom:6px;margin-right:-12px;"]),cu=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__TextAndButtonsContainer",componentId:"avkij0-4"})(["flex-direction:column;display:flex;"]),du=b.ZP.h3.withConfig({displayName:"OnboardingAutotomeModalContent__Heading",componentId:"avkij0-5"})(["font-family:",";font-weight:700;font-size:20px;line-height:24px;color:",";margin-block-end:8px;margin-top:0px;margin-bottom:3px;"],(e=>{let{theme:t}=e;return t.fonts.ui}),(e=>{let{theme:t}=e;return t.colors.primaryUiText})),pu=b.ZP.p.withConfig({displayName:"OnboardingAutotomeModalContent__Text",componentId:"avkij0-6"})(["font-family:",";font-size:16px;margin-top:0px;line-height:130%;margin-block-end:12px;margin-bottom:12px;text-align:left;color:",";"],(e=>{let{theme:t}=e;return t.fonts.ui}),(e=>{let{theme:t}=e;return t.colors.confirmationModalSubtitle})),uu=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__TextContainer",componentId:"avkij0-7"})(["margin-bottom:12px;"]);var mu=e=>{let{close:t}=e;const{t:o}=(0,y.$G)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(iu,{}),(0,S.jsx)(au,{"data-testid":"autotome_onboarding_modal",children:(0,S.jsx)(lu,{children:(0,S.jsxs)(cu,{children:[(0,S.jsxs)(su,{children:[(0,S.jsx)(du,{children:o("components.onboardingAutotomeModalContent.welcomeModalTitle")}),(0,S.jsx)(Wa,{"aria-label":o("components.onboardingAutotomeModalContent.closeButtonLabel"),onClick:t,icon:(0,S.jsx)(Jt.Z,{style:{width:28,height:28,opacity:.4}})})]}),(0,S.jsxs)(uu,{children:[(0,S.jsx)(pu,{children:o("components.onboardingAutotomeModalContent.toolsAndGeneratingAIContentGuideText")}),(0,S.jsx)(pu,{children:o("components.onboardingAutotomeModalContent.toCheckoutYourWorkspaceGuideText")})]}),(0,S.jsx)(He.Z,{"data-testid":"nux_start_button",size:"large",color:"primary",variant:"contained",onClick:t,children:o("components.onboardingAutotomeModalContent.letsGoButtonLabel")})]})})})]})};function gu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function hu(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):gu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const fu=(0,b.ZP)(ru.fC).withConfig({displayName:"OnboardingAutotomeModal__DialogPortal",componentId:"f4rp31-0"})(["width:100%;height:100%;display:flex;justify-content:center;padding:72px;align-items:flex-end;"]),bu=(e,t)=>{const[o]=(0,z.H8S)(),{user:n}=(0,a.useContext)(dr.Z),[r,i]=(0,l.FV)(H.e7),{0:s,1:c}=(0,a.useState)(!1),d=(0,a.useCallback)((()=>{c(!0),n&&n.id&&o({variables:{userId:n.id,newUserOnboardingTaskProgress:z.lnN.End},update(e,t){let{data:o}=t;null!==o&&void 0!==o&&o.updateUserAttributes&&e.modify({id:e.identify(n),fields:{attributes(e){var t;return hu(hu({},e),null===o||void 0===o||null===(t=o.updateUserAttributes)||void 0===t?void 0:t.attributes)}}})}})}),[o,n]);(0,a.useEffect)((()=>{r||d()}),[r,d]);const p=(0,a.useCallback)((async()=>{c(!1),i(!0)}),[i]);return s?(0,S.jsx)(fu,{style:{zIndex:T.IT-1},ref:t,children:(0,S.jsx)(mu,{close:p})}):(0,S.jsx)(S.Fragment,{})};var yu=(0,a.forwardRef)(bu);const Cu=b.ZP.div.withConfig({displayName:"TapToNavigateFeedbackstyles__TapToNavigateFeedback",componentId:"p2f1x1-0"})(["position:fixed;left:0;top:0;bottom:0;right:0;z-index:",";pointer-events:none;height:100vh;width:40%;opacity:",";transition:opacity 0.2s ease;background:radial-gradient( 86.92% 43.15% at 0% 50%,rgba(0,0,0,1) 0%,rgba(0,0,0,0) 100% );"],T.y$,(e=>{let{visible:t,theme:o}=e;return t?o.colors.tapToNavigateBackOpacity:0}));var vu=o(37865);var xu=e=>{let{tomeId:t}=e;const o=(0,x.s)(),[n,r]=(0,l.FV)((0,vu.$)(t));return(0,a.useEffect)((()=>{n&&o.open()}),[n,o]),(0,S.jsx)(x.Z,{ref:o.ref,title:n?n.title:"",subtitle:n?n.subtitle:"",primaryButtonContent:"OK",primaryButtonAction:()=>{r(null),o.close()},buttonColor:"primary",dismissible:!1})},Ou=o(31709);var Pu=e=>{let{triggerTomeRefetch:t}=e;const o=(0,l.sJ)(H.GP),n=(0,$.Z)(o),{documentVisibility:r}=(0,Ou.Z)();return(0,a.useEffect)((()=>{o&&r&&!n&&void 0!==n&&(t(),s.v.addAction("networkReconnectTomeRefetch"))}),[o,n,t,r]),(0,S.jsx)(S.Fragment,{})},ju=o(82175),wu=o(41100);function Tu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Iu(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Tu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Tu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Eu=(0,b.ZP)(d.E.div).withConfig({displayName:"TomePlaybackOverlay__OverlayWrapper",componentId:"sc-1vcdxeo-0"})(["z-index:",";position:absolute;top:",";right:",";cursor:pointer;"],T.y$,(e=>{let{$isMobile:t}=e;return t?"62px":"24px"}),(e=>{let{$isMobile:t}=e;return t?"12px":"56px"}));function _u(e){if(!e)return e;const t=new URL(e);return t.search="",t.href}var Su=e=>{let{overlayData:t,isMobile:o,pages:n,tomeId:r,sliderRef:i}=e;const[s,c]=(0,l.FV)(H.Vx),d=(0,a.useRef)(null),{0:p,1:u}=(0,a.useState)([]),{0:m,1:g}=(0,a.useState)(!1),h=(0,a.useRef)(),f=(0,a.useRef)();(0,a.useEffect)((()=>{const e=(0,V.xh)(n,s);if(p&&null!==e){var t;const n=p.find((t=>t.pageIndex===e));if(!n)return;const r=n.from/1e3;var o;if(d.current&&Math.abs((null===(t=d.current)||void 0===t?void 0:t.currentTime())-r)>1)m&&(d.current.toggleVideo(),g(!1)),null===(o=d.current)||void 0===o||o.setCurrentTime(r),(m||h.current&&f.current!==e)&&(h.current&&clearTimeout(h.current),f.current=e,h.current=setTimeout((()=>{var e;null===(e=d.current)||void 0===e||e.toggleVideo(),h.current=void 0,f.current=void 0}),500))}}),[s,m,n,p]),(0,a.useEffect)((()=>{fetch("/assets/ymrtyt.vtt").then((e=>e.text())).then((e=>{const t=(0,ju.Q)(e).entries.map(((e,t)=>Iu(Iu({},e),{},{pageIndex:t+1})));u(t)})).catch((e=>{console.error(e)}))}),[]);const b={onTimeUpdate:(0,a.useCallback)((e=>{var t;const r=null===(t=e.target)||void 0===t?void 0:t.currentTime;if(!m)return;const a=null===p||void 0===p?void 0:p.find((e=>{const t=e.from/1e3,o=e.to/1e3;return r>=t&&r<=o}));if(a){const e=(0,V.Bb)(n,a.pageIndex);var l;if(e&&e!==s)if(o)null===(l=i.current)||void 0===l||l.scroll({left:window.innerWidth*a.pageIndex});else c(e)}}),[m,n,p,c,i,o,s])},C=(0,a.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.toggleVideo()}),[]),v=(0,a.useCallback)((e=>{g(e)}),[g]),x=(0,a.useMemo)((()=>function(e){return Iu(Iu({},e),{},{videoThumbnailUrl:_u(e.videoThumbnailUrl)})}(t)),[t]),{t:O}=(0,y.$G)();return(0,S.jsx)(Eu,{$isMobile:o,onTap:C,children:(0,S.jsx)(wu.Z,{ref:d,overlayData:x,setPlaybackPlaying:v,isMobile:o,isInRecordMode:!1,shouldBeVisible:!0,shouldAnimateIn:!0,tooltipCopy:O(o?"tome.tomePlaybackOverlay.tapToAutoPlayWithAudioTooltip":"tome.tomePlaybackOverlay.clickToAutoplayWithAudioTooltip"),shouldScaleTooltip:!1,videoProps:b,size:o?wu.f.SMALL:wu.f.NORMAL,tomeId:r,forceLoad:o})})},ku=o(111),Zu=o(57982),Du=o(50427),Mu=o(83809);var Ru=()=>{const{getActiveController:e}=(0,a.useContext)(X.Z),t=(0,c.l)(H.Dm);(0,a.useEffect)((()=>{null===t&&(0,H.WC)(null)}),[t]);return{navigateTileByDirection:(0,l._8)((o=>{let{set:n}=o;return o=>{const r=e();if(t&&r){const e=(0,H.WC)(),{tileId:i,lastIntentionalColumnIdx:a}=r.tileNeighborByDirection(t,o,e);i&&((0,H.Dm)(i),n((0,H.Eq)(i),!0)),(0,H.WC)(a)}}}),[e,t])}},Au=o(44566),Lu=o(12064);function Nu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Hu(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Nu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Nu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Vu=()=>{const{scrollingPageRef:e,setPageScrollTopAnimatedToRef:t,setPageScrollAnimationStopRef:o}=(0,a.useContext)(M.Z);return(0,a.useCallback)((n=>{const r=e.current.scrollTop,i=(0,Lu.j)(r,n,Hu(Hu({},I.yh),{},{onUpdate:t=>{e.current&&(e.current.scrollTop=t)},onComplete:()=>{t(null),o(null)}}));t(n),o(i.stop)}),[e,t,o])},Bu=o(63553);var Fu=e=>{let{isInExpandMode:t,enterPresentMode:o,exitPresentMode:n,exitExpandMode:r,tome:i,canEdit:s,presentMode:d,setShowLayoutSelection:p}=e;const{apolloClient:u,clientId:m}=(0,N.bp)(),g=(0,B.ye)(B.TT.ANNOTATIONS),[h,f]=(0,l.FV)(H.Vx),[b,C]=(0,l.FV)(H.pt),v=(0,l.rb)(kn.Qf),x=(0,l.Zl)(kn.Hl),O=(0,l.Zl)(kn.tF),{t:P}=(0,y.$G)(),j=(0,E.t2)(),T=(0,E.f3)(),I=(0,c.l)(H.Dm),k=(0,c.l)(H.k$),Z=(0,l.sJ)(w.wo),[D,R]=(0,l.FV)(Ae.cm),[A,L]=(0,l.FV)(Ae.s5),F=(0,c.l)(H.pm),{controlCommandPrompt:$}=(0,Sc.br)(),{getActiveController:G}=(0,a.useContext)(X.Z),{navigateTileByDirection:z}=Ru(),{scrollingPageRef:U,pageScrollTopAnimatedToRef:W,pageScrollAnimationStopRef:q}=(0,a.useContext)(M.Z),Y=Vu(),J=(0,a.useCallback)(((e,o)=>{if(t)return;const n=(0,V.xh)(i.pages,h);if(n-1>=0){const e=(0,V.Bb)(i.pages,n-1);f(e),C(o?[n-1]:[])}e.preventDefault()}),[h,t,f,i.pages,C]),Q=(0,a.useCallback)(((e,o)=>{var n;if(t)return;const r=(0,V.xh)(i.pages,h);if(r+1<((null===(n=i.pages)||void 0===n?void 0:n.length)||0)){const e=(0,V.Bb)(i.pages,r+1);f(e),C(o?[r+1]:[])}e.preventDefault()}),[h,t,f,i.pages,C]),ee=(0,a.useCallback)((()=>{const e=G();if(I&&e){const t=(0,V.yW)(i.pages,h);(0,Mu.A)(I,t,e,j,i.id,u,m)}else b.length>0&&(0,V.sc)(i,b,u,m,C,f)}),[G,I,b,i,h,j,u,m,C,f]),te=(0,a.useCallback)((()=>{(0,V.tv)(i,b,u,m,C,f)}),[i,u,m,b,C,f]),oe=(0,a.useCallback)((e=>{b.length>0&&(e.preventDefault(),(0,V.Y1)(i,b,u,m))}),[b,i,u,m]),ne=(0,a.useCallback)((e=>{b.length>0&&(e.preventDefault(),(0,V.ZB)(i,b,u,m))}),[b,i,u,m]),re=(0,a.useCallback)((e=>{e.preventDefault(),D||A||(n(),r(),null!==T&&j.closePropertyPanel(),null!==I&&(0,H.Dm)(null),C((e=>e.length>0?[]:e)),v())}),[D,A,n,r,T,I,C,v,j]),ie=(0,a.useCallback)((e=>{const t=(0,H.fz)();if(!t)return;const{type:o}=t;switch(o){case"TILE":break;case"PAGE":e.preventDefault(),(0,V.Qy)(i,b,h,u,m,C,f)}}),[i,h,u,m,b,C,f]),ae=(0,a.useMemo)((()=>(0,ku.Z)((()=>{(0,H.ak)({message:P("throttledToastMessage.workSaved")})}),2e3)),[P]),le=(0,a.useCallback)((e=>{e.preventDefault(),ae()}),[ae]),se=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{if(I){var o;const a=null===(o=i.pages)||void 0===o?void 0:o.flatMap((e=>e.tiles)).find((e=>(null===e||void 0===e?void 0:e.id)===I));if(D||!a||"IMAGE"!==a.type&&"GIPHY"!==a.type)if(!A&&a&&"VIDEO"===a.type){var n;const o=t.getLoadable((0,bt.M)({tileId:I,url:(null===a||void 0===a||null===(n=a.videoTileData)||void 0===n?void 0:n.url)||""})).getValue();(0,ft.M)(null===a||void 0===a?void 0:a.mediaTileData,o)||L(!0),e.preventDefault()}else a&&"BLANK"===a.type&&(j.setPropertyPanel(_.Z.ADD_TILE),e.preventDefault());else{var r;(0,K.Gj)(null===a||void 0===a?void 0:a.imageAttributes,null===a||void 0===a||null===(r=a.mediaTileData)||void 0===r?void 0:r.mediaStatus)||R(!0),e.preventDefault()}}}}),[I,i.pages,D,A,R,L,j]),ce=(0,a.useCallback)((e=>{if(e.preventDefault(),!(Z||F||t))if(I)z(Bu.y.DOWN);else if(b.length>0)Q(e,!0);else if(U.current){var o;null===(o=q.current)||void 0===o||o.call(q);const t=U.current.scrollTop;let n;n=null!=W.current&&W.current>t?W.current:t;const r=(0,H.k6)(),i=U.current.getBoundingClientRect().height,a=Math.floor(U.current.scrollHeight-i/r),l=.5*window.innerHeight/r,s=Math.floor(Math.min(n+l,a));n>=a||t>=s?Q(e,!1):Y(s)}}),[I,Z,F,t,b.length,U,z,Q,q,W,Y]),de=(0,a.useCallback)((e=>{if(!(Z||F||t))if(e.preventDefault(),I)z(Bu.y.UP);else if(b.length>0)J(e,!0);else if(U.current){var o;null===(o=q.current)||void 0===o||o.call(q);const t=U.current.scrollTop;let n;n=null!=W.current&&W.current<t?W.current:t;const r=(0,H.k6)(),i=.5*window.innerHeight/r,a=Math.floor(Math.max(n-i,0));0===n||t<=a?J(e,!1):Y(a)}}),[I,Z,F,t,b.length,U,z,J,q,W,Y]),pe=(0,a.useCallback)((e=>{if(!Z&&!F)if(e.preventDefault(),I)z(Bu.y.RIGHT);else if(T!==_.Z.ADD_TILE){if(I)return;Q(e,!1)}}),[T,Z,F,Q,z,I]),ue=(0,a.useCallback)((e=>{if(!Z&&!F)if(e.preventDefault(),I)z(Bu.y.LEFT);else if(T!==_.Z.ADD_TILE){if(I)return;e.preventDefault(),J(e,!1)}}),[T,Z,F,J,z,I]),me=(0,a.useCallback)((e=>{e.preventDefault(),C((e=>{var t;const o=Math.min(...e),n=Math.max(...e);if(n<0)return e;const r=[...e];return o<(0,V.xh)(i.pages,h)?r.splice(r.indexOf(o),1):n+1<((null===(t=i.pages)||void 0===t?void 0:t.length)||0)&&r.push(n+1),r.concat()}))}),[h,C,i.pages]),ge=(0,a.useCallback)((e=>{e.preventDefault(),C((e=>{const t=Math.min(...e),o=Math.max(...e);if(t<0||0===o)return e;const n=[...e];return o>(0,V.xh)(i.pages,h)?n.splice(n.indexOf(o),1):n.splice(n.indexOf(t),0,t-1),n.concat()}))}),[h,C,i.pages]),he=(0,a.useCallback)((e=>{var t,o;null!==(t=e.clipboardData)&&void 0!==t&&null!==(o=t.files[0])&&void 0!==o&&o.type.startsWith("image")}),[]);(0,Zu.Z)({disabled:d,onPaste:he});const fe=(0,a.useCallback)((e=>{e.preventDefault(),$({action:Sc.$C.TOGGLE_IF_AVAILABLE})}),[$]),be=(0,a.useCallback)((()=>{!s||d||t||(j.setPropertyPanel((e=>e===_.Z.ANNOTATION?null:_.Z.ANNOTATION)),x(T!==_.Z.ANNOTATION))}),[s,d,t,j,x,T]),ye=(0,a.useCallback)((()=>{d&&O((e=>!e))}),[d,O]),Ce=(0,a.useCallback)((()=>{d||t||(0,H.k$)(!k)}),[k,d,t]),ve=(0,a.useCallback)((()=>{p(!0)}),[p]),xe=(0,a.useCallback)((()=>{d&&_c()}),[d]),Oe=(0,a.useCallback)((()=>{!s||d||t||j.setPropertyPanel((e=>e===_.Z.RECORD?null:_.Z.RECORD))}),[s,t,d,j]),Pe=(0,a.useCallback)((()=>{!s||d||t||j.setPropertyPanel((e=>e===_.Z.CUSTOMIZE?null:_.Z.CUSTOMIZE))}),[s,t,d,j]),je=(0,a.useCallback)((e=>{!s||d||t||(e.preventDefault(),T===_.Z.ADD_TILE?j.closePropertyPanel():(j.setPropertyPanel(_.Z.ADD_TILE),(0,H.Dm)(null)))}),[s,d,t,T,j]),we=(0,a.useMemo)((()=>{const e=new Map;return e.set("down",{callback:ce,enableKeybindingInEditableElements:!1}),e.set("up",{callback:de,enableKeybindingInEditableElements:!1}),e.set("right",{callback:pe,enableKeybindingInEditableElements:!1}),e.set("left",{callback:ue,enableKeybindingInEditableElements:!1}),e.set("esc",{callback:re,enableKeybindingInEditableElements:!1}),s&&(e.set(["backspace","del"],{callback:ee,enableKeybindingInEditableElements:!1}),e.set("mod+k",{callback:fe,enableKeybindingInEditableElements:!0}),e.set("mod+c",{callback:oe,enableKeybindingInEditableElements:!1}),e.set("mod+x",{callback:ne,enableKeybindingInEditableElements:!1}),e.set("mod+v",{callback:ie,enableKeybindingInEditableElements:!1}),e.set("mod+d",{callback:e=>{e.preventDefault(),te()},enableKeybindingInEditableElements:!0}),e.set("mod+z",{callback:e=>{e.preventDefault(),(0,Du.Y)(u,m)},enableKeybindingInEditableElements:!1}),e.set("shift+mod+z",{callback:e=>{e.preventDefault(),(0,Du.K)(u,m)},enableKeybindingInEditableElements:!1}),e.set("mod+s",{callback:le,enableKeybindingInEditableElements:!0}),e.set("enter",{callback:se,enableKeybindingInEditableElements:!1}),e.set(["shift+down","shift+right"],{callback:me,enableKeybindingInEditableElements:!1}),e.set(["shift+up","shift+left"],{callback:ge,enableKeybindingInEditableElements:!1}),g&&e.set("alt+a",{callback:be,enableKeybindingInEditableElements:!0}),e.set("alt+h",{callback:ye,enableKeybindingInEditableElements:!0}),e.set("alt+m",{callback:Ce,enableKeybindingInEditableElements:!0}),e.set("alt+n",{callback:ve,enableKeybindingInEditableElements:!0}),e.set("alt+p",{callback:o,enableKeybindingInEditableElements:!0}),e.set("alt+f",{callback:xe,enableKeybindingInEditableElements:!0}),e.set("alt+r",{callback:Oe,enableKeybindingInEditableElements:!0}),e.set("alt+t",{callback:je,enableKeybindingInEditableElements:!0}),e.set("alt+o",{callback:Pe,enableKeybindingInEditableElements:!0})),e}),[ce,de,pe,ue,re,s,ee,fe,le,se,me,ge,g,be,ye,Ce,ve,o,xe,Oe,je,Pe,oe,ne,ie,te,u,m]);return(0,S.jsx)(Au.a,{bindings:we})},$u=o(26072),Gu=o(62090),zu=o(36902),Uu=o(24978),Wu=o(14961),qu=o(71179),Ku=o(50591),Yu=o(11209),Ju=o(8557),Xu=o(57903),Qu=o(26705),em=o(97297);function tm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function om(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?tm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):tm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var nm=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,om(om({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 8H32C45.2548 8 56 18.7452 56 32C56 38.6167 50.0207 43 43 43H38C36.2316 43 34 43.3231 34 46C34 48.6266 36 50.28 36 53C36 54.6164 34.7273 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8H32ZM45.5 35C47.9853 35 50 32.9853 50 30.5C50 28.0147 47.9853 26 45.5 26C43.0147 26 41 28.0147 41 30.5V30.4999C41 32.9849 43.0143 34.9995 45.4993 34.9999L45.5 35ZM38.5005 24C40.9858 24 43.0005 21.9853 43.0005 19.5C43.0005 17.0147 40.9858 15 38.5005 15C36.0152 15 34.0005 17.0147 34.0005 19.5V19.4999C34.0005 21.985 36.0149 23.9996 38.5 23.9999L38.5005 24ZM25.5005 24H25.5005C27.9858 24 30.0005 21.9853 30.0005 19.5C30.0005 17.0147 27.9858 15 25.5005 15C23.0152 15 21.0005 17.0147 21.0005 19.5V19.4999C21.0005 21.9849 23.0148 23.9995 25.4998 23.9999L25.5005 24ZM14.0005 30.5C14.0005 32.9853 16.0152 35 18.5005 35C20.9858 35 23.0005 32.9853 23.0005 30.5C23.0005 28.0147 20.9858 26 18.5005 26C16.0152 25.9994 14 28.0136 13.9994 30.4989C13.9994 30.4992 13.9994 30.4995 13.9994 30.4998L14.0005 30.5Z"})}))));function rm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function im(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?rm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):rm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var am=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,im(im({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{d:"M32 42C37.5228 42 42 37.5228 42 32C42 26.4772 37.5228 22 32 22C26.4772 22 22 26.4772 22 32C22 37.5228 26.4772 42 32 42Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]})})))),lm=o(30829),sm=o(9576),cm=o(4794);var dm=e=>{let{onClick:t,debounceDurationMs:o=1e3*cm.jy}=e;const n=(0,a.useRef)(!1);return()=>{n.current||(null===t||void 0===t||t(),n.current=!0,setTimeout((()=>{n.current=!1}),o))}};const pm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandLayout__CommandLayoutContainer",componentId:"azm0su-0"})(["width:100%;height:100%;cursor:",";"],(e=>{let{$pointerCursor:t}=e;return t?"pointer":void 0})),um=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandLayout__CommandLayoutInnerContainer",componentId:"azm0su-1"})(["display:flex;flex-direction:row;align-items:center;position:absolute;inset:2px 0;"]);var mm=e=>{let{onClick:t,children:o}=e;const n=dm({onClick:t});return(0,S.jsx)(pm,{$pointerCursor:!!t,onClick:t?n:void 0,children:(0,S.jsx)(um,{children:o})})},gm=o(23969);const hm=24,fm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__IconContainer",componentId:"sc-1sp1xrd-0"})(["flex-shrink:0;display:flex;align-items:center;justify-content:end;width:","px;"],38),bm=(0,b.ZP)(fm).withConfig({displayName:"CommandTitle__ActionIconContainer",componentId:"sc-1sp1xrd-1"})(["position:absolute;right:","px;opacity:",";"],10,(e=>{let{$mode:t,$isFocusedInRootMode:o}=e;return t===gm.q$.SCOPED||o?1:0})),ym=b.ZP.span.withConfig({displayName:"CommandTitle__FallbackText",componentId:"sc-1sp1xrd-2"})(["color:",";font-weight:500;"],(e=>{let{theme:t}=e;return t.colors.commandPromptControlTextFallback})),Cm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__CommandTitleContainer",componentId:"sc-1sp1xrd-3"})(["line-height:20px;display:flex;align-items:center;width:100%;height:100%;color:",";cursor:",";gap:","px;border-radius:",";background-color:",";&:hover{color:",";}& > "," > svg{width:","px;height:","px;fill:",";}&:hover > "," > svg{fill:",";}"],(e=>{let{theme:t}=e;return t.colors.commandPromptListCommandLabel}),(e=>{let{$mode:t}=e;return t===gm.q$.SCOPED?"pointer":void 0}),12,(e=>{let{$mode:t,$isFocusedInRootMode:o,theme:n}=e;return t===gm.q$.ROOT&&o?n.borderRadius.xs:0}),(e=>{let{$mode:t,$isFocusedInRootMode:o,theme:n}=e;return t===gm.q$.ROOT&&o?n.colors.commandPromptFocusedListItem:"transparent"}),(e=>{let{theme:t,$mode:o}=e;return o===gm.q$.SCOPED?t.colors.commandPromptListCommandLabelHover:t.colors.commandPromptListCommandLabel}),fm,hm,hm,(e=>{let{theme:t}=e;return t.colors.commandPromptListCommandLabel}),fm,(e=>{let{theme:t,$mode:o}=e;return o===gm.q$.SCOPED?t.colors.commandPromptListCommandLabelHover:t.colors.commandPromptListCommandLabel})),vm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__TitleContainer",componentId:"sc-1sp1xrd-4"})([""," font-size:","px;"],Jr.wR,15),xm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__TitleAndTagContainer",componentId:"sc-1sp1xrd-5"})(["display:flex;gap:","px;align-items:center;max-width:calc( 100% - 2 * ","px - ","px - ","px );"],6,38,12,10);let Om;!function(e){e[e.NONE=0]="NONE",e[e.BETA=1]="BETA",e[e.PRO=2]="PRO"}(Om||(Om={}));var Pm=e=>{let{Icon:t,ActionIcon:o,title:n,mode:r,isFocusedInRootMode:i,tag:l,disableTitleAnimations:s=!1,fallbackString:c="",showEllipsis:p=!1,onClick:u}=e;const m=(0,a.useMemo)((()=>(0,d.E)(t)),[t]),g=(0,a.useMemo)((()=>(0,d.E)(o)),[o]),h=r===gm.q$.ROOT,f=r===gm.q$.SCOPED,b={gap:f?"8px":"12px"},y={width:f?"20.808px":"24px",height:f?"20.808px":"24px"},C=f?"none":"auto",v={fontSize:f?"13.004999999999999px":"15px"},x={gap:h?"6px":"4px"},O={opacity:f?0:1,rotate:f?90:0,scale:f?.4166666666666667:1,x:f?6:0},P=p?"...":"",j=c&&h?(0,S.jsxs)(ym,{children:[" ",c]}):null,w=(0,S.jsxs)(S.Fragment,{children:[n,j,P]}),T=dm({onClick:u}),I=(e=>{switch(e){case Om.BETA:return(0,S.jsx)(Nt.Ur,{});case Om.PRO:return(0,S.jsx)(Nt.gQ,{});default:return null}})(l);return(0,S.jsxs)(Cm,{initial:b,animate:b,transition:s?cm.YB:cm.TP,onClick:T||void 0,$mode:r,$isFocusedInRootMode:i,children:[(0,S.jsx)(fm,{style:{pointerEvents:C},children:(0,S.jsx)(m,{transition:s?cm.YB:cm.TP,initial:y,animate:y})}),(0,S.jsxs)(xm,{initial:x,animate:x,transition:s?cm.YB:cm.TP,children:[(0,S.jsx)(vm,{transition:s?cm.YB:cm.TP,initial:v,animate:v,children:w}),I]}),(0,S.jsx)(bm,{$isFocusedInRootMode:i,$mode:r,style:{pointerEvents:C},children:(0,S.jsx)(g,{transition:cm.b4,initial:O,animate:O})})]})},jm=o(96160),wm=o(35062);const Tm=2e3,Im=(0,b.ZP)(d.E.span).withConfig({displayName:"CommandStatus__StatusWrapper",componentId:"sc-1f8dqqu-0"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin-right:48px;color:",";"],(e=>{let{theme:t}=e;return t.colors.commandPromptStatusText})),Em=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandStatus__Background",componentId:"sc-1f8dqqu-1"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;min-width:320px;max-width:max-content;font-size:17px;line-height:26px;height:68px;padding:20px 24px;"]);var _m=e=>{let{content:t,status:o,action:n}=e;const r=o===jm.z.ACTION;return(0,S.jsxs)(Em,{layout:!0,style:{paddingRight:r?12:24},transition:cm.TP,children:[(0,S.jsx)(Im,{layout:"position",children:t}),(o===jm.z.COMPLETE||o===jm.z.PROGRESS)&&(0,S.jsx)(wm.Z,{status:o}),r&&n]})};function Sm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function km(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Sm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Sm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Zm=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,km(km({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 12C32 10.8954 32.8954 10 34 10H46C50.4183 10 54 13.5817 54 18V31C54 35.4183 50.4183 39 46 39H16.8284L24.4142 46.5858C25.1953 47.3668 25.1953 48.6332 24.4142 49.4142C23.6332 50.1953 22.3668 50.1953 21.5858 49.4142L10.5858 38.4142C9.80474 37.6332 9.80474 36.3668 10.5858 35.5858L21.5858 24.5858C22.3668 23.8047 23.6332 23.8047 24.4142 24.5858C25.1953 25.3668 25.1953 26.6332 24.4142 27.4142L16.8284 35H46C48.2091 35 50 33.2091 50 31V18C50 15.7909 48.2091 14 46 14H34C32.8954 14 32 13.1046 32 12Z"})}))));var Dm=e=>{let{subscriptionId:t,onComplete:o,onError:n}=e;return(0,z.s9r)({variables:{subscriptionId:t},onData(e){var t;let{data:r}=e;const i=null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.pdfGenerationStatus;if(i)if("PdfGenerationProgress"===i.__typename){if(i.progressType===z.e1y.Complete)o(i)}else"PdfGenerationError"===i.__typename&&n()}}),(0,S.jsx)(S.Fragment,{})};const Mm=(e,t)=>{let o;switch(e){case jm.z.PROGRESS:o=fc.ZP.t("commandPrompt.exportToPdf.generationProgress");break;case jm.z.COMPLETE:o=fc.ZP.t("commandPrompt.exportToPdf.generationComplete");break;case jm.z.ACTION:case jm.z.NONE:o=t?fc.ZP.t("commandPrompt.exportToPdf.generationError"):""}return o};var Rm={id:Ac.EXPORT_TO_PDF,title:fc.ZP.t("commandPrompt.exportToPdf.commandTitle").toString(),Component:e=>{let{title:t,mode:o,changePromptMode:n,contributeCommandHandler:r,tomeId:i,isFocusedInRootMode:l,onComplete:s,setCommandState:c,generationStatus:d,errorHappened:p,subscriptionId:u,setBlockCommandPromptToggle:m}=e;const{apolloClient:g}=(0,N.bp)(),{priceType:h}=(0,$s.Z)(),f=null===h,b=()=>{c({generationStatus:jm.z.NONE,errorHappened:!0,subscriptionId:void 0}),setTimeout((()=>{s()}),Tm)},y=e=>{(0,mi.L)(!!e,"No downloadUrl provided for create PDF",{tomeId:i}),e&&function(e){const t=document.createElement("a");t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}(e),c({generationStatus:jm.z.COMPLETE,subscriptionId:void 0}),setTimeout((()=>{s()}),Tm)},[C]=(0,z.Rv8)({onError:b}),{openSettings:v}=(0,lc.r)(),x=(0,a.useCallback)((e=>{let{wasDirectlyInvoked:t}=e;if(f)return v(sc.u.PLANS),s(),!0;_a.ZP.reportPdfGeneration({apolloClient:g,initiator:t?_a.RM.TOME_MENU:_a.RM.COMMAND_PROMPT,tomeId:i}),m(!0);const o=ui()();return c({generationStatus:jm.z.PROGRESS,errorHappened:!1,subscriptionId:o}),C({variables:{subscriptionId:o,tomeId:i}}),n(gm.q$.DELEGATE),!0}),[g,n,f,s,v,C,m,c,i]);(0,a.useEffect)((()=>{r(x)}),[r,x]);let O=null;switch(o){case gm.q$.ROOT:O=(0,S.jsx)(mm,{onClick:()=>x({stringValue:"",jsonValue:$u.yS,wasDirectlyInvoked:!1}),children:(0,S.jsx)(Pm,{Icon:pd,ActionIcon:Zm,title:t,mode:o,isFocusedInRootMode:l,tag:f?Om.PRO:Om.NONE})});break;case gm.q$.SCOPED:O=null;break;case gm.q$.DELEGATE:O=(0,S.jsxs)(S.Fragment,{children:[u&&(0,S.jsx)(Dm,{onError:b,onComplete:e=>{const t=e.downloadUrl;y(t)},subscriptionId:u}),(0,S.jsx)(_m,{content:Mm(d??jm.z.NONE,p??!1),status:d??jm.z.NONE})]})}return O},featureFlag:B.TT.PDF_GENERATION};function Am(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Lm(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Am(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Am(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Nm=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Lm(Lm({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M30 24C30 22.8954 30.8954 22 32 22C33.1046 22 34 22.8954 34 24V30H40C41.1046 30 42 30.8954 42 32C42 33.1046 41.1046 34 40 34H34V40C34 41.1046 33.1046 42 32 42C30.8954 42 30 41.1046 30 40V34H24C22.8954 34 22 33.1046 22 32C22 30.8954 22.8954 30 24 30H30V24Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 22C8 17.5817 11.5817 14 16 14H48C52.4183 14 56 17.5817 56 22V42C56 46.4183 52.4183 50 48 50H16C11.5817 50 8 46.4183 8 42V22ZM12 22C12 19.7909 13.7909 18 16 18H48C50.2091 18 52 19.7909 52 22V42C52 44.2091 50.2091 46 48 46H16C13.7909 46 12 44.2091 12 42V22Z"})]}))));const Hm=(0,a.createContext)(null);function Vm(e){let{children:t,value:o}=e;return(0,S.jsx)(Hm.Provider,{value:o,children:t})}function Bm(){const e=(0,a.useContext)(Hm);if(void 0===e)throw new Error("useCommandContext must be used within a CommandContextProvider");return e}var Fm=e=>{let{Icon:t,ActionIcon:o=Zm,commandHandler:n}=e;const{contributeCommandHandler:r,isFocusedInRootMode:i,onComplete:l,title:s,mode:c}=Bm(),d=(0,a.useCallback)((()=>(n(),l(),!0)),[n,l]);return(0,a.useEffect)((()=>{r(d)}),[r,d]),(0,S.jsx)(mm,{onClick:d,children:(0,S.jsx)(Pm,{Icon:t,ActionIcon:o,title:s,mode:c,isFocusedInRootMode:i,tag:Om.NONE})})};var $m={id:Ac.NEW_PAGE,title:"New page",Component:()=>{const e=(0,l.Zl)(H.xi),t=(0,l.Zl)(H.RE),o=(0,a.useCallback)((()=>{e(!0),t(!0)}),[t,e]);return(0,S.jsx)(Fm,{Icon:Nm,commandHandler:o})},keywords:fc.ZP.t("commandPrompt.addPage.keywords",{returnObjects:!0})},Gm=o(8794);function zm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Um(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?zm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):zm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Wm=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,Um(Um({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 13C10.6863 13 8 15.6863 8 19V35C8 38.3137 10.6863 41 14 41H18V45C18 48.3137 20.6863 51 24 51H50C53.3137 51 56 48.3137 56 45V29C56 25.6863 53.3137 23 50 23H46V19C46 15.6863 43.3137 13 40 13H14ZM42 23V19C42 17.8954 41.1046 17 40 17H14C12.8954 17 12 17.8954 12 19V35C12 36.1046 12.8954 37 14 37H18V29C18 25.6863 20.6863 23 24 23H42ZM24 27C22.8954 27 22 27.8954 22 29V45C22 46.1046 22.8954 47 24 47H50C51.1046 47 52 46.1046 52 45V29C52 27.8954 51.1046 27 50 27H24Z"})})))),qm=o(77493),Km=o(94430);var Ym=function(){const{apolloClient:e}=(0,N.bp)();return(0,a.useCallback)((t=>e.readFragment({id:`Tome:${t}`,fragment:z.AKG,fragmentName:"TomeFragment",variables:{fetchFullPage:!0,prefetchPreviewImage:!1}})),[e])};function Jm(e){let{onError:t,onSubscriptionStart:o}=e;const n=Ym(),[r]=(0,z.xIX)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateSinglePage)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(z.EaV.ApiError)}});return(0,l._8)((e=>{let{snapshot:t}=e;return async e=>{var i;let{prompt:a,tomeId:l,imageStyle:s}=e;const c=n(l),d=t.getLoadable(H.Vx).getValue();if(!c)return;const p=(0,V.xh)(c.pages,d),u=null===p?(null===(i=c.pages)||void 0===i?void 0:i.length)||0:p+1,m=(0,eu.pp)(u,c.pages),{tomeTitle:g,pageText:h,pageTitle:f}=function(e){var t,o;let n,r,{tomeTitle:i,page:a}=e;const l=null===a||void 0===a||null===(t=a.tiles)||void 0===t?void 0:t.filter((e=>"TEXT"===e.type))[0];if(l&&null!==(o=l.textTileData)&&void 0!==o&&o.content){const e=JSON.parse(l.textTileData.content),t=e.filter((e=>"heading"===e.type)).sort(((e,t)=>e.level-t.level))[0];try{n=qm.NB.string(t)}catch(s){}try{const t=n||"";r=(0,Km.Q)(e).replace(t,"").slice(0,2e3)}catch(s){}}return{tomeTitle:i===ql.GW?void 0:i,pageText:r,pageTitle:n}}({tomeTitle:c.title,page:c.pages[p??0]}),b=(0,di.Z)();o(b),r({variables:{requestId:b,tomeId:c.id,pageOrder:m,promptContext:{prompt:a,tomeTitle:g,prevPageText:h,prevPageTitle:f},imageStyle:s.getWireImageStyle()}})}}),[n,o,r])}var Xm=o(84562),Qm=o(7289);const eg=(e,t)=>{const o=[{type:"label",text:"Art Style",paddingVertical:5,paddingHorizontal:8}];return Qm.O.getValues().forEach((n=>{n!==Qm.O.NONE&&o.push({type:"option",id:n.getWireImageStyle(),text:n.getMenuText(),action:()=>e(n),checked:t===n,noSelectedBackground:!0})})),o.push({type:"separator"}),o.push({type:"option",id:z.Hnc.None,text:Qm.O.NONE.getMenuText(),action:()=>e(Qm.O.NONE),checked:t===Qm.O.NONE,noSelectedBackground:!0}),o};var tg=o(12164);var og=e=>{let{text:t}=e;return(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:t}),(0,S.jsx)(tg.Z,{})]})};const ng=(0,b.ZP)(pe.Z).attrs({width:"10",height:"10",viewBox:"0 0 10 10"}).withConfig({displayName:"CommandControlDropdown__DropdownArrow",componentId:"maq4tm-0"})(["align-self:middle;display:inline-flex;stroke:currentColor;flex-shrink:0;"]),rg=b.ZP.div.withConfig({displayName:"CommandControlDropdown__Row",componentId:"maq4tm-1"})(["display:flex;flex-direction:row;gap:6px;align-items:center;"]),ig=(0,b.ZP)(qr.Z).withConfig({displayName:"CommandControlDropdown__StyledDropdownMenu",componentId:"maq4tm-2"})(["cursor:pointer;background:",";color:",";border-radius:",";width:100%;flex:0;padding:6px 6px 6px 8px;transition:background 0.2s ease-out,color 0.2s ease-out;&:hover{background:",";color:",";}"],(e=>{let{theme:t}=e;return t.colors.commandPromptControlBackground}),(e=>{let{theme:t,opened:o}=e;return o?t.colors.commandPromptControlTextActive:t.colors.commandPromptControlText}),(e=>{let{theme:t}=e;return t.borderRadius.xs}),(e=>{let{theme:t}=e;return t.colors.commandPromptControlBackgroundHover}),(e=>{let{theme:t,opened:o}=e;return o?t.colors.commandPromptControlTextActive:t.colors.commandPromptControlTextHover})),ag=(0,b.ZP)(ru.fC).withConfig({displayName:"CommandControlDropdown__DropdownClickBlockingOverlay",componentId:"maq4tm-3"})(["position:absolute;inset:0;pointer-events:auto;width:100%;height:100%;"]),lg=b.ZP.div.withConfig({displayName:"CommandControlDropdown__Name",componentId:"maq4tm-4"})(["line-height:14px;font-size:",";text-transform:capitalize;white-space:nowrap;"],(e=>{let{theme:t}=e;return t.fontSizes.sm}));var sg=e=>{let{items:t,activeText:o,width:n,dataTestId:r,focusInput:i}=e;const{0:l,1:s}=(0,a.useState)(!1),c=(0,a.useCallback)((()=>{s(!0)}),[s]),d=(0,a.useCallback)((()=>{s(!1),i()}),[s,i]);return(0,S.jsxs)(S.Fragment,{children:[l&&(0,S.jsx)(ag,{"data-testid":"dropdown_overlay",style:{zIndex:T.bf}}),(0,S.jsx)(ig,{opened:l,onCloseDropdown:d,onOpenDropdown:c,dataTestId:r,menuWidth:n,menuPosition:"above",menuAlign:"left",itemsOrFn:t,styles:{zIndex:T.m6},additionalSpacing:-8,children:(0,S.jsxs)(rg,{children:[(0,S.jsx)(lg,{children:o}),(0,S.jsx)(ng,{})]})})]})};var cg=e=>{let{pageGenerationSubscriptionId:t,setNumPagesGenerated:o,onComplete:n,onError:r,onProgress:i}=e;const a=(0,l.Zl)(H.Vx),s=(0,l.Zl)(H.pt);return(0,z.RlJ)({variables:{requestId:t},onData(e){var t;let{data:l}=e;const c=null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.tomeGenerationStatus;if(c)if("TomeGenerationProgress"===c.__typename)switch(c.progressType){case z.xGj.Started:o(0);break;case z.xGj.InProgress:null===i||void 0===i||i(c),null!==c.numPagesGenerated&&void 0!==c.numPagesGenerated&&o(c.numPagesGenerated),c.currentPageId&&(a(c.currentPageId),(0,H.Dm)(null),s((e=>e.length>0?[]:e)));break;case z.xGj.Complete:n()}else"TomeGenerationError"===c.__typename&&r(c.errorCode)}}),(0,S.jsx)(S.Fragment,{})};var dg=e=>{let{action:t,completionState:o,getStatusContent:n,onError:r,onProgress:i,pageGenerationSubscriptionId:l,onDismiss:s,onGenerationComplete:c}=e;const{0:d,1:p}=(0,a.useState)(jm.z.PROGRESS),{0:u,1:m}=(0,a.useState)(0);return(0,S.jsxs)(S.Fragment,{children:[l&&(0,S.jsx)(cg,{pageGenerationSubscriptionId:l,setNumPagesGenerated:m,onComplete:()=>{c(),p(jm.z.COMPLETE),setTimeout((()=>{m(0),p(o),o===jm.z.NONE&&(null===s||void 0===s||s())}),Tm)},onError:e=>{r(e,u)&&(m(0),p(jm.z.ACTION))},onProgress:i}),(0,S.jsx)(_m,{action:t,content:n({numPagesGenerated:u,status:d}),status:d})]})},pg=o(91279);const ug=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerationStatusRetry__ButtonGroup",componentId:"oclhcm-0"})(["display:flex;flex-direction:row;gap:12px;"]),mg=(0,b.ZP)(He.Z).withConfig({displayName:"GenerationStatusRetry__Button",componentId:"oclhcm-1"})(["height:44px;width:104px;font-size:",";"],(e=>{let{theme:t}=e;return t.fontSizes.smmd}));var gg=e=>{let{backgroundRef:t,onDismiss:o,onRetry:n,shouldEnableOutlineClicks:r}=e;const{outlineRef:i}=(0,N.TR)();(0,a.useEffect)((()=>{const e=e=>{"Escape"!==e.key&&"Enter"!==e.key||o()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[o]);const l=r?[i]:[];return(0,pg.Z)(t,o,{exemptRefs:l}),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(ug,{initial:{opacity:0},animate:{opacity:1},transition:cm.TP,children:[(0,S.jsx)(mg,{onClick:n,children:"Try Again"}),(0,S.jsx)(mg,{onClick:o,children:"Keep"})]})})};function hg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function fg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var bg=(0,a.forwardRef)(((e,t)=>(0,S.jsx)(we.Z,fg(fg({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.4276 48.4568C27.6464 49.239 26.379 49.2398 25.5969 48.4585C24.8147 47.6773 24.814 46.41 25.5952 45.6278L39.2016 32.0378L25.5952 18.4478C24.814 17.6657 24.8147 16.3984 25.5969 15.6171C26.379 14.8359 27.6464 14.8367 28.4276 15.6188L43.45 30.6233C44.2312 31.403 44.2325 32.6683 43.4529 33.4495C43.4519 33.4505 43.451 33.4515 43.45 33.4524L28.4276 48.4568Z"})}))));const yg=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandControls__CommandControlsGroup",componentId:"sc-1cd38sw-0"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:12px;padding-right:6px;"]);var Cg=e=>{let{children:t}=e;return(0,S.jsx)(yg,{initial:{opacity:0},animate:{opacity:1},transition:cm.TP,children:t})};var vg=e=>{let{Icon:t,scopedModeControls:o,commandHandler:n,confirmExitScoped:r=!1,isBetaCommand:i=!1}=e;const{contributeCommandHandler:l,changePromptMode:s,isFocusedInRootMode:c,clearInput:d,clearCommandState:p,inputJSON:u,inputString:m,disableTitleAnimations:g,title:h,mode:f,fallbackString:b}=Bm(),C=null!=b&&b.length>0,v=m.length>0,O=(0,x.s)(),{t:P}=(0,y.$G)(),j=(0,a.useCallback)((()=>{switch(f){case gm.q$.ROOT:d(),s(gm.q$.SCOPED);break;case gm.q$.SCOPED:r&&v?O.open():(p(),s(gm.q$.ROOT))}}),[s,d,p,f,v,r,O]),w=(0,a.useCallback)((e=>{switch(f){case gm.q$.ROOT:C?n(e):j();break;case gm.q$.SCOPED:n(e)}return!0}),[n,C,f,j]);(0,a.useEffect)((()=>{l(w)}),[l,w]);const T=f===gm.q$.ROOT,I=f===gm.q$.SCOPED,E=C?Zm:bg;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(mm,{onClick:T?()=>{w({stringValue:m,jsonValue:u,wasDirectlyInvoked:!1})}:void 0,children:[(0,S.jsx)(Pm,{Icon:t,ActionIcon:E,title:h,mode:f,isFocusedInRootMode:c,onClick:I?j:void 0,fallbackString:b,disableTitleAnimations:g,tag:i?Om.BETA:Om.NONE,showEllipsis:!0}),I&&(0,S.jsx)(Cg,{children:o})]}),r&&(0,S.jsx)(x.Z,{ref:O.ref,title:P("commandPrompt.confirmExitScopedModeModal.title"),subtitle:P("commandPrompt.confirmExitScopedModeModal.subtitle"),primaryButtonContent:P("commandPrompt.confirmExitScopedModeModal.confirmButton"),primaryButtonAction:()=>{p(),s(gm.q$.ROOT),O.close()},cancelButtonText:P("cancel"),cancelButtonAction:()=>{O.close()},buttonColor:"destructive",dismissible:!0})]})};var xg=e=>{let{Icon:t,onError:o,onProgress:n,onRetry:r,pageGenerationSubscriptionId:i,onGenerationComplete:a,commandHandler:l,scopedModeControls:s,getStatusContent:c,confirmExitScoped:d,isBetaCommand:p}=e;const{mode:u,promptBackgroundRef:m,onComplete:g}=Bm();switch(u){case gm.q$.DELEGATE:return(0,S.jsx)(dg,{action:(0,S.jsx)(gg,{onDismiss:g,onRetry:r,backgroundRef:m,shouldEnableOutlineClicks:!0}),completionState:jm.z.ACTION,getStatusContent:c,onGenerationComplete:a,onError:o,onProgress:n,pageGenerationSubscriptionId:i,"data-testid":"generative_command_generation_status"});case gm.q$.ROOT:case gm.q$.SCOPED:default:return(0,S.jsx)(vg,{Icon:t,commandHandler:l,scopedModeControls:s,confirmExitScoped:d,isBetaCommand:p})}};function Og(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}var Pg=function(e){let{pageIdsToClearOnRetry:t,setCommandState:o,creditsOperation:n,clearTomeOptions:i}=e;const{changePromptMode:s,resetCommandPromptAfterClose:c,setErrorCode:d,setShowOverlayAndBlockKeys:p,tomeId:u}=Bm(),{displayInsufficientCredits:m,attemptToPerformCreditsOperation:g}=(0,Je.KW)(),h=(t??[]).length>0,f=(0,a.useCallback)((e=>{o({pageGenerationSubscriptionId:e})}),[o]),b=(0,a.useCallback)((e=>{o({pageIdsToClearOnRetry:e})}),[o]),y=(0,a.useCallback)((e=>{f(e),d(null)}),[f,d]),C=(0,a.useCallback)((e=>{if(f(void 0),e===z.EaV.InsufficientCredit)m();else{const t=(e=>{switch(e){case z.EaV.ModerationFlagged:return gm.BO.OUT_OF_MODERATION_ERROR;case z.EaV.OpenAiOutage:case z.EaV.RateLimit:return gm.BO.RATE_LIMIT_ERROR;case z.EaV.ApiError:default:return gm.BO.GENERIC_ERROR}})(e);d(t)}return p(!1),s(gm.q$.SCOPED),!0}),[f,d,p,s,m]),v=(0,a.useCallback)((e=>{const{currentPageId:o}=e;null!=o&&b([...t??[],o])}),[t,b]),x=function(){const{apolloClient:e,clientId:t}=(0,N.bp)(),o=Ym(),n=(0,l.Zl)(H.Vx),r=(0,l.Zl)(H.pt);return(0,a.useCallback)(((i,a)=>{const l=o(i);l&&!(0,ql.$Q)(l)&&(0,V.Gi)(l,(null===a||void 0===a?void 0:a.pageIdsToDelete)??l.pages.map((e=>e.id)),e,t,r,n,!1,null===a||void 0===a?void 0:a.shouldDecrementSelectedPageIndex)}),[e,t,o,n,r])}(),O=(0,No.Z)((e=>o=>g(n,(()=>{h&&(x(u,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Og(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Og(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({pageIdsToDelete:t},i)),b([])),e(o)&&(p(!0),s(gm.q$.DELEGATE))}))),[g,n,h,p,s,x,t,i,b,u]);return{onError:C,onProgress:v,onRetry:(0,a.useCallback)((()=>{f(void 0),s(gm.q$.SCOPED)}),[s,f]),onSubscriptionStart:y,onGenerationComplete:(0,a.useCallback)((()=>{c(),p(!1)}),[c,p]),makeCommandHandler:O}};const jg=500,wg={id:Ac.AUTOTOME,title:fc.ZP.t("commandPrompt.autotome.commandTitle"),placeholder:fc.ZP.t("commandPrompt.autotome.commandPlaceholder"),contentDependency:Dc.EMPTY,Component:e=>{let{focusInput:t,tomeId:o,setCommandState:n,imageStyle:r,artifactType:i,pageGenerationSubscriptionId:l,pageIdsToClearOnRetry:s}=e;const{priceType:c}=(0,$s.Z)(),d=(0,a.useCallback)((e=>{n({imageStyle:e})}),[n]),p=(0,a.useCallback)((e=>{n({artifactType:e})}),[n]),{onError:u,onProgress:m,onRetry:g,onSubscriptionStart:h,onGenerationComplete:f,makeCommandHandler:b}=Pg({pageIdsToClearOnRetry:s,setCommandState:n,creditsOperation:Je.Cw.AUTO_TOME}),y=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||u(e,t)}),[u]),C=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,z.glU)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomePages)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(z.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{artifactType:t,inputPrompt:r,imageStyle:i,tomeId:a}=e;const l=(0,di.Z)();o(l),n({variables:{requestId:l,artifactType:t.getWireArtifactType(),inputPrompt:r,imageStyle:i.getWireImageStyle(),tomeId:a}})}),[n,o])}({onError:y,onSubscriptionStart:h}),v=b((0,a.useCallback)((e=>(C({artifactType:i,imageStyle:r,inputPrompt:e.stringValue,tomeId:o}),!0)),[o,C,i,r])),x=(0,a.useMemo)((()=>((e,t)=>{const o=[];return Xm.q.getValues().forEach((n=>o.push({type:"option",id:n.getWireArtifactType(),text:n.getTextTitleCase(),action:()=>e(n),checked:t===n,noSelectedBackground:!0}))),o})(p,i)),[p,i]),O=(0,a.useMemo)((()=>eg(d,r)),[d,r]),P=((e,t)=>o=>{let{numPagesGenerated:n,status:r}=o;switch(r){case jm.z.PROGRESS:return n<2?fc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:e.getText()}):fc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:n+1,context:"pageIndex"});case jm.z.COMPLETE:case jm.z.ACTION:{const o=fc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,Gm.Z)(e.getText())});return t?(0,S.jsx)(og,{text:o}):o}default:return""}})(i,null===c);return(0,S.jsx)(xg,{Icon:Wm,getStatusContent:P,pageGenerationSubscriptionId:l,commandHandler:v,onError:y,onGenerationComplete:f,onProgress:m,onRetry:g,scopedModeControls:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(sg,{dataTestId:"artifact_type",items:x,activeText:i.getText(),width:130,focusInput:t}),(0,S.jsx)(sg,{dataTestId:"image_style",items:O,activeText:r.getActiveText(),width:164,focusInput:t})]})})},hasFallbackMode(e){let{input:t}=e;return t.length<jg},keywords:fc.ZP.t("commandPrompt.autotome.keywords",{returnObjects:!0})};var Tg=wg;function Ig(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Eg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ig(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ig(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var _g=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Eg(Eg({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("circle",{cx:"21",cy:"23",r:"4"}),(0,S.jsx)("circle",{cx:"42.8181",cy:"23",r:"4"}),(0,S.jsx)("circle",{cx:"21",cy:"41.9091",r:"4"}),(0,S.jsx)("circle",{cx:"42.8181",cy:"41.9091",r:"4"})]}))));const Sg=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__Container",componentId:"c0gtwf-0"})(["padding:16px;width:","px;"],cm.Wu),kg=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__EditorFields",componentId:"c0gtwf-1"})(["display:flex;flex-direction:column;width:100%;height:","px;"],454),Zg=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__Title",componentId:"c0gtwf-2"})(["box-sizing:content-box;background-color:",";border-radius:",";height:48px;padding:12px;margin-bottom:8px;font-size:19px;"],(e=>{let{theme:t}=e;return t.colors.outlineEditorFieldBackgroundColor}),(e=>{let{theme:t}=e;return t.borderRadius.sm})),Dg=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__OutlineItemNumberLabel",componentId:"c0gtwf-3"})(["color:",";font-size:",";width:28px;text-align:center;"],(e=>{let{theme:t}=e;return t.colors.numberTextColor}),(e=>{let{theme:t}=e;return t.fontSizes.xxs})),Mg=b.ZP.li.withConfig({displayName:"GenerativeOutlineEditor__OutlineItem",componentId:"c0gtwf-4"})(["background-color:",";border-radius:",";display:flex;align-items:center;padding:2px 0;"],(e=>{let{theme:t}=e;return t.colors.outlineEditorFieldBackgroundColor}),(e=>{let{theme:t}=e;return t.borderRadius.sm})),Rg=b.ZP.ol.withConfig({displayName:"GenerativeOutlineEditor__OutlineList",componentId:"c0gtwf-5"})(["display:flex;flex-direction:column;gap:8px;list-style:none;padding:0;margin:0;"]),Ag=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__BottomBar",componentId:"c0gtwf-6"})(["display:flex;justify-content:flex-end;width:100%;"]),Lg=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__OutlineDraggableHandleWrapper",componentId:"c0gtwf-7"})(["width:","px;height:","px;display:flex;justify-content:center;align-items:center;margin-left:auto;"],38,38),Ng=(0,b.ZP)(_g).withConfig({displayName:"GenerativeOutlineEditor__OutlineDraggableHandle",componentId:"c0gtwf-8"})(["width:","px;height:","px;fill:",";"],22,22,(e=>{let{theme:t}=e;return t.colors.outlineContentDraggableHandleColor}));function Hg(e){let{onSubmit:t,outlineContent:o,tomeTitle:n}=e;const{t:r}=(0,y.$G)(),i=null!=o&&o.some((e=>{let{pageTitle:t}=e;return t&&t.length>0})),a=null!=n&&n.length>0&&i;return(0,S.jsxs)(Sg,{children:[(0,S.jsxs)(kg,{children:[(0,S.jsx)(Zg,{children:n}),(0,S.jsx)(Rg,{children:null===o||void 0===o?void 0:o.map(((e,t)=>{let{id:o,pageTitle:n}=e;return(0,S.jsxs)(Mg,{children:[(0,S.jsx)(Dg,{children:t+1}),n,(0,S.jsx)(Lg,{children:(0,S.jsx)(Ng,{})})]},o)}))})]}),(0,S.jsx)(Ag,{children:(0,S.jsx)(He.Z,{color:"primary",disabled:!a,onClick:t,children:r("commandPrompt.outlineEditor.submitButton")})})]})}const Vg=["id"];function Bg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Fg(e){return e.map((e=>function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Bg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Bg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({id:(0,di.Z)()},e)))}const $g={id:Ac.AUTOTOME_V2,title:"[DEV] "+fc.ZP.t("commandPrompt.autotome.commandTitle"),featureFlag:B.TT.AUTOTOME_V2,placeholder:fc.ZP.t("commandPrompt.autotome.commandPlaceholder"),contentDependency:Dc.EMPTY,Component:e=>{let{tomeId:t,inputString:o,setCommandState:n,pageGenerationSubscriptionId:r,pageIdsToClearOnRetry:l,mode:s,promptBackgroundRef:c,onComplete:d,outlineContent:p,staticGenerateTomeFromOutlineParams:u,tomeTitle:m}=e;const{priceType:g}=(0,$s.Z)(),{onError:h,onProgress:f,onRetry:b,onSubscriptionStart:y,onGenerationComplete:C,makeCommandHandler:v}=Pg({pageIdsToClearOnRetry:l,setCommandState:n,creditsOperation:Je.Cw.AUTO_TOME}),x=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||h(e,t)}),[h]),O=function(e){let{onError:t,onComplete:o}=e;const[n]=(0,z.HXg)({onCompleted:e=>{var n;switch(null===(n=e.generateOutline)||void 0===n?void 0:n.__typename){case"GenerateOutlineSuccessResponse":o(e.generateOutline);break;case"GenerateOutlineError":{const o=e.generateOutline.errorCode;t(o||z.EaV.ApiError);break}default:t(z.EaV.ApiError)}},onError:()=>{t(z.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{inputPrompt:t,tomeId:o}=e;return n({variables:{inputPrompt:t,tomeId:o}})}),[n])}({onError:x,onComplete:(0,a.useCallback)((e=>{const t=Fg(e.outlineContent);n({outlineContent:t,staticGenerateTomeFromOutlineParams:{desiredArtStyleType:e.detectedArtStyle,desiredLanguage:e.detectedLanguage,operationId:e.operationId},tomeTitle:e.tomeTitle})}),[n])}),P=v((0,a.useCallback)((e=>(O({inputPrompt:e.stringValue,tomeId:t}),!0)),[t,O])),j=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,z.GdE)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomeFromOutline)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(z.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{operationId:t,tomeId:r,tomeTitle:i,inputPrompt:a,desiredLanguage:l,desiredArtStyleType:s,outlineContent:c}=e;const d=(0,di.Z)();o(d),n({variables:{operationId:t,progressSubscriptionId:d,tomeId:r,tomeTitle:i,inputPrompt:a,desiredLanguage:l,desiredArtStyleType:s,outlineContent:c}})}),[n,o])}({onError:x,onSubscriptionStart:y}),w=(0,a.useCallback)((()=>{if(!u||!p||!m)return;const{desiredArtStyleType:e,desiredLanguage:n,operationId:r}=u,a=p.map((e=>{let{id:t}=e;return(0,i.Z)(e,Vg)}));j({desiredArtStyleType:e,desiredLanguage:n,operationId:r,tomeId:t,tomeTitle:m,inputPrompt:o,outlineContent:a})}),[u,p,m,j,t,o]),T=(I=Xm.q.PRESENTATION,E=null===g,e=>{let{numPagesGenerated:t,status:o}=e;switch(o){case jm.z.PROGRESS:return t<2?fc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:I.getText()}):fc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:t+1,context:"pageIndex"});case jm.z.COMPLETE:case jm.z.ACTION:{const e=fc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,Gm.Z)(I.getText())});return E?(0,S.jsx)(og,{text:e}):e}default:return""}});var I,E;switch(s){case gm.q$.DELEGATE:return r?(0,S.jsx)(dg,{action:(0,S.jsx)(gg,{onDismiss:d,onRetry:b,backgroundRef:c,shouldEnableOutlineClicks:!0}),completionState:jm.z.ACTION,getStatusContent:T,onGenerationComplete:C,onError:x,onProgress:f,pageGenerationSubscriptionId:r,"data-testid":"generative_command_generation_status"}):(0,S.jsx)(Hg,{onSubmit:w,outlineContent:p,tomeTitle:m});case gm.q$.ROOT:case gm.q$.SCOPED:default:return(0,S.jsx)(vg,{Icon:Wm,commandHandler:P})}},hasFallbackMode(e){let{input:t}=e;return t.length<jg},keywords:fc.ZP.t("commandPrompt.autotome.keywords",{returnObjects:!0})};var Gg=$g;function zg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ug(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?zg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):zg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Wg=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Ug(Ug({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M18 26C16.8954 26 16 26.8954 16 28C16 29.1046 16.8954 30 18 30H30C31.1046 30 32 29.1046 32 28C32 26.8954 31.1046 26 30 26H18Z"}),(0,S.jsx)("path",{d:"M16 36C16 34.8954 16.8954 34 18 34H26C27.1046 34 28 34.8954 28 36C28 37.1046 27.1046 38 26 38H18C16.8954 38 16 37.1046 16 36Z"}),(0,S.jsx)("path",{d:"M38 24C36.8954 24 36 24.8954 36 26V38C36 39.1046 36.8954 40 38 40H46C47.1046 40 48 39.1046 48 38V26C48 24.8954 47.1046 24 46 24H38Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 50C11.5817 50 8 46.4183 8 42V22C8 17.5817 11.5817 14 16 14H48C52.4183 14 56 17.5817 56 22V42C56 46.4183 52.4183 50 48 50H16ZM16 46C13.7909 46 12 44.2091 12 42V22C12 19.7909 13.7909 18 16 18H48C50.2091 18 52 19.7909 52 22V42C52 44.2091 50.2091 46 48 46H16Z"})]}))));var qg={id:Ac.CREATE_PAGE,title:fc.ZP.t("commandPrompt.createPage.commandTitle"),placeholder:fc.ZP.t("commandPrompt.createPage.commandPlaceholder"),contentDependency:Dc.ALWAYS,Component:e=>{let{tomeId:t,setCommandState:o,pageGenerationSubscriptionId:n,imageStyle:r,focusInput:i,pageIdsToClearOnRetry:l}=e;const{onError:s,onProgress:c,onRetry:d,onSubscriptionStart:p,onGenerationComplete:u,makeCommandHandler:m}=Pg({pageIdsToClearOnRetry:l,setCommandState:o,creditsOperation:Je.Cw.TOME_PAGE,clearTomeOptions:{shouldDecrementSelectedPageIndex:!0}}),{priceType:g}=(0,$s.Z)(),h=Jm({onSubscriptionStart:p,onError:s}),f=m((0,a.useCallback)((e=>{let{stringValue:o}=e;return h({prompt:o,tomeId:t,imageStyle:r}),!0}),[h,t,r])),b=(0,a.useCallback)((e=>{o({imageStyle:e})}),[o]),y=(0,a.useMemo)((()=>eg(b,r)),[b,r]),C=(e=>{let{shouldShowBalance:t}=e;return e=>{let{status:o}=e;switch(o){case jm.z.PROGRESS:return fc.ZP.t("commandPrompt.createPage.generationProgress");case jm.z.COMPLETE:case jm.z.ACTION:return t?(0,S.jsx)(og,{text:fc.ZP.t("commandPrompt.createPage.generationComplete")}):fc.ZP.t("commandPrompt.createPage.generationComplete");default:return""}}})({shouldShowBalance:null===g});return(0,S.jsx)(xg,{Icon:Wg,getStatusContent:C,pageIdsToClearOnRetry:l,pageGenerationSubscriptionId:n,commandHandler:f,onError:s,onGenerationComplete:u,onProgress:c,onRetry:d,scopedModeControls:(0,S.jsx)(sg,{dataTestId:"image_style",items:y,activeText:r.getActiveText(),width:164,focusInput:i})})},hasFallbackMode(e){let{input:t}=e;return t.length<jg},keywords:fc.ZP.t("commandPrompt.createPage.keywords",{returnObjects:!0})};function Kg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Yg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Kg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Kg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Jg=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,Yg(Yg({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M24 20C22.8954 20 22 20.8954 22 22C22 23.1046 22.8954 24 24 24H40C41.1046 24 42 23.1046 42 22C42 20.8954 41.1046 20 40 20H24Z"}),(0,S.jsx)("path",{d:"M22 30C22 28.8954 22.8954 28 24 28H40C41.1046 28 42 28.8954 42 30C42 31.1046 41.1046 32 40 32H24C22.8954 32 22 31.1046 22 30Z"}),(0,S.jsx)("path",{d:"M24 36C22.8954 36 22 36.8954 22 38C22 39.1046 22.8954 40 24 40H32C33.1046 40 34 39.1046 34 38C34 36.8954 33.1046 36 32 36H24Z"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 8C17.5817 8 14 11.5817 14 16V48C14 52.4183 17.5817 56 22 56H42C46.4183 56 50 52.4183 50 48V16C50 11.5817 46.4183 8 42 8H22ZM22 12C19.7909 12 18 13.7909 18 16V48C18 50.2091 19.7909 52 22 52H42C44.2091 52 46 50.2091 46 48V16C46 13.7909 44.2091 12 42 12H22Z"})]}))));var Xg=e=>{let{dataTestId:t,onClick:o,children:n,disabled:r}=e;return(0,S.jsx)(He.Z,{"data-testid":t,onClick:o,color:"primary",size:"small",disabled:r,children:n})};var Qg=e=>{let{children:t,disabled:o}=e;const{t:n}=(0,y.$G)();return(0,S.jsx)(st.Z,{content:n("commandPrompt.docToTome.characterLimitNotReached",{min_chars_limit:jg}),placement:"top",delay:0,tooltipDisabled:o,children:(0,S.jsx)("div",{children:t})})};var eh={id:Ac.DOC_TO_TOME,title:fc.ZP.t("commandPrompt.docToTome.commandTitle"),placeholder:fc.ZP.t("commandPrompt.docToTome.commandPlaceholder"),Component:e=>{let{changePromptMode:t,tomeId:o,imageStyle:n,artifactType:r,pageGenerationSubscriptionId:i,setCommandState:l,pageIdsToClearOnRetry:s,inputString:c,inputJSON:d}=e;const{onError:p,onProgress:u,onRetry:m,onSubscriptionStart:g,onGenerationComplete:h,makeCommandHandler:f}=Pg({pageIdsToClearOnRetry:s,setCommandState:l,creditsOperation:Je.Cw.DOC_TO_TOME}),{priceType:b}=(0,$s.Z)(),y=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,z.c_h)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomePagesFromDocument)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(z.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{artifactType:t,prompt:r,imageStyle:i,tomeId:a}=e;const l=(0,di.Z)();o(l),n({variables:{artifactType:t.getWireArtifactType(),prompt:r,imageStyle:i.getWireImageStyle(),tomeId:a,requestId:l}})}),[n,o])}({onSubscriptionStart:g,onError:p}),C=c.length<jg,v=f((0,a.useCallback)((e=>{let{jsonValue:i,stringValue:a}=e;return a.length>=jg&&(t(gm.q$.DELEGATE),y({artifactType:r,prompt:JSON.stringify(i),imageStyle:n,tomeId:o}),!0)}),[r,t,y,n,o])),x=(0,a.useCallback)((()=>{v({jsonValue:d,stringValue:c,wasDirectlyInvoked:!1})}),[d,c,v]),O=(e=>{let{shouldShowBalance:t}=e;return e=>{let{numPagesGenerated:o,status:n}=e;switch(n){case jm.z.PROGRESS:return o<2?fc.ZP.t("commandPrompt.docToTome.generationProgress"):fc.ZP.t("commandPrompt.docToTome.generationProgress",{pageIndex:o+1,context:"pageIndex"});case jm.z.COMPLETE:case jm.z.ACTION:{const e=fc.ZP.t("commandPrompt.docToTome.generationComplete");return t?(0,S.jsx)(og,{text:e}):e}default:return""}}})({shouldShowBalance:null===b});return(0,S.jsx)(xg,{Icon:Jg,getStatusContent:O,pageIdsToClearOnRetry:s,pageGenerationSubscriptionId:i,commandHandler:v,onError:p,onGenerationComplete:h,onProgress:u,onRetry:m,confirmExitScoped:!0,isBetaCommand:!0,scopedModeControls:(0,S.jsx)(Qg,{disabled:!C,children:(0,S.jsx)(Xg,{dataTestId:"generate",onClick:x,disabled:C,children:"Generate"})})})},hasFallbackMode(e){let{input:t}=e;return t.length>=jg},contentDependency:Dc.EMPTY,featureFlag:B.TT.DOC_TO_TOME,keywords:fc.ZP.t("commandPrompt.docToTome.keywords",{returnObjects:!0})};const th={id:Ac.YOUTUBE_TO_TOME,title:fc.ZP.t("commandPrompt.youtubeToTome.commandTitle"),placeholder:fc.ZP.t("commandPrompt.youtubeToTome.commandPlaceholder"),contentDependency:Dc.EMPTY,Component:e=>{let{tomeId:t,setCommandState:o,artifactType:n,pageGenerationSubscriptionId:r,pageIdsToClearOnRetry:i}=e;const{priceType:l}=(0,$s.Z)(),{onError:s,onProgress:c,onRetry:d,onSubscriptionStart:p,onGenerationComplete:u,makeCommandHandler:m}=Pg({pageIdsToClearOnRetry:i,setCommandState:o,creditsOperation:Je.Cw.AUTO_TOME}),g=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||s(e,t)}),[s]),h=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,z.zi1)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.experimentalGenerateYoutubeToTomePages)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(z.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{youtubeUrl:t,tomeId:r}=e;const i=(0,di.Z)();o(i),n({variables:{requestId:i,youtubeUrl:t,tomeId:r}})}),[n,o])}({onError:g,onSubscriptionStart:p}),f=m((0,a.useCallback)((e=>(h({youtubeUrl:e.stringValue,tomeId:t}),!0)),[h,t])),b=((e,t)=>o=>{let{numPagesGenerated:n,status:r}=o;switch(r){case jm.z.PROGRESS:return n<2?fc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:e.getText()}):fc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:n+1,context:"pageIndex"});case jm.z.COMPLETE:case jm.z.ACTION:{const o=fc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,Gm.Z)(e.getText())});return t?(0,S.jsx)(og,{text:o}):o}default:return""}})(n,null===l);return(0,S.jsx)(xg,{Icon:Wm,getStatusContent:b,pageGenerationSubscriptionId:r,commandHandler:f,onError:g,onGenerationComplete:u,onProgress:c,onRetry:d})},keywords:fc.ZP.t("commandPrompt.youtubeToTome.keywords",{returnObjects:!0}),featureFlag:B.TT.YOUTUBE_TO_TOME};var oh=th;function nh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function rh(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?nh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):nh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ih=(0,a.forwardRef)(((e,t)=>(0,S.jsxs)(we.Z,rh(rh({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,S.jsx)("path",{d:"M33.4142 8.58579C32.6332 7.80474 31.3668 7.80474 30.5858 8.58579L24.5858 14.5858C23.8047 15.3668 23.8047 16.6332 24.5858 17.4142C25.3668 18.1953 26.6332 18.1953 27.4142 17.4142L30 14.8284V34C30 35.1046 30.8954 36 32 36C33.1046 36 34 35.1046 34 34V14.8284L36.5858 17.4142C37.3668 18.1953 38.6332 18.1953 39.4142 17.4142C40.1953 16.6332 40.1953 15.3668 39.4142 14.5858L33.4142 8.58579Z"}),(0,S.jsx)("path",{d:"M22 22C17.5817 22 14 25.5817 14 30V46C14 50.4183 17.5817 54 22 54H42C46.4183 54 50 50.4183 50 46V30C50 25.5817 46.4183 22 42 22H40C38.8954 22 38 22.8954 38 24C38 25.1046 38.8954 26 40 26H42C44.2091 26 46 27.7909 46 30V46C46 48.2091 44.2091 50 42 50H22C19.7909 50 18 48.2091 18 46V30C18 27.7909 19.7909 26 22 26H24C25.1046 26 26 25.1046 26 24C26 22.8954 25.1046 22 24 22H22Z"})]}))));var ah={id:Ac.COPY_LINK,title:fc.ZP.t("commandPrompt.copyLink.commandTitle"),Component:e=>{let{tomeId:t}=e;const{t:o}=(0,y.$G)(),n=Ym(),r=(0,a.useCallback)((()=>{var e;const r=null===(e=n(t))||void 0===e?void 0:e.canonicalUrl;if(r)try{rs(r),(0,H.ak)({message:o("commandPrompt.copyLink.toastTextSuccess")})}catch{(0,H.ak)({message:o("commandPrompt.copyLink.toastTextFailure")})}}),[n,o,t]);return(0,S.jsx)(Fm,{Icon:ih,commandHandler:r})},keywords:fc.ZP.t("commandPrompt.copyLink.keywords",{returnObjects:!0})};var lh={id:Ac.RENAME_TOME,title:fc.ZP.t("commandPrompt.renameTome.commandTitle"),Component:()=>{const{focusOnTitle:e}=Fs();return(0,S.jsx)(Fm,{Icon:td,commandHandler:e})},keywords:fc.ZP.t("commandPrompt.renameTome.keywords",{returnObjects:!0})};const sh=fc.ZP.t("commandPrompt.tiles.keywords",{returnObjects:!0});var ch=e=>{let{id:t,icon:o,title:n,tileType:r,keywords:i=[],additionalTileData:l={},afterAddTileAction:s=nr.B.NONE,featureFlag:c}=e;const d=q.qj.includes(r);return{id:t,title:n,Component:e=>{let{tomeId:t}=e;const n=ar({tomeId:t,shouldFocusInput:d,shouldSetPropertyPanel:!1}),i=(0,a.useCallback)((()=>{n({tileType:r,additionalTileData:l,afterAddTileAction:s})}),[n]);return(0,S.jsx)(Fm,{Icon:o,commandHandler:i})},keywords:i.concat(sh),featureFlag:c}};var dh=function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const i=()=>{const e=(0,E.t2)(),o=(0,a.useCallback)((()=>{e.setPropertyPanel(n)}),[e]);return(0,S.jsx)(Fm,{Icon:t,commandHandler:o})};return{id:e,title:o,Component:i,keywords:r}},ph=o(44196);const uh=fc.ZP.t("commandPrompt.help.keywords",{returnObjects:!0});var mh=function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const i=()=>{const e=(0,a.useCallback)((()=>{window.open(n,"_blank")}),[]);return(0,S.jsx)(Fm,{ActionIcon:ph.Z,Icon:t,commandHandler:e})};return{id:e,title:o,Component:i,keywords:r.concat(uh)}};var gh={id:Ac.SHARE,title:fc.ZP.t("commandPrompt.share.commandTitle"),Component:()=>{const e=(0,l.Zl)(H.B8),t=(0,a.useCallback)((()=>{e(!0)}),[e]);return(0,S.jsx)(Fm,{Icon:ih,commandHandler:t})},keywords:fc.ZP.t("commandPrompt.share.keywords",{returnObjects:!0})};var hh={id:Ac.CHAT,title:fc.ZP.t("commandPrompt.help.chat.commandTitle"),Component:()=>{const e=(0,a.useCallback)((()=>{var e,t;null===(e=(t=window).Intercom)||void 0===e||e.call(t,"show")}),[]);return(0,S.jsx)(Fm,{Icon:xc.Z,commandHandler:e})},keywords:fc.ZP.t("commandPrompt.help.chat.keywords",{returnObjects:!0})};const fh=new Set(fc.ZP.t("commandPrompt.tokenization.stopWords",{returnObjects:!0})),bh=fc.ZP.t("commandPrompt.tokenization.separator"),yh=1.875;class Ch{constructor(e){this.userContext=e,(0,r.Z)(this,"values",[])}register(e){let{id:t,title:o,placeholder:n,Component:r,hasFallbackMode:i,contentDependency:a,keywords:l,featureFlag:s,userContextFilter:c}=e;this.values.push(new Rc(t,o,n,r,i,a,l,s,c))}getCommandById(e){return this.values.find((t=>t.id===e))??null}getFlagVisibility(e){var t;return!e.featureFlag||!0===(null===(t=this.userContext.flags)||void 0===t?void 0:t[e.featureFlag])}getUserContextVisibility(e){return!e.userContextFilter||e.userContextFilter(this.userContext)}getVisibility(e){return this.getFlagVisibility(e)&&this.getUserContextVisibility(e)}visibleCommands(){return this.values.filter((e=>this.getVisibility(e)))}getMatchingCommands(e){let{isEmptyTome:t,query:o="",selectedCommandId:n}=e;const r=o.trim().split(bh),i=r.filter((e=>!fh.has(e))).join(bh);let a=this.visibleCommands().map((e=>({command:e,matchScore:e.score(i)})));i.length>0&&(a=a.filter((e=>{return e.matchScore.type!==Mc.NONE||e.command.id===n||(t=e.command.hasFallbackMode,r={input:o},"function"===typeof t?t(r):t);var t,r})));let l;const s=a.map((e=>{const o=e.matchScore.type===Mc.TITLE?15*e.matchScore.score:12*e.matchScore.score,n=t&&e.command.contentDependency===Dc.EMPTY||!t&&e.command.contentDependency===Dc.DIRTY,r=t&&e.command.contentDependency===Dc.DIRTY||!t&&e.command.contentDependency===Dc.EMPTY;let i=0;return n?i=yh:r&&(i=-1.875),!r&&e.command.hasFallbackMode&&(i+=.9375),{command:e.command,rankingScore:o+i}})).map((e=>{if(!e.command.hasFallbackMode||!i)return e;const{fallbackString:t,prefixScore:o}=Ch.calculateFallbackString(e.command,r);let n=0;return o>0&&(n=3.75),(void 0===l||t.length<l.length)&&(l=t),{command:e.command,rankingScore:e.rankingScore+n}}));let c=s;const d=s.every((e=>e.command.hasFallbackMode)),p=i.lastIndexOf(l??"");if(d&&-1!==p){const e=i.slice(0,p).trim(),t=s.filter((t=>{const o=t.command.score(e);return o.type===Mc.TITLE&&o.score>.1}));t.length>0&&(c=t)}return c.sort(((e,t)=>t.rankingScore-e.rankingScore)).map((e=>({command:e.command,fallbackString:e.command.hasFallbackMode?l:void 0})))}static calculateFallbackString(e,t){let o,n=0,r=0;for(o=0;o<t.length;o++){if(fh.has(t[o])){r+=1;continue}const i=t.slice(0,o+1).filter((e=>!fh.has(e))).join(bh),{score:a}=e.score(i);if(!a&&!n)break;if(!(a>=.8*n))break;n=a,r=o+1}return{command:e,fallbackString:t.slice(r).join(bh),prefixScore:n}}}function vh(e,t){return t.findIndex((t=>t.command.id===e.id))}var xh=o(92346);function Oh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ph(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Oh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Oh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var jh=()=>{const{0:e,1:t}=(0,a.useState)(gm.d9),{0:o,1:n}=(0,a.useState)(new Map),r=(0,a.useCallback)((t=>Ph(Ph({},o.get(t)),e)),[o,e]),i=(0,a.useCallback)(((r,i)=>{const a=(0,xh.Z)(e),l=(0,xh.Z)(o.get(r)||{});for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(e in a?a[e]=i[e]:l[e]=i[e]);if((0,po.Z)(e,a)||t(a),!(0,po.Z)(o.get(r)||{},l)){const e=new Map(o);e.set(r,l),n(e)}}),[o,e]),l=(0,a.useCallback)((()=>{n(new Map)}),[]);return(0,a.useMemo)((()=>({getCommandState:r,setCommandState:i,clearCommandState:l})),[l,r,i])},wh=o(42726),Th=o(13589);var Ih=function(e){let{scroller:t,el:o,direction:n="UP",offset:r=0}=e;const i=t.getBoundingClientRect(),a=o.getBoundingClientRect();if("UP"===n){const e=a.top-i.top;if(e<6){const o=t.scrollTop+e-6-r;t.scrollTop=o}}if("DOWN"===n){const e=i.bottom-a.bottom;if(e<6){const o=t.scrollTop-e+6+r;t.scrollTop=o}}},Eh=o(85518),_h=o(56913);let Sh;!function(e){e[e.PROMPT=0]="PROMPT",e[e.DOCUMENT=1]="DOCUMENT"}(Sh||(Sh={}));const kh=fc.ZP.t("commandPrompt.placeholder.default");var Zh=(0,a.forwardRef)(((e,t)=>{let{inputJSON:o,inputString:n,placeholder:r=kh,navigateForward:i,navigateBackward:l,onArrowUp:s,onArrowDown:c,hasContent:d,onInputChange:p,onInputPaste:u,mode:m,inputMode:g}=e;const h=(0,a.useMemo)((()=>{const e={esc:()=>(l(),!0)};if(g===Sh.PROMPT&&(e.enter=()=>(i(),!0)),g===Sh.DOCUMENT&&(e["mod+enter"]=()=>(i(),!0),e.esc=()=>!d&&(l(),!0)),m===gm.q$.ROOT&&(e.arrowup=()=>(s(),!0),e.arrowdown=()=>(c(),!0),e.arrowright=()=>!d&&(i(),!0)),m===gm.q$.SCOPED){const t=()=>!d&&(l(),!0);e.arrowleft=t,e.backspace=t}return e}),[m,g,d,i,l,s,c]),f=m===gm.q$.ROOT,b=g===Sh.DOCUMENT||f?5e4:1e3,y=g===Sh.PROMPT?[]:[fo.Ar.TYPE_SCALES,fo.Ar.LISTS,fo.Ar.STRICT_MODE];return(0,S.jsx)(cm.SR,{$inRootMode:f,children:(0,S.jsx)(cm.rD,{bodyFontSize:20,innerTilePadding:0,$isMobile:Eh.tq,$horizontalAlignment:z.KxP.Leading,$verticalAlignment:z.Q4P.Top,$placeholder:r,$error:n.length>=b,$hasContent:d,$inRootMode:f,disabled:!1,"data-testid":"command_prompt_input",children:(0,S.jsx)(_h.Z,{ref:t,autoFocus:m!==gm.q$.DELEGATE,placeholder:r,value:o,setValue:p,onPaste:u,features:y,keyBindings:h,wrapText:!f,disableHistory:!1,maxCharacterLimit:b})})})}));const Dh=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptError__ErrorMessage",componentId:"oxv8fw-0"})(["width:100%;height:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start;font-size:",";line-height:20px;padding-left:20px;color:",";cursor:auto;svg{fill:currentColor;}svg:hover{fill:currentColor;}"],(e=>{let{theme:t}=e;return t.fontSizes.sm}),(e=>{let{theme:t}=e;return t.colors.errorText}));var Mh=e=>{let{errorCode:t}=e;const{message:o}=(e=>{switch(e){case gm.BO.OUT_OF_MODERATION_ERROR:return{message:fc.ZP.t("tomeGenerationError.outOfModerationPolicy"),retryable:!1};case gm.BO.RATE_LIMIT_ERROR:return{message:fc.ZP.t("tomeGenerationError.rateLimit"),retryable:!1};case gm.BO.GENERIC_ERROR:default:return{message:fc.ZP.t("tomeGenerationError.generic"),retryable:!0}}})(t);return(0,S.jsx)(Dh,{"data-testid":"command_prompt_error",children:o})};const Rh=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptListItem__CommandPromptListItemContainer",componentId:"sc-1vm7o7i-0"})(["flex-shrink:0;height:","px;position:relative;pointer-events:",";"],cm.xJ,(e=>{let{$isVisible:t}=e;return t?"auto":"none"})),Ah=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptListItem__CommandPromptListItemInnerContainer",componentId:"sc-1vm7o7i-1"})(["position:absolute;inset:0px 6px;"]);var Lh=e=>{let{initial:t,animate:o,transition:n,onAnimationComplete:r,onMouseMove:i,isVisible:a,dataTestId:l,dataFocused:s,children:c}=e;return(0,S.jsx)(Rh,{initial:t,animate:o,transition:n,onAnimationComplete:r,$isVisible:a,"data-testid":l,"data-focused":s,children:(0,S.jsx)(Ah,{onMouseMove:i,children:c})})};const Nh=e=>({imageStyle:e.imageStyle.getWireImageStyle(),artifactType:e.artifactType.getWireArtifactType()});var Hh=function(e){let{getCommandState:t,tomeId:o}=e;const{apolloClient:n}=(0,N.bp)();return(0,a.useCallback)((e=>{let{commandId:r,input:i,mode:a}=e;const l=t(r);_a.ZP.reportSumbitCommand({apolloClient:n,commandId:r,commandInput:i.slice(0,5e3),commandInputLength:i.length,commandMode:a,commandParameters:Nh(l),tomeId:o})}),[n,t,o])};function Vh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Bh(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Vh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Vh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Fh=e=>{let{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,inputString:l,setInputJSON:s,errorCode:c,setErrorCode:d,getCommandState:p,setCommandState:u,clearCommandState:m,backgroundRef:g}=e;const h=Hh({getCommandState:p,tomeId:n}),{commandPromptMode:f,setCommandPromptMode:b,controlCommandPrompt:y,setShouldResetCommandPromptAfterClose:C,selectedCommandId:v,setSelectedCommandId:x,directlyInvokeCommand:O,setDirectlyInvokeCommand:P,setBlockCommandPromptToggle:j,promptAnimationsEnabled:w,setPromptAnimationsEnabled:T}=(0,Sc.uJ)(),I=f===gm.q$.ROOT,E=f===gm.q$.SCOPED,_=f===gm.q$.DELEGATE,{0:k,1:Z}=(0,a.useState)((()=>t.getMatchingCommands({isEmptyTome:r,query:l,selectedCommandId:v}))),{0:D,1:M}=(0,a.useState)((()=>t.getMatchingCommands({isEmptyTome:r,query:l,selectedCommandId:v})[0].command)),R=(0,a.useRef)(null),A=l.length>0,L=(0,a.useRef)();L.current=(e,t,o)=>{O&&v===e&&t&&(P(!1),o({stringValue:"",jsonValue:$u.yS,wasDirectlyInvoked:!0}))};const N=(0,a.useRef)(new Map),H=(0,No.Z)(((e,t,o)=>{null===N||void 0===N||N.current.set(e,o),L.current&&L.current(e,t,o)}),[]),V=(0,a.useCallback)((()=>{var e;if(I&&D)h({commandId:D.id,input:l,mode:"ROOT"}),null===N||void 0===N||null===(e=N.current.get(D.id))||void 0===e||e({stringValue:l,jsonValue:i,wasDirectlyInvoked:!1});else if(E&&v&&l.length>0){var t;h({commandId:v,input:l,mode:"SCOPED"}),null===N||void 0===N||null===(t=N.current.get(v))||void 0===t||t({stringValue:l,jsonValue:i,wasDirectlyInvoked:!1})}}),[E,I,D,v,l,h,i]),B=(0,a.useRef)(null),F=()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.focusEditor()},$=(0,a.useCallback)((e=>{Z(e),M(e[0].command),null!==R&&void 0!==R&&R.current&&(R.current.scrollTop=0)}),[]),G=(0,a.useCallback)((e=>{const o=t.getMatchingCommands({isEmptyTome:r,query:e,selectedCommandId:v});$(o)}),[t,r,v,$]),z=(0,a.useCallback)((()=>{$(t.getMatchingCommands({isEmptyTome:r,selectedCommandId:v}))}),[t,r,v,$]),U=(0,a.useCallback)((e=>{if(s(e),d(null),I){const t=(0,Km.Q)(e);G(t)}}),[G,I,d,s]),W=(0,a.useCallback)((()=>{setTimeout((()=>{var e;const t=null===B||void 0===B||null===(e=B.current)||void 0===e?void 0:e.getEditor(),o=null===t||void 0===t?void 0:t.selection;if(o){var n;const e=(0,Cn.lrJ)(t,o),i=null===e||void 0===e?void 0:e.getBoundingClientRect().bottom,a=null===g||void 0===g||null===(n=g.current)||void 0===n?void 0:n.getBoundingClientRect().bottom;var r;if(i&&a&&i>a)null===e||void 0===e||null===(r=e.endContainer.parentElement)||void 0===r||r.scrollIntoView({block:"end"})}}),1)}),[g]),q=(0,a.useCallback)(((e,t)=>{const o=vh(e,k);if(R.current){const e=R.current,n=Array.from(R.current.children).slice(1,-1)[o];e&&n&&Ih({scroller:e,el:n,direction:t,offset:20})}}),[k]),K=(0,a.useCallback)((()=>{s($u.yS),z()}),[z,s]),Y=(0,No.Z)(((e,t)=>{switch(t){case gm.q$.ROOT:K(),d(null),x(null);break;case gm.q$.SCOPED:case gm.q$.DELEGATE:x(e.id)}b(t),T(!0),t===gm.q$.DELEGATE?(()=>{var e;null===(e=B.current)||void 0===e||e.blurEditor()})():F()}),[b,T,K,d,x]),J=(0,No.Z)(u,[u]),X=(0,a.useCallback)((()=>{C(!0)}),[C]),Q=(0,a.useCallback)((()=>{y({action:Sc.$C.CLOSE})}),[y]),ee=(0,a.useCallback)((()=>{C(!0),Q()}),[Q,C]),te=(0,a.useCallback)((()=>{if(A)K();else switch(f){case gm.q$.SCOPED:x(null),z(),T(!0),b(gm.q$.ROOT),m();break;case gm.q$.ROOT:ee();case gm.q$.DELEGATE:}}),[A,f,K,x,z,T,b,m,ee]),oe=(0,a.useCallback)((()=>{const e=vh(D,k),t=Math.min(e+1,k.length-1),{command:o}=k[t];M(o),q(o,"UP")}),[k,D,q,M]),ne=(0,a.useCallback)((()=>{const e=vh(D,k),t=Math.max(e-1,0),{command:o}=k[t];M(o),q(o,"DOWN")}),[k,D,q,M]);(0,pg.Z)(f!==gm.q$.DELEGATE?g:null,Q);const re=e=>{var t;return e.id===v?vh(e,k)*cm.xJ+((null===R||void 0===R||null===(t=R.current)||void 0===t?void 0:t.scrollTop)||0)+(cm.xJ-cm.BY)/2+cm.EW:0},ie=e=>({opacity:null===v||e.id===v?1:0,y:re(e),height:null===v||e.id!==v?`${cm.xJ}px`:`${cm.BY}px`}),ae={height:c?"36px":0,opacity:c?1:0},{0:le,1:se}=(0,a.useState)(Sh.PROMPT),ce=(0,a.useCallback)((()=>{v===Ac.DOC_TO_TOME?se(Sh.DOCUMENT):se(Sh.PROMPT)}),[v]),de=(0,a.useCallback)((()=>{E&&T(!1)}),[E,T]),pe=(0,a.useMemo)((()=>(0,ku.Z)(((e,t)=>{if(I){if(0===Math.hypot(e.movementX,e.movementY))return;M(t)}}),50)),[I,M]),ue=v?t.getCommandById(v):null,me=_&&ue?{title:ue.title,mode:gm.q$.DELEGATE,changePromptMode:Y(ue),contributeCommandHandler:H(ue.id)(!0),inputString:l,inputJSON:i,focusInput:F,clearInput:K,setShowOverlayAndBlockKeys:o,tomeId:n,promptBackgroundRef:g,onComplete:ee,clearCommandState:m,setErrorCode:d,isFocusedInRootMode:!1,disableTitleAnimations:!1,resetCommandPromptAfterClose:X,setBlockCommandPromptToggle:j}:null;return(0,S.jsxs)(cm.CM,{initial:{opacity:0,scale:.8},exit:{opacity:0,scale:.2,transition:cm.U2},animate:{opacity:1,scale:1,transition:cm.U2},transition:w?cm.c:cm.Xi,onAnimationComplete:de,style:{originX:.5,originY:1},children:[(0,S.jsxs)(cm._2,{layout:"size",transition:w?cm.c:cm.Xi,style:{position:I||E?"relative":"absolute"},animate:{opacity:I||E?1:0},children:[(0,S.jsxs)(cm.Ur,{ref:R,transition:w?cm.TP:cm.YB,initial:!1,animate:{height:`${I?Math.min(cm.rZ,k.length*cm.xJ+2*cm.EW):cm.BY}px`},$disableScroll:E,onAnimationComplete:ce,"data-testid":"command_prompt_list",children:[(0,S.jsx)(cm.T7,{}),k.map((e=>{let{command:t,fallbackString:r}=e;const a=t.id===v,s=t.id===D.id,c=E&&!a||!w,u={title:t.title,mode:a?gm.q$.SCOPED:gm.q$.ROOT,changePromptMode:Y(t),contributeCommandHandler:H(t.id)(!1),inputString:l,inputJSON:i,focusInput:F,clearInput:K,setShowOverlayAndBlockKeys:o,tomeId:n,promptBackgroundRef:g,onComplete:ee,clearCommandState:m,setErrorCode:d,isFocusedInRootMode:I&&s,fallbackString:r,disableTitleAnimations:!w,resetCommandPromptAfterClose:X,setBlockCommandPromptToggle:j};return(0,S.jsx)(Lh,{initial:ie(t),animate:ie(t),transition:c?cm.YB:cm.TP,onAnimationComplete:a?de:void 0,dataTestId:`${t.id}_${f}_mode`,dataFocused:I?s:void 0,onMouseMove:e=>pe(e,t),isVisible:null===v||a,children:(0,S.jsx)(Vm,{value:u,children:(0,S.jsx)(t.component,Bh(Bh({setCommandState:J(t.id)},p(t.id)),u))})},t.id)})),(0,S.jsx)(cm.T7,{})]}),(0,S.jsx)(cm.iz,{transition:cm.$E,animate:{opacity:I?1:0}}),(0,S.jsx)(Zh,{ref:B,inputJSON:i,inputString:l,placeholder:null===ue||void 0===ue?void 0:ue.placeholder,onInputChange:U,onInputPaste:W,mode:f,inputMode:le,navigateForward:V,navigateBackward:te,onArrowUp:oe,onArrowDown:ne,hasContent:l.length>0}),(0,S.jsx)(cm.cW,{initial:ae,animate:ae,transition:{type:"spring",bounce:0},children:c&&(0,S.jsx)(Mh,{errorCode:c})})]}),(0,S.jsx)(cm.ef,{transition:w?cm.c:cm.Xi,style:{position:_?"relative":"absolute"},initial:{opacity:0},animate:{opacity:_?1:0},layout:"size",onAnimationComplete:de,children:null!=ue&&null!=me&&(0,S.jsx)(Vm,{value:me,children:(0,S.jsx)(ue.component,Bh(Bh({setCommandState:J(ue.id)},p(ue.id)),me))})})]})},$h=o(34997);var Gh=(0,a.forwardRef)(((e,t)=>{let{fillColor:o}=e;return(0,S.jsxs)(we.Z,{ref:t,width:"21",height:"10",viewBox:"0 0 21 10",fill:"none","data-testid":"command_k_icon",children:[(0,S.jsx)("path",{d:"M2.125 10C3.68056 10 4.18056 9.02778 4.18056 7.86111V6.70833H5.70833V7.86111C5.70833 9.02778 6.20833 10 7.76389 10C9.05556 10 9.88889 9.18056 9.88889 7.90278C9.88889 6.55556 9.08333 5.76389 7.5 5.76389H6.68055V4.23611H7.5C9.08333 4.23611 9.88889 3.44444 9.88889 2.09722C9.88889 0.819445 9.05556 0 7.76389 0C6.20833 0 5.70833 0.972222 5.70833 2.13889V3.29167H4.18056V2.13889C4.18056 0.972222 3.68056 0 2.125 0C0.833333 0 0 0.819445 0 2.09722C0 3.44444 0.805556 4.23611 2.38889 4.23611H3.20833V5.76389H2.38889C0.805556 5.76389 0 6.55556 0 7.90278C0 9.18056 0.833333 10 2.125 10ZM6.68055 2.11111C6.68055 1.40278 7.04167 0.958333 7.76389 0.958333C8.41667 0.958333 8.90278 1.27778 8.90278 2.09722C8.90278 2.88889 8.48611 3.29167 7.5 3.29167H6.68055V2.11111ZM2.38889 3.29167C1.40278 3.29167 0.986111 2.88889 0.986111 2.09722C0.986111 1.27778 1.47222 0.958333 2.125 0.958333C2.84722 0.958333 3.20833 1.40278 3.20833 2.11111V3.29167H2.38889ZM4.18056 5.76389V4.23611H5.70833V5.76389H4.18056ZM2.125 9.04167C1.47222 9.04167 0.986111 8.72222 0.986111 7.90278C0.986111 7.11111 1.40278 6.70833 2.38889 6.70833H3.20833V7.88889C3.20833 8.59722 2.84722 9.04167 2.125 9.04167ZM6.68055 7.88889V6.70833H7.5C8.48611 6.70833 8.90278 7.11111 8.90278 7.90278C8.90278 8.72222 8.41667 9.04167 7.76389 9.04167C7.04167 9.04167 6.68055 8.59722 6.68055 7.88889Z",fill:o}),(0,S.jsx)("path",{d:"M13.6868 10V0.277778H14.9368V4.48611C15.0294 4.38426 15.1776 4.21296 15.3813 3.97222L18.6313 0.277778H20.1591L14.9368 6.13889V10H13.6868ZM19.1591 10L15.298 5.34722L16.1868 4.51389L20.7841 10H19.1591Z",fill:o})]})}));var zh=(0,a.forwardRef)(((e,t)=>{let{fillColor:o}=e;return(0,S.jsxs)(we.Z,{ref:t,width:"49",height:"10",viewBox:"0 0 49 10",fill:"none","data-testid":"control_k_icon",children:[(0,S.jsx)("path",{d:"M3.74829 10C5.78659 10 6.85362 8.75513 7.0725 6.70315H5.78659C5.55404 8.11217 5.02052 8.96033 3.72093 8.96033C2.1751 8.96033 1.31327 7.3461 1.31327 4.95212C1.31327 2.57182 2.13406 1.05335 3.72093 1.05335C4.95212 1.05335 5.54036 2.01094 5.70451 3.31053H7.0725C6.9357 1.43639 5.85499 0 3.81669 0C1.47743 0 0 1.99726 0 4.95212C0 8.04378 1.35431 10 3.74829 10Z",fill:o}),(0,S.jsx)("path",{d:"M13.6882 9.91792C14.0713 9.91792 14.4817 9.8632 14.7963 9.7948V8.74145C14.4543 8.79617 14.1944 8.82353 13.9071 8.82353C12.1834 8.82353 11.7457 8.26265 11.7457 6.96306V4.17237H14.6732V3.20109H11.7457V1.02599H10.5692V3.20109H8.07947V4.17237H10.5692V7.12722C10.5692 9.11081 11.6499 9.91792 13.6882 9.91792Z",fill:o}),(0,S.jsx)("path",{d:"M19.0728 9.7948V6.55267C19.0728 5.06156 19.9209 4.17237 21.8361 4.17237C22.1371 4.17237 22.4107 4.19973 22.6432 4.22709V3.07797C22.397 3.03694 22.1918 3.02326 21.9455 3.02326C20.2082 3.02326 19.4148 3.85773 19.0728 4.59644V3.48837V3.20109H17.8963V9.7948H19.0728Z",fill:o}),(0,S.jsx)("path",{d:"M29.1632 0.218878H25.3328V1.19015H28.0004V8.82353H24.7719V9.7948H31.9265V8.82353H29.1632V0.218878Z",fill:o}),(0,S.jsx)("path",{d:"M36.7912 5.21204V2.35294H35.7926V5.21204H33.0566V6.18331H35.7926V9.04241H36.7912V6.18331H39.5409V5.21204H36.7912Z",fill:o}),(0,S.jsx)("path",{d:"M43.9404 4.50068L47.7571 0.218878H46.2523L43.0513 3.85773C42.9008 4.03557 42.7503 4.21341 42.6135 4.36388V0.218878H41.3823V9.7948H42.6135V5.99179L43.1333 5.40356L46.7722 9.7948H48.3727L43.9404 4.50068Z",fill:o})]})}));const Uh={hover:{opacity:0,transition:{repeat:1/0,repeatType:"mirror",duration:.5,delay:.5,ease:"easeOut"}},default:{}},Wh=(0,b.ZP)(d.E.div).withConfig({displayName:"CollapsedCommandPrompt__RoundedRectangle",componentId:"sc-73e1lw-0"})(["height:100%;width:100%;border-radius:10px;box-shadow:",";backdrop-filter:saturate(180%) blur(20px);pointer-events:auto;background-color:",";"],(e=>{let{theme:t}=e;return t.colors.collapsedCommandPromptBoxShadow}),(e=>{let{theme:t,$activeHover:o}=e;return o?t.colors.collapsedCommandPromptBackgroundHover:t.colors.collapsedCommandPromptBackground})),qh=(0,b.ZP)(d.E.div).withConfig({displayName:"CollapsedCommandPrompt__Content",componentId:"sc-73e1lw-1"})(["height:100%;width:100%;display:flex;justify-content:space-between;align-items:center;position:relative;padding:10px;"]),Kh=(0,b.ZP)(ke.Z).withConfig({displayName:"CollapsedCommandPrompt__Button",componentId:"sc-73e1lw-2"})(["opacity:0;width:","px;height:","px;position:absolute;inset:0;"],cm.jo,cm.V3),Yh=b.ZP.div.withConfig({displayName:"CollapsedCommandPrompt__CursorBar",componentId:"sc-73e1lw-3"})(["width:3px;height:16px;border-radius:2px;background-color:",";transition:background-color 0.5s ease-out;"],(e=>{let{theme:t,$activeHover:o}=e;return o?t.colors.collapsedCommandPromptBlinkingCursor:t.colors.collapsedCommandPromptStaticCursor}));var Jh=()=>{const{t:e}=(0,y.$G)(),t=e("commandPrompt.collapsedCommandPromptLabel"),o=(0,b.Fg)(),{commandPromptIsOpen:n,controlCommandPrompt:r}=(0,Sc.br)(),{0:i,1:l}=(0,a.useState)(!1),{0:s,1:c}=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{r({action:Sc.$C.OPEN})}),[r]);return(0,S.jsx)(Wh,{onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},layout:!0,initial:!1,animate:{opacity:n?0:1},style:{borderRadius:"10px"},transition:cm.U2,onAnimationStart:()=>{c(!0)},onAnimationComplete:()=>{c(!1),l(!1)},$activeHover:i,"data-testid":"collapsed_command_prompt","data-testid-collapsed-command-prompt-hover-state":i,children:(0,S.jsxs)(qh,{initial:!1,animate:{opacity:n?0:1},transition:n?cm.DJ:cm.te,children:[(0,S.jsx)(d.E.div,{initial:{opacity:1},animate:i?"hover":"default",variants:Uh,layout:!0,transition:cm.U2,children:(0,S.jsx)(Yh,{$activeHover:i,"data-testid":"cursor_bar"})}),!n&&!s&&(0,S.jsx)(st.Z,{content:t,placement:"top",tooltipDisabled:!i,children:(0,S.jsx)(Kh,{onClick:p,"aria-label":t})}),$h.Os.isMac()?(0,S.jsx)(Gh,{fillColor:o.colors.collapsedCommandPromptShortcutFill}):(0,S.jsx)(zh,{fillColor:o.colors.collapsedCommandPromptShortcutFill})]})})};var Xh=e=>{let{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,setInputJSON:l,errorCode:s,setErrorCode:c,getCommandState:d,setCommandState:u,clearCommandState:m,resetStateIfNeeded:g,canEditDynamic:h}=e;const f=(0,a.useRef)(null),{commandPromptIsOpen:b,commandPromptMode:y,promptAnimationsEnabled:C}=(0,Sc.uJ)(),v=y===gm.q$.ROOT,x=y===gm.q$.SCOPED,O=b?{y:0}:{y:20},P=b?v||x?`${cm.Wu}px`:"auto":`${cm.jo}px`,j=b?"auto":`${cm.V3}px`,w=C?cm.U2:cm.Xi,T=b?cm.v:cm.k$;return(0,S.jsxs)(cm.QO,{initial:!1,animate:O,transition:cm.U2,children:[(0,S.jsx)(cm.Id,{children:(0,S.jsx)(Th.S,{children:(0,S.jsx)(cm.VL,{ref:f,layout:!0,initial:!1,animate:{opacity:b?1:0,transition:T},style:{height:j,width:P,borderRadius:"12px"},transition:w,onPointerDown:Lt.Z,children:(0,S.jsx)(p.M,{onExitComplete:g,children:b&&(0,S.jsx)(Fh,{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,inputString:(0,Km.Q)(i),setInputJSON:l,errorCode:s,setErrorCode:c,getCommandState:d,setCommandState:u,clearCommandState:m,backgroundRef:f})})})})}),h&&(0,S.jsx)(cm.oz,{style:{zIndex:b?cm.m4-1:cm.m4+1},children:(0,S.jsx)(Jh,{})})]})};var Qh=e=>{let{setKeyboardEnabled:t,tomeId:o,isEmptyTome:n,canEditDynamic:r}=e;const i=(0,a.useContext)(dr.Z),l=(0,a.useMemo)((()=>(e=>{const t=new Ch(e);return t.register(Gg),t.register(Tg),t.register(oh),t.register(eh),t.register(qg),t.register(ch({id:Ac.CREATE_IMAGE,icon:Ge.Z,title:fc.ZP.t("commandPrompt.tiles.createImage.commandTitle"),tileType:z.YUT.Image,keywords:fc.ZP.t("commandPrompt.tiles.createImage.keywords",{returnObjects:!0}),afterAddTileAction:nr.B.CLICK_IMAGE_TILE_CREATE_BUTTON})),t.register(ch({id:Ac.UPLOAD_IMAGE,icon:ze.Z,title:fc.ZP.t("commandPrompt.tiles.uploadImage.commandTitle"),tileType:z.YUT.Image,keywords:fc.ZP.t("commandPrompt.tiles.uploadImage.keywords",{returnObjects:!0}),afterAddTileAction:nr.B.CLICK_IMAGE_TILE_UPLOAD_BUTTON})),t.register(ch({id:Ac.ADD_TEXT_TILE,icon:Gu.Z,title:fc.ZP.t("commandPrompt.tiles.text.commandTitle"),tileType:z.YUT.Text,keywords:fc.ZP.t("commandPrompt.tiles.text.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_VIDEO_TILE,icon:zu.Z,title:fc.ZP.t("commandPrompt.tiles.video.commandTitle"),tileType:z.YUT.Video,keywords:fc.ZP.t("commandPrompt.tiles.video.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_TABLE_TILE,icon:Uu.Z,title:fc.ZP.t("commandPrompt.tiles.table.commandTitle"),tileType:z.YUT.Table,keywords:fc.ZP.t("commandPrompt.tiles.table.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_GIPHY_TILE,icon:Qu.Z,title:fc.ZP.t("commandPrompt.tiles.giphy.commandTitle"),tileType:z.YUT.Giphy,keywords:fc.ZP.t("commandPrompt.tiles.giphy.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_FIGMA_TILE,icon:Wu.Z,title:fc.ZP.t("commandPrompt.tiles.figma.commandTitle"),tileType:z.YUT.Figma,keywords:fc.ZP.t("commandPrompt.tiles.figma.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_AIRTABLE_TILE,icon:qu.Z,title:fc.ZP.t("commandPrompt.tiles.airtable.commandTitle"),tileType:z.YUT.Airtable,keywords:fc.ZP.t("commandPrompt.tiles.airtable.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_TWITTER_TILE,icon:Yu.Z,title:fc.ZP.t("commandPrompt.tiles.twitter.commandTitle"),tileType:z.YUT.Twitter,keywords:fc.ZP.t("commandPrompt.tiles.twitter.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_FRAMER_TILE,icon:Ju.Z,title:fc.ZP.t("commandPrompt.tiles.framer.commandTitle"),tileType:z.YUT.Framer,keywords:fc.ZP.t("commandPrompt.tiles.framer.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_MIRO_TILE,icon:Xu.Z,title:fc.ZP.t("commandPrompt.tiles.miro.commandTitle"),tileType:z.YUT.Miro,keywords:fc.ZP.t("commandPrompt.tiles.miro.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_LOOKER_TILE,icon:em.Z,title:fc.ZP.t("commandPrompt.tiles.looker.commandTitle"),tileType:z.YUT.Looker,keywords:fc.ZP.t("commandPrompt.tiles.looker.keywords",{returnObjects:!0})})),t.register(ch({id:Ac.ADD_WEB_TILE,icon:Ku.Z,title:fc.ZP.t("commandPrompt.tiles.web.commandTitle"),tileType:z.YUT.Web,keywords:fc.ZP.t("commandPrompt.tiles.web.keywords",{returnObjects:!0})})),t.register($m),t.register(dh(Ac.OPEN_CUSTOMIZE_PANEL,nm,fc.ZP.t("commandPrompt.setTheme.commandTitle"),_.Z.CUSTOMIZE,fc.ZP.t("commandPrompt.setTheme.keywords",{returnObjects:!0}))),t.register(dh(Ac.OPEN_RECORD_PANEL,am,fc.ZP.t("commandPrompt.recordNarration.commandTitle"),_.Z.RECORD,fc.ZP.t("commandPrompt.recordNarration.keywords",{returnObjects:!0}))),t.register(Rm),t.register(gh),t.register(ah),t.register(lh),t.register(mh(Ac.PROMPT_TIPS_LINK,lm.Z,fc.ZP.t("commandPrompt.help.promptTips.commandTitle"),"https://tome.app/tomecommunity/prompt-guide-tips-for-crafting-generative-prompts-clbtp8jdh0b5c4w5x3p596esr?utm_source=tome&utm_medium=referral&utm_campaign=command-prompt&utm_content=tips-for-crafting&utm_term=",fc.ZP.t("commandPrompt.help.promptTips.keywords",{returnObjects:!0}))),t.register(mh(Ac.GETTING_STARTED_LINK,sm.Z,fc.ZP.t("commandPrompt.help.gettingStarted.commandTitle"),"https://tome.app/tomecommunity/tome-getting-started-guide-cl5sigulu1899274x5iqictrjgv?utm_source=tome&utm_medium=referral&utm_campaign=command-prompt&utm_content=getting-started&utm_term=",fc.ZP.t("commandPrompt.help.gettingStarted.keywords",{returnObjects:!0}))),t.register(hh),t})(i)),[i]),{0:s,1:c}=(0,a.useState)($u.yS),{0:d,1:u}=(0,a.useState)(null),{0:m,1:g}=(0,a.useState)(!1),h=(0,a.useCallback)((e=>{g(e),t(!e)}),[t]),{getCommandState:f,setCommandState:b,clearCommandState:y}=jh(),{shouldResetCommandPromptAfterClose:C,setShouldResetCommandPromptAfterClose:v,resetCommandPromptState:x}=(0,Sc.uJ)(),O=(0,a.useCallback)((()=>{v(!1),x(),c($u.yS),u(null),y(),t(!0)}),[y,x,t,v]),P=(0,a.useCallback)((()=>{C&&O()}),[C,O]);return(0,a.useEffect)((()=>()=>{O()}),[]),(0,S.jsxs)(cm.uS,{style:{zIndex:T.IT},children:[(0,S.jsx)(Xh,{commandRegistry:l,setShowOverlayAndBlockKeys:h,tomeId:o,isEmptyTome:n,inputJSON:s,setInputJSON:c,errorCode:d,setErrorCode:u,getCommandState:f,setCommandState:b,clearCommandState:y,resetStateIfNeeded:P,canEditDynamic:r}),(0,S.jsx)(p.M,{children:m&&(0,S.jsx)(wh.C,{"data-testid":"block_clicks_and_dim_overlay",onPointerDown:Lt.Z,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:cm.OG})})]})};const ef=m()((()=>Promise.all([o.e(8144),o.e(4988)]).then(o.bind(o,74988))),{loadableGenerated:{webpack:()=>[74988]}}),tf=e=>{let{pages:t,presentMode:o,isMobile:n}=e;return Id({pages:t,presentMode:o,isMobile:n}),null},of=(0,b.ZP)(d.E.div).withConfig({displayName:"Tome__TomeStyles",componentId:"tmbvsx-0"})(["display:flex;flex-direction:column;overflow:",";height:100%;"],(e=>e.$isMobile?"visible":"hidden")),nf=b.ZP.div.withConfig({displayName:"Tome__TomeContent",componentId:"tmbvsx-1"})(["display:flex;justify-content:center;flex:1;position:relative;"]);function rf(e){e.preventDefault()}var af=e=>{var t,o,n,r;let{id:i,tome:d,isBot:u=!1,isMobileFromUA:m=!1,triggerTomeRefetch:h}=e;const O=(0,b.Fg)(),P=(0,Jp.Z)(),j=(0,ou.sk)()?m:P,{t:w}=(0,y.$G)(),{user:T,flags:_,loading:k,error:Z}=(0,a.useContext)(dr.Z),{apolloClient:A,clientId:L}=(0,N.bp)(),B=(0,g.useRouter)();(0,a.useEffect)((()=>("undefined"!==typeof document&&document.addEventListener("contextmenu",rf),()=>{document.removeEventListener("contextmenu",rf)})),[]),(0,a.useEffect)((()=>()=>{(0,H.oG)(!1)}),[]);const[$,G]=(0,l.FV)(H.xi);(0,a.useEffect)((()=>()=>{G(!1)}),[G]),(0,a.useEffect)((()=>{if(null!==d&&void 0!==d&&d.canonicalUrl&&B.asPath){const e=new URL(d.canonicalUrl),t=new URL(B.asPath,window.location.origin);e.pathname!==t.pathname&&B.replace(e.toString().replace(e.origin,""),void 0,{shallow:!0})}}),[null===d||void 0===d?void 0:d.canonicalUrl,B,B.asPath]),(0,a.useEffect)((()=>(s.v.addRumGlobalContext("tomeId",i),()=>{s.v.removeRumGlobalContext("tomeId")})),[i]),(0,a.useEffect)((()=>{var e;k||_a.ZP.reportTomeView({apolloClient:A,tomeId:i,tomeOrgId:null===(e=d.org)||void 0===e?void 0:e.id})}),[k,i,A,null===(t=d.org)||void 0===t?void 0:t.id]);const z=!k&&!T,U=(0,l.Zl)(H.Vx),W=(0,l.Zl)(H.pt),q=(0,l.rb)(kn.Qf),K=(0,l.Zl)(kn.Hl),Y=(0,l.Zl)(kn.tF),J=(0,c.l)(H.oG),[X,Q]=(0,l.FV)(H.DH),ee=null!==X,te=fs(),[oe,ne]=(0,l.FV)((0,Nd.J)(d.id)),re=(0,E.t2)(),ie=null!==(0,E.f3)(),{height:ae,width:le}=(0,F.Z)(),se=(0,l.sJ)(H.GP),ce=(0,l.sJ)(Ae.cm),de=(0,l.sJ)(Ae.s5),pe=(0,c.l)(H.Ad),[ue,me]=(0,l.FV)(H.dt),ge=(null===(o=d.currentUserPermission)||void 0===o?void 0:o.canEdit)&&!j,he=(null===(n=d.currentUserPermission)||void 0===n?void 0:n.canComment)&&!j,fe=ge&&!J&&!j&&(se||!(null!==_&&void 0!==_&&_.offlineReadOnly))&&0===pe.length,be=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{var o;const n=t.getLoadable(H.Vx).getValue();if(!fe||J||ee)return;const r=(0,V.xh)(d.pages,n),i=null===r?(null===(o=d.pages)||void 0===o?void 0:o.length)||0:r+1,{pageId:a,tileId:l}=(0,eu.Vy)(d,i,A,L,e);U(a),(0,H.Dm)(l),W((e=>e.length>0?[]:e))}}),[fe,J,ee,d,A,L,U,W]),ye=(0,a.useCallback)((()=>{(0,H.oG)(!1),Q(null),re.closePropertyPanel(),(0,H.Dm)(null)}),[re,Q]),Ce=(0,a.useCallback)((()=>{J||(ye(),(0,H.oG)(!0),_a.ZP.reportTogglePlayMode({apolloClient:A,tomeId:i,mode:_a.jl.ON}))}),[A,i,J,ye]),ve=(0,a.useCallback)((()=>{Q(null),Y(!0),(0,H.Dm)(null)}),[Y,Q]),xe=(0,a.useCallback)((()=>{J&&(ge||he)&&(ye(),Y(!0),_a.ZP.reportTogglePlayMode({apolloClient:A,tomeId:i,mode:_a.jl.OFF}))}),[J,ge,he,ye,Y,A,i]),{handleTap:Oe,handlePointerDown:Pe,handlePointerUp:je,isHoldingLeft:we,sliderRef:Te}=Qp({pages:d.pages,enabled:j&&!oe}),{outlineWidth:Ie,propertyPanelWidth:Ee,toolbarWidth:_e,pageContainerWidth:Se,pageContainerHeight:ke,pageVerticalMargin:Ze}=(0,Ha.yn)(le||0,ae||0,j),De=(0,a.useRef)(),Me=(0,f.useSpring)({config:{tension:220},transform:ie?"translate3d(0px,0,0) scale(1)":"translate3d(60px,0,0) scale(0.9)",opacity:ie?1:0,onRest(){De.current&&De.current.triggerReMeasure()}});(0,a.useEffect)((()=>{(0,ua.hT)(A,d.id)}),[A,d.id]);const Re=(0,a.useRef)(null),Le=(0,a.useRef)(null),Ne=(0,a.useRef)(null),He=(0,a.useRef)(null),Ve=(0,a.useRef)(null),Be=(0,a.useRef)(null),Fe=(0,a.useRef)(null),$e=(0,a.useRef)(null),Ge=(0,a.useCallback)((e=>{if(ce||de)return;const t=Re.current&&Re.current.contains(e.target),o=Le.current&&Le.current.contains(e.target),n=Ne.current&&Ne.current.contains(e.target),r=He.current&&He.current.contains(e.target),i=Ve.current&&Ve.current.contains(e.target);let a=!1;He.current&&He.current.querySelectorAll("[data-tile-type]").forEach((t=>{t.contains(e.target)&&(a=!0)})),t||W((e=>e.length>0?[]:e)),o||n||r||(re.closePropertyPanel(),(0,H.Dm)(null),(0,H.PS)(!1),K(!1),q(),(0,H.k$)(!1)),i||(0,H.k$)(!1),X&&!a&&ve()}),[ce,de,X,W,re,K,q,ve]),ze=(0,a.useRef)(0),Ue=(0,l.Zl)(R.GS),We=(0,x.s)(),qe=(0,x.s)(),Ke=(0,ka.Z)();if((0,a.useEffect)((()=>{var e;null!==_&&void 0!==_&&_.mutationErrorModal&&0!==pe.length&&(pe[0].gqlErrors&&"Not Authorised!"===(null===(e=pe[0].gqlErrors[0])||void 0===e?void 0:e.message)?(s.v.addAction("showSessionErrorModal",{errorEdits:pe}),qe.open()):(s.v.addAction("showMutationErrorModal",{errorEdits:pe}),We.open()))}),[pe,null===_||void 0===_?void 0:_.mutationErrorModal,We,qe]),(0,a.useEffect)((()=>{var e;const t=!(null===(e="cl8t9mtgr3144354v7xr4gn6cil,cl87q63j59832314v9olin8ij08,cl94ocnr82784764u5etg10rltp,clabpa1uk930704u8nbyxrumct,clbzdtalb0001853y4f6m6z8q")||!e.split(",").includes(d.id));ne(t)}),[ne,d.id]),!k&&Z)return null;const Ye=(0,ql.$Q)(d);return(0,S.jsx)(Pi.Z,{tomeId:d.id,children:(0,S.jsx)(M.e,{children:(0,S.jsx)(uo.N,{children:(0,S.jsxs)(Yp.G,{children:[(0,S.jsx)(Pu,{triggerTomeRefetch:h}),(0,S.jsx)(tf,{pages:d.pages,presentMode:J,isMobile:j}),(0,S.jsx)(Sd,{id:i,tome:d}),(0,S.jsx)(Td,{tome:d}),(0,S.jsxs)(N.dK.Provider,{value:{outlineRef:Re,toolbarRef:Le,propertyPanelRef:Ne,currentPageRef:He,commentsSheetRef:Ve,expandedTileRef:Be,onboardingAutotomeRef:Fe,titleEditableLabelRef:$e},children:[(0,S.jsx)(yu,{ref:Fe}),(0,S.jsx)(Qh,{setKeyboardEnabled:me,tomeId:d.id,isEmptyTome:Ye,canEditDynamic:fe}),(0,S.jsxs)(of,{$isMobile:j,"data-testid":"tome_styles",style:{backgroundColor:J||j?O.colors.page:O.colors.background},onClickCapture:Oe,onPointerDownCapture:Pe,onPointerUpCapture:je,onDragEnter:e=>{fe&&(0,tu.C)(e)&&(ze.current+=1,1===ze.current&&Ue(!0))},onDragLeave:e=>{fe&&(0,tu.C)(e)&&(ze.current-=1,0===ze.current&&Ue(!1))},onDrop:e=>{(0,tu.C)(e)&&(e.preventDefault(),fe&&(ze.current=0,Ue(!1)))},onDragOver:e=>{(0,tu.C)(e)&&e.preventDefault()},children:[j&&(0,S.jsx)(Cu,{visible:we}),!u&&(0,S.jsx)(ga,{tomeId:d.id}),!j&&(0,S.jsx)(vd,{tome:d,presentMode:J,expandMode:ee,enterPresentMode:Ce,exitPresentMode:xe}),j&&(0,S.jsx)(tl,{isInExpandMode:ee,tome:d}),(0,S.jsxs)(nf,{onMouseDown:Ge,children:[!j&&(0,S.jsx)(v.Z,{presentMode:J||!!X,skipPresentModeAnimation:z,transition:I.Oo,children:(0,S.jsx)(ef,{tome:d,width:Ie,canEdit:fe,onAddPage:be,showLayoutSelection:$,setShowLayoutSelection:G})}),oe&&(null===d||void 0===d||null===(r=d.pages)||void 0===r?void 0:r[0].overlay)&&(0,S.jsx)(Su,{overlayData:d.pages[0].overlay,isMobile:j,pages:d.pages,tomeId:d.id,sliderRef:Te}),ue&&(0,S.jsx)(Fu,{isInExpandMode:ee,enterPresentMode:Ce,exitPresentMode:xe,exitExpandMode:ve,tome:d,canEdit:fe,presentMode:J,setShowLayoutSelection:G}),(0,S.jsx)(Tp,{ref:Te,isBot:u,isMobile:j,isInExpandMode:ee,canEdit:fe,useEditablePage:ge,presentMode:J,fullscreenMode:te,tome:d,width:le||0,pageContainerWidth:Se,pageContainerHeight:ke,pageVerticalMargin:Ze}),(0,S.jsxs)(v.Z,{presentMode:J||!!X,skipPresentModeAnimation:z,transition:I.Oo,children:[ie&&(0,S.jsx)(pa,{width:Ee,style:Me,ref:De,height:ae||0,tome:d,toolbarWidth:_e}),!j&&fe&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(Kp,{height:ae||0,width:_e})})]}),!u&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(p.M,{children:J&&(0,S.jsx)(D,{height:ae||0,width:_e,resetToFullCanvas:ye})}),(0,S.jsx)(ha.Z,{subscribeTo:H.x0})]})]}),(0,S.jsx)(v.Z,{presentMode:J||!!X,skipPresentModeAnimation:z,transition:I.Oo,children:(0,S.jsx)(nu.W,{children:!j&&(0,S.jsx)(C.Z,{})})}),!ee&&(0,S.jsx)(v.Z,{presentMode:!J||j,skipPresentModeAnimation:z,children:(0,S.jsx)(ja,{pages:d.pages,isFullscreen:te})}),Ke&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.Z,{ref:We.ref,title:w("components.tome.errorSyncing.tomeErrorSyncingModalTitle"),subtitle:w("components.tome.errorSyncing.tomeErrorSyncingModalSubtitle"),primaryButtonContent:w("components.tome.errorSyncing.reloadButtonLabel"),primaryButtonAction:()=>{var e,t;null===(e=window)||void 0===e||null===(t=e.location)||void 0===t||t.reload()},cancelButtonText:w("components.tome.errorSyncing.cancelButtonLabel"),cancelButtonAction:()=>{We.close()},buttonColor:"default",dismissible:!0}),(0,S.jsx)(x.Z,{ref:qe.ref,title:w("components.tome.sessionExpired.sessionExpiredErrorModalTitle"),subtitle:w("components.tome.sessionExpired.sessionExpiredErrorModalSubtitle"),primaryButtonContent:w("components.tome.sessionExpired.signInButtonLabel"),primaryButtonAction:()=>{window.location.href=(0,hs.bM)(B)},cancelButtonText:w("components.tome.sessionExpired.cancelButtonLabel"),cancelButtonAction:()=>{qe.close()},buttonColor:"default",dismissible:!0}),(0,S.jsx)(Je.n,{})]}),Ke&&(0,S.jsx)(xu,{tomeId:d.id})]})]})]})})})})},lf=o(69103),sf=o(52322),cf=o(8423);const df=e=>{var t;let{guestId:o}=e;const{t:n}=(0,y.$G)(),{data:r}=(0,z.lt1)({variables:{id:o}}),i=null===r||void 0===r||null===(t=r.guestInvite)||void 0===t?void 0:t.email;if(!i)return null;const a=n("components.accessError.thisLinkWasSentToInviteEmailExtraMessage",{inviteEmail:i});return(0,S.jsx)(S.Fragment,{children:a})};var pf=e=>{let{email:t,guestId:o}=e;const n=(0,g.useRouter)(),{t:r}=(0,y.$G)();return t?(0,S.jsx)(cf.Z,{mainMessage:r("components.accessError.youDoNotHaveAccessToThisTomeMainErrorMessage"),children:(0,S.jsxs)(cf.N,{children:[o&&(0,S.jsx)(df,{guestId:o}),r("components.accessError.youAreSignedInAsEmailMessage",{email:t}),(0,S.jsx)(Ta(),{href:(0,hs.bM)(n),children:r("components.accessError.signInLinkInAccessErrorPage")}),r("components.accessError.withADifferentAccount")]})}):(0,S.jsx)(lf.default,{})},uf=o(76610),mf=o(87174);const gf=["id","loadingTheme","preloadFontData"];function hf(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ff(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hf(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hf(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function bf(e){const t=null===e||void 0===e?void 0:e.currentUserPermission;return!(!(null===e||void 0===e?void 0:e.publicScope)||"PUBLIC"!==(null===t||void 0===t?void 0:t.how))||!(!t||!Bs(t))}const yf=e=>{let{id:t,fetchFullPage:o,isBot:n,isMobileFromUA:r,loadingTheme:i,ssrTome:c,preloadFontData:d,preferCache:p}=e;const u=(0,l.sJ)(H.Vx),{activePageRef:m}=(0,ci.R)(),{loading:g,error:h,data:f,refetch:b}=(0,z.OWl)({variables:{id:t,fetchFullPage:o,prefetchPreviewImage:!1},fetchPolicy:p?"cache-first":"network-only",nextFetchPolicy:"cache-first",errorPolicy:"all"}),{loading:y,data:C}=(0,z.UEB)({errorPolicy:"all"}),v=(0,l.Zl)(sf.Z);(0,a.useEffect)((()=>function(){v(!1)}),[v]);const x=function(e){let{meData:t,meQueryLoading:o,tomeData:n,tomeQueryLoading:r,ssrTome:i}=e;const a=o?null:!t;let l;return l=i?bf(i):r?null:bf(n),!0===a||!0===l||(null===a||null===l?null:a||l)}({meData:null===C||void 0===C?void 0:C.me,meQueryLoading:y,tomeData:null===f||void 0===f?void 0:f.tome,tomeQueryLoading:g,ssrTome:c});(0,a.useEffect)((()=>{null!==x&&(0,H.oG)(x)}),[x]);const O=x||r,P=(null===f||void 0===f?void 0:f.tome)??(O?c:null);if((g||y)&&!c)return(0,S.jsx)(np.Z,{theme:i,preloadFontData:d,children:(0,S.jsx)(uf.Z,{})});if(s.v.addAction("get_tome"),h){let e=!1;"undefined"!==typeof document&&(e=document.hasFocus()),s.v.addError(h,{hasFocus:e});const t=new URL(window.location.href);if(t.searchParams.get("promptLogin"))return(0,S.jsx)(mf.Z,{});const o=t.searchParams.get("guest");return null!==C&&void 0!==C&&C.me?(0,S.jsx)(pf,{email:null===C||void 0===C?void 0:C.me.email,guestId:o}):(0,S.jsx)(lf.default,{})}if(!P)return null;const j=(0,V.yW)(P.pages,u);return(0,S.jsx)(np.Z,{theme:null===j||void 0===j?void 0:j.theme,themeRef:m,activeBodyTheme:!0,loadFonts:!0,preloadFontData:d,children:(0,S.jsx)(af,{id:t,triggerTomeRefetch:b,tome:P,isBot:n,isMobileFromUA:r})})},Cf=e=>{const{id:t,loadingTheme:o,preloadFontData:n}=e,r=(0,i.Z)(e,gf);return t?(0,S.jsx)(yf,ff(ff({},r),{},{id:t,loadingTheme:o,preloadFontData:n})):(0,S.jsx)(np.Z,{theme:o,preloadFontData:n,children:(0,S.jsx)(uf.Z,{})})};var vf=yf},17386:function(e,t,o){o.d(t,{Z:function(){return P}});var n=o(67294),r=o(59016),i=o(4298),a=o.n(i),l=o(1922),s=o(53098),c=o(71515),d=o(34136),p=o(79297),u=o(24233),m=o(46295),g=o(59499),h=o(24306),f=o(85893);function b(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function y(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?b(Object(o),!0).forEach((function(t){(0,g.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):b(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var C=(0,n.forwardRef)(((e,t)=>(0,f.jsx)(h.Z,y(y({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,f.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M52.4973 56H11.5058V56C10.6712 55.9979 9.99628 55.3195 9.99842 54.4848C9.99854 54.4362 10.001 54.3876 10.0058 54.3392C10.677 47.5048 17.7956 40 32.0015 40C46.2074 40 53.3256 47.5048 53.997 54.3392V54.3392C54.0796 55.1698 53.4732 55.91 52.6426 55.9926C52.5944 55.9974 52.5459 55.9999 52.4973 56V56ZM32.0015 36C25.6 36 20.0082 30.4443 20.0082 21.5C20.0082 13.8 24.85 8 32.0015 8C39.153 8 43.995 13.8 43.995 21.5C43.995 30.4443 38.4032 36 32.0015 36Z"})})))),v=o(9576),x=o(30829);const O=(0,r.ZP)(d.Z).withConfig({displayName:"Help__Button",componentId:"me7xf8-0"})(["width:40px;height:40px;z-index:",";"],s.bf);var P=()=>{const e=(0,r.Fg)(),{t:t}=(0,l.$G)(),o=(0,f.jsx)(p.Z,{style:{width:e.largerIconSize,height:e.largerIconSize}}),i=t("components.help.helpIconTooltiplabel"),s=(0,n.useCallback)((()=>{window.open("https://tome.app/tomecommunity/help-and-support-guide-cl4g57jlc4983274wc2flzoz9np","_blank")}),[]),d=(0,n.useCallback)((()=>{window.open("https://tome.app/tomecommunity/tome-getting-started-guide-cl5sigulu1899274x5iqictrjgv","_blank")}),[]),g=(0,n.useCallback)((()=>{window.open("https://calendly.com/use-tome/personal-tour","_blank")}),[]),h=(0,n.useCallback)((()=>{window.Intercom&&window.Intercom("show")}),[]),b=(0,n.useMemo)((()=>[{type:"option",text:t("components.help.gettingStartedGuideMenuItemLabel"),action:d,image:(0,f.jsx)(x.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.helpAndSupportGuideMenuItemLabel"),action:s,image:(0,f.jsx)(v.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.sendUsAMessageMenuItemLabel"),action:h,image:(0,f.jsx)(m.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.scheduleAPersonalTourMenuItemLabel"),action:g,image:(0,f.jsx)(C,{style:{width:16,height:16,marginRight:8}})}]),[g,h,s,d,t]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a(),{id:"intercom-settings",children:'\n        window.intercomSettings = {\n          api_base: "https://api-iam.intercom.io",\n          app_id: "qsgvgurd",\n          hide_default_launcher: true,\n        };      \n      '}),(0,f.jsx)(a(),{id:"intercom-script-load",strategy:"lazyOnload",children:"\n          (function(){var w=window;var ic=w.Intercom;if(typeof ic===\"function\"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/qsgvgurd';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();\n        "}),(0,f.jsx)(u.Z,{itemsOrFn:b,menuWidth:208,menuPosition:"above",menuAlign:"right",additionalSpacing:-8,children:(0,f.jsx)(c.Z,{content:i,children:(0,f.jsx)(O,{variant:"text","aria-label":i,onClick:()=>{},onZ0:!0,iconOpacity:.5,icon:o})})})]})}},39346:function(e,t,o){var n=o(59499),r=o(4730),i=o(67294),a=o(59016),l=o(85893);const s=["$visible","children","component"];function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const p=a.ZP.span.withConfig({displayName:"Badge__StyledComponent",componentId:"sc-1yq5677-0"})(["position:relative;"]),u=a.ZP.span.withConfig({displayName:"Badge__BadgeDisplay",componentId:"sc-1yq5677-1"})(["opacity:",";display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center;align-content:center;align-items:center;position:absolute;box-sizing:border-box;z-index:1;border-radius:","px;height:","px;width:","px;padding:0;background-color:",";border:1px solid ",";top:","px;right:","px;"],(e=>e.$visible?1:0),4,8,8,(e=>e.theme.colors.uiAccent),(e=>e.theme.colors.background),2,2),m=(0,i.forwardRef)(((e,t)=>{const{$visible:o=!0,children:n,component:i="span"}=e,a=(0,r.Z)(e,s);return(0,l.jsxs)(p,d(d({as:i,ref:t},a),{},{children:[(0,l.jsx)(u,{$visible:o}),n]}))}));t.Z=m},94717:function(e,t,o){o.d(t,{Y:function(){return r},Z:function(){return i}});var n=o(59016);const r=n.ZP.button.withConfig({displayName:"BaseButton",componentId:"sc-11h1mi2-0"})(["font-size:",";color:",";background:",";"," &:hover{background:",";}"],(e=>e.theme.fontSizes.xs),(e=>e.theme.colors.contrast),(e=>e.selected?e.theme.colors.buttonTransparentBackgroundSelected:e.theme.colors.transparent),(e=>e.disabled&&"\n    opacity: 0.4;\n  "),(e=>e.selected?e.theme.colors.buttonTransparentBackgroundSelectedHover:e.theme.colors.buttonTransparentBackgroundHover)),i=(0,n.ZP)(r).withConfig({displayName:"BaseButton__BaseFilledButton",componentId:"sc-11h1mi2-1"})(["background:",";&:hover{background:",";}"],(e=>e.selected?e.theme.colors.buttonFilledBackgroundSelected:e.theme.colors.buttonFilledBackground),(e=>e.selected?e.theme.colors.buttonFilledBackgroundSelectedHover:e.theme.colors.buttonFilledBackgroundHover))},35247:function(e,t,o){o.d(t,{Z:function(){return u}});var n,r=o(59016),i=o(67294);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},a.apply(this,arguments)}var l=function(e){return i.createElement("svg",a({width:39,height:37,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.667 16.855l9.79 14.022L34.406.867a2.001 2.001 0 013.05-.279c.696.732.768 1.857.172 2.672L15.49 34.97a2.482 2.482 0 01-4.07 0L.446 19.25a2.088 2.088 0 01.17-2.672 2.002 2.002 0 013.051.278z",fill:"#fff"})))},s=o(85893);const c=r.ZP.div.withConfig({displayName:"Checkbox__CheckboxContainer",componentId:"t8fn8-0"})(["position:relative;width:","px;height:","px;"],(e=>e.width),(e=>e.height)),d=r.ZP.input.attrs({type:"checkbox"}).withConfig({displayName:"Checkbox__CheckboxInput",componentId:"t8fn8-1"})(["position:absolute;top:0;left:0;opacity:0;height:100%;width:100%;cursor:pointer;"]),p=r.ZP.div.withConfig({displayName:"Checkbox__CheckboxBase",componentId:"t8fn8-2"})(["width:100%;height:100%;background:",";border-radius:2px;display:flex;align-items:center;justify-content:center;"],(e=>e.checked?e.theme.colors.uiAccent:e.theme.colors.contrast8));var u=e=>{let{id:t,height:o,width:n,checked:r,onClick:i}=e;return(0,s.jsxs)(c,{height:o,width:n,children:[(0,s.jsx)(d,{id:t,"data-testid":t,onClick:()=>i?i():null,checked:r,readOnly:!0}),(0,s.jsx)(p,{checked:r,children:r&&(0,s.jsx)(l,{viewBox:"-10 -10 60 60"})})]})}},54232:function(e,t,o){o.r(t),o.d(t,{default:function(){return ie}});var n=o(62830),r=o.n(n),i=o(67294),a=o(64310),l=o(1922),s=o(51718),c=o(50135),d=o(60864),p=o(59499),u=o(4730),m=o(82273),g=o(1150),h=o(28670),f=o.n(h),b=o(90574),y=o(24306),C=o(85893);function v(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function x(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?v(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var O=(0,i.forwardRef)(((e,t)=>(0,C.jsx)(y.Z,x(x({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,C.jsx)("path",{d:"M33.1779 26.6645L37.3671 30.8535C38.256 31.7395 38.2583 33.1783 37.3724 34.0672C37.3709 34.0686 37.3695 34.0701 37.368 34.0715L21.555 49.8569C17.9355 53.4769 14.6766 51.7988 12.9542 53.5211C12.2418 54.1422 11.1887 54.1695 10.445 53.5862C9.86205 52.8424 9.88937 51.7895 10.5101 51.0769C12.2326 49.3546 10.5548 46.096 14.1743 42.4769L29.96 26.6636H29.96C30.8462 25.7753 32.2848 25.7735 33.1731 26.6597C33.1747 26.6613 33.1763 26.6629 33.1779 26.6645V26.6645ZM52.4868 18.9818L45.0624 26.4L46.0251 27.362C47.3262 28.6516 47.3354 30.7517 46.0458 32.0528C44.7562 33.3538 42.6561 33.363 41.355 32.0734C41.3475 32.0659 41.3399 32.0584 41.3324 32.0508L31.9471 22.6733C30.6523 21.3774 30.6532 19.2772 31.9491 17.9824C33.245 16.6876 35.3452 16.6885 36.64 17.9844L37.6329 18.9764L45.0573 11.5583V11.5583C47.1073 9.50657 50.4323 9.50512 52.4841 11.5551C54.5358 13.605 54.5373 16.9301 52.4873 18.9818H52.4868Z"})})))),P=o(16963),j=o(88902),w=o(65890),T=o(24233),I=o(40105),E=o(31343),_=o(34136),S=o(59016),k=o(38621);const Z=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SaturationWrapper",componentId:"sc-1s5frs-0"})(["height:140px;position:relative;border-radius:8px;margin:0 12px;overflow:hidden;"]),D=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SaturationInnerWrapper",componentId:"sc-1s5frs-1"})(["width:100%;height:100%;"]),M=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__HueWrapper",componentId:"sc-1s5frs-2"})(["width:100%;height:8px;margin:12px 0;position:relative;.hue-horizontal{border-radius:4px;width:auto;margin:0 12px;}"]),R=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerContainer",componentId:"sc-1s5frs-3"})(["width:14px;height:14px;transform:",";"],(e=>e.$isHue?"translate(-7px, -3px);":"translate(-7px, -7px);")),A=S.ZP.div.attrs((e=>({style:{backgroundColor:`hsl(${e.$hue}, 100%, 50%)`}}))).withConfig({displayName:"ColorPickerPanelstyles__PickerInner",componentId:"sc-1s5frs-4"})(["width:8px;height:8px;top:3px;left:3px;border-radius:100%;position:absolute;box-shadow:inset 0px 0.5px 1.5px rgba(0,0,0,0.25);"]),L=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerOuter",componentId:"sc-1s5frs-5"})(["width:14px;height:14px;border-radius:100%;background-color:transparent;position:absolute;border:3px solid white;box-shadow:0px 0.5px 1.5px rgba(0,0,0,0.25);"]),N=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerInputsContainer",componentId:"sc-1s5frs-6"})(["display:flex;padding:0 12px 12px 12px;gap:8px;"]),H=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__ColorPickerOverlay",componentId:"sc-1s5frs-7"})(["position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:transparent;"]),V=()=>(0,C.jsx)(R,{"data-testid":"saturation_picker",children:(0,C.jsx)(L,{})}),B=e=>{let{hsl:t}=e;return(0,C.jsxs)(R,{$isHue:!0,"data-testid":"hue_picker",children:[(0,C.jsx)(L,{}),(0,C.jsx)(A,{$hue:t.h})]})},F=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__WorspaceColorsContainer",componentId:"sc-1s5frs-8"})(["padding:0 12px 12px 12px;"]),$=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__WorkspaceSwatches",componentId:"sc-1s5frs-9"})(["display:flex;flex-direction:row;flex-wrap:wrap;gap:8px;margin-top:9px;"]),G=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SwatchLabel",componentId:"sc-1s5frs-10"})(["font-size:",";color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),z=S.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__EmptyStateLabel",componentId:"sc-1s5frs-11"})(["font-size:",";color:",";text-align:center;padding:0px 22px;margin:4px 0px;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),U=(0,S.ZP)(k.Z).attrs((e=>{let{color:t,theme:o}=e;return{style:{backgroundColor:t,borderColor:(0,w.D1)({foregroundColorHex:t,backgroundColorHex:o.RAW_VALUES_LEGACY.sidebar})}}})).withConfig({displayName:"ColorPickerPanelstyles__Swatch",componentId:"sc-1s5frs-12"})(["height:24px;width:24px;border-radius:100%;border-width:1px;border-style:solid;"]),W=(0,i.createContext)({}),q=e=>{let{children:t,workspaceColors:o,workspaceColorsEnabled:n,addNewWorkspaceColor:r}=e;return(0,C.jsx)(W.Provider,{value:{workspaceColors:o,workspaceColorsEnabled:n,addNewWorkspaceColor:r},children:t})};var K=W,Y=o(96012),J=o(22111);const X=(0,S.ZP)(Y.Z).withConfig({displayName:"CustomColorInput__StyledInput",componentId:"fdmdnz-0"})(["margin:0px;min-height:unset;height:28px;padding-left:12px;user-select:text;text-transform:uppercase;:focus{outline:1px "," solid;}"],(e=>{let{theme:t}=e;return t.colors.uiAccent}));var Q=e=>{let{value:t,onChangeComplete:o}=e;const{0:n,1:r}=(0,i.useState)(t),a=(0,i.useRef)(null);(0,i.useEffect)((()=>{r(t)}),[t]);const l=(0,i.useCallback)((e=>{r(e.target.value)}),[]),s=(0,i.useCallback)((()=>{const e=n.trim();if((0,J.B)(e)){const i=f()(e).hex();i!==t&&o(i),n!==t&&r(i)}else r(t)}),[n,o,t]),c=(0,i.useCallback)((e=>{e.preventDefault(),a.current&&a.current.blur()}),[]);return(0,i.useEffect)((()=>{const e=a.current;return e&&e.addEventListener("blur",s),()=>{e&&e.removeEventListener("blur",s)}}),[s]),(0,C.jsx)("form",{onSubmit:c,children:(0,C.jsx)(X,{ref:a,variant:"fill",autoComplete:"false",spellCheck:"false",value:n,onChange:l})})};const ee=["onChange","customOnChangeComplete"];function te(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function oe(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?te(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):te(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ne=(0,m.iS)((e=>{let{onChange:t,customOnChangeComplete:o}=e,n=(0,u.Z)(e,ee);const r=(0,E.s)(),{0:a,1:s}=(0,i.useState)({hue:!1,saturation:!1}),{workspaceColors:c,workspaceColorsEnabled:p,addNewWorkspaceColor:m}=(0,i.useContext)(K),h=c.map((e=>e.toLowerCase())),y=(0,i.useCallback)((e=>{null===o||void 0===o||o(e),null===t||void 0===t||t(e)}),[o,t]),v=(0,i.useCallback)((()=>{(new EyeDropper).open().then((e=>{if(e&&null!==e&&void 0!==e&&e.sRGBHex){const n=f()(e.sRGBHex).hex();null===t||void 0===t||t(n),o&&o(n)}})).catch((()=>{}))}),[t,o]),{t:x}=(0,l.$G)(),P=(0,i.useCallback)((()=>{n.hex&&h.includes(n.hex)?(0,d.ak)({message:x("library.colorPickerPanel.handleAddWorkspaceColorClickMessage")}):r.open()}),[n.hex,h,r,x]),j=(0,i.useCallback)((()=>{r.close()}),[r]),w=(0,i.useCallback)((()=>{n.hex&&m(n.hex),r.close()}),[m,n.hex,r]),T=(0,i.useCallback)((()=>{o&&o(n.hex),s((()=>({hue:!1,saturation:!1})))}),[o,n.hex]),I=(0,i.useCallback)((e=>{s((t=>oe(oe({},t),{},{[e]:!0})))}),[s]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(E.Z,{ref:r.ref,title:x("library.colorPickerPanel.confirmationModalTitle"),subtitle:x("library.colorPickerPanel.subtitleShareMessage"),cancelButtonText:x("library.colorPickerPanel.cancelButton"),cancelButtonAction:j,primaryButtonContent:x("library.colorPickerPanel.saveButton"),primaryButtonAction:w,buttonColor:"default",dismissible:!0}),(0,C.jsx)(Z,{"data-testid":"saturation_panel",children:(0,C.jsxs)(D,{onMouseUp:T,onMouseDown:()=>I("saturation"),children:[a.saturation&&(0,C.jsx)(H,{}),(0,C.jsx)(g.OQ,oe(oe({},n),{},{onChange:t,pointer:V}))]})}),(0,C.jsxs)(M,{onMouseUp:T,onMouseDown:()=>I("hue"),"data-testid":"hue_panel",children:[a.hue&&(0,C.jsx)(H,{}),(0,C.jsx)(g.PS,oe(oe({},n),{},{onChange:t,pointer:B}))]}),(0,C.jsxs)(N,{children:[" ",window.EyeDropper&&(0,C.jsx)(_.Z,{"aria-label":x("library.colorPickerPanel.ariaLabel.eyeDropper"),startIcon:(0,C.jsx)(O,{style:{width:18,height:18}}),style:{height:28,width:36,minWidth:36,padding:"0 10px"},iconStyles:{margin:0},onClick:v}),(0,C.jsx)(Q,{value:n.hex||"",onChangeComplete:y}),p&&(0,C.jsx)(_.Z,{value:n.hex,"aria-label":x("library.colorPickerPanel.ariaLabel.addWorkspaceColor"),startIcon:(0,C.jsx)(b.Z,{style:{width:18,height:18}}),style:{height:28,width:36,minWidth:36,padding:"0 10px"},iconStyles:{margin:0},onClick:P})]})]})}));var re=e=>{let{setColor:t,setColorComplete:o,color:n,workspaceColors:r=[],addNewWorkspaceColor:a,removeWorkspaceColor:s}=e,c=n??"#000000";"black"===n||"dark"===n?c="#000000":"light"===n&&(c="#ffffff");const d=(0,j.ye)(j.TT.WORKSPACE_COLORS),p=(0,E.s)(),u=(0,i.useRef)(null),{t:m}=(0,l.$G)(),g=(0,i.useCallback)((e=>{t(e.hex)}),[t]),h=(0,i.useCallback)((e=>{t(e.target.value),null===o||void 0===o||o(e.target.value)}),[t,o]),f=(0,I.Z)((e=>()=>{u.current=e,p.open()}),[p]),b=(0,i.useCallback)((()=>{u.current=null,p.close()}),[p]),y=(0,i.useCallback)((()=>{u.current&&(s(u.current),u.current=null),p.close()}),[s,p]);return(0,C.jsxs)("div",{"data-testid":"color_picker",children:[(0,C.jsx)(q,{workspaceColors:r,addNewWorkspaceColor:a,workspaceColorsEnabled:d,children:(0,C.jsx)(ne,{color:c,onChange:g,customOnChangeComplete:o})}),d&&(0,C.jsxs)(F,{children:[(0,C.jsx)(E.Z,{ref:p.ref,title:m("library.colorPickerPanel.deleteColorTitle"),subtitle:m("library.colorPickerPanel.deleteColorMessage"),cancelButtonText:m("library.colorPickerPanel.cancelButton"),cancelButtonAction:b,primaryButtonContent:m("library.colorPickerPanel.deleteButton"),primaryButtonAction:y,dismissible:!0,buttonColor:"destructive"}),r.length>0&&(0,C.jsxs)("div",{children:[(0,C.jsx)(G,{children:m("library.colorPickerPanel.workSpace")}),(0,C.jsx)($,{"data-testid":"workspace_swatches",children:r.map((e=>(0,C.jsx)(T.Z,{menuWidth:140,menuPosition:"below",menuAlign:"click",rightClickActivated:!0,itemsOrFn:[{text:`${m("library.colorPickerPanel.deleteSavedColorButton")}`,action:f(e),variant:"destructive"}],children:(0,C.jsx)(U,{selected:n===e,disabled:n===e,title:e,color:e,value:e,onClick:h,children:n===e&&(0,C.jsx)(P.Z,{style:{scale:.5,fill:(0,w.YC)(e),height:"100%",width:"100%"}})})},e)))})]}),0===r.length&&(0,C.jsx)(z,{"data-testid":"empty_workspace_colors_label",children:m("library.colorPickerPanel.clickPlusButtonMessage")})]})]})};var ie=e=>{var t,o,n,p,u,m,g,h,f;let{color:b,setColor:y,setColorComplete:v}=e;const{tomeId:x}=(0,i.useContext)(c.z),[O]=(0,s.bpV)(),[P]=(0,s.gG)(),{data:j,refetch:w}=(0,s.OWj)({variables:{tomeId:x},fetchPolicy:"network-only",nextFetchPolicy:"cache-first"}),T=null===j||void 0===j||null===(t=j.tome)||void 0===t||null===(o=t.org)||void 0===o||null===(n=o.colors)||void 0===n?void 0:n.map((e=>e.hex)),{t:I}=(0,l.$G)(),E=(0,i.useCallback)((e=>{var t,o;const n=null===j||void 0===j||null===(t=j.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id;if(!n)return;const i=r()();O({variables:{colorId:i,orgId:n,colorHex:e},optimisticResponse:{__typename:"Mutation",createOrgColor:{__typename:"Color",id:i,hex:e,createdAt:(new Date).toISOString()}},update(e,t){let{data:o}=t;const r=null===o||void 0===o?void 0:o.createOrgColor;if(!r)return;const i=e.writeFragment({id:`Color:${r.id}`,fragment:s.gr2,data:r,fragmentName:"ColorFragment"});e.modify({id:`Organization:${n}`,fields:{colors(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i]}}})}}).catch((t=>{var o;a.v.addError(t,{colorHex:e}),null!==t&&void 0!==t&&null!==(o=t.message)&&void 0!==o&&o.includes("already exists")?((0,d.ak)({message:I("library.stateConnectedColorPicker.alreadyExistErrorMessage")}),w({tomeId:x})):(0,d.ak)({message:I("library.stateConnectedColorPicker.oopsSomethingWentWrongErrorMessage")})}))}),[O,null===j||void 0===j||null===(p=j.tome)||void 0===p||null===(u=p.org)||void 0===u?void 0:u.id,w,x,I]),_=(0,i.useCallback)((e=>{var t,o,n,r,i,l;const s=null===j||void 0===j||null===(t=j.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id,c=null===j||void 0===j||null===(n=j.tome)||void 0===n||null===(r=n.org)||void 0===r||null===(i=r.colors)||void 0===i||null===(l=i.find((t=>t.hex===e)))||void 0===l?void 0:l.id;c&&s&&P({variables:{colorId:c},optimisticResponse:{__typename:"Mutation"},update(e){e.modify({id:`Organization:${s}`,fields:{colors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:t}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>c!==t("id",e)))}}})}}).catch((t=>{a.v.addError(t,{colorHex:e}),(0,d.ak)({message:I("library.stateConnectedColorPicker.oopsSomethingWentWrongErrorMessage")}),w({tomeId:x})}))}),[P,null===j||void 0===j||null===(m=j.tome)||void 0===m||null===(g=m.org)||void 0===g?void 0:g.colors,null===j||void 0===j||null===(h=j.tome)||void 0===h||null===(f=h.org)||void 0===f?void 0:f.id,w,x,I]);return(0,C.jsx)(re,{addNewWorkspaceColor:E,removeWorkspaceColor:_,workspaceColors:T,color:b,setColor:y,setColorComplete:v})}},76610:function(e,t,o){var n=o(59016),r=o(85893);const i=n.ZP.div.withConfig({displayName:"LoadingPage__LoadingPageStyles",componentId:"sc-19nq0z-0"})(["width:100%;height:100%;background-color:",";"],(e=>e.theme.colors.page));t.Z=()=>(0,r.jsx)(i,{})},46075:function(e,t,o){o.d(t,{Z:function(){return p}});o(67294);var n=o(59016);const r=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleContainer",componentId:"sc-6bf9x0-0"})(["position:relative;width:",";height:",";background:",";transition:background-color 0.4s;margin:",";border-radius:","px;display:flex;justify-content:space-around;font-size:",";line-height:14px;font-weight:500;"],(e=>e.width),(e=>e.height),(e=>e.checked&&e.$onBgColor?e.theme.colors.toggleBackgroundOn:e.theme.colors.toggleBackgroundOff),(e=>e.margin),(e=>{let{radius:t=6}=e;return t}),(e=>e.theme.fontSizes.xs)),i=n.ZP.input.withConfig({displayName:"Togglestyles__ToggleInput",componentId:"sc-6bf9x0-1"})(["cursor:inherit;position:absolute;top:0;left:0;opacity:0;width:100%;height:100%;z-index:2;"]),a=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleSlider",componentId:"sc-6bf9x0-2"})(["position:absolute;top:0;left:0;cursor:pointer;background-color:",";transition:0.4s;width:calc(50% - 4px);height:calc(100% - 4px);border-radius:","px;margin:2px;input:checked ~ &{transform:translateX(calc(100% + 4px));}"],(e=>e.switchColor||(e.checked?e.theme.colors.toggleSliderOn:e.theme.colors.toggleSliderOff)),(e=>{let{radius:t=6}=e;return t-2})),l=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleOff",componentId:"sc-6bf9x0-3"})(["z-index:1;display:flex;flex-direction:row;justify-content:center;align-items:center;color:",";transition:0.4s;input:checked ~ &{color:rgba(255,255,255,0.35);}"],(e=>e.theme.colors.contrast)),s=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleOn",componentId:"sc-6bf9x0-4"})(["z-index:1;display:flex;flex-direction:column;justify-content:center;color:rgba(255,255,255,0.35);transition:0.4s;input:checked ~ &{color:",";}"],(e=>e.theme.colors.contrast));var c=o(85893);const d=e=>{let{offText:t,onText:o,width:n,height:d,radius:p,checked:u,onClick:m,onBgColor:g,switchColor:h,margin:f,disabled:b,inputId:y}=e;return(0,c.jsxs)(r,{width:n,height:d,radius:p,checked:u,$onBgColor:g,margin:f,children:[(0,c.jsx)(i,{id:y,checked:u,type:"checkbox",readOnly:!0,onClick:e=>{b||m(e)}}),(0,c.jsx)(a,{checked:u,switchColor:h,radius:p}),(0,c.jsx)(l,{children:t}),(0,c.jsx)(s,{children:o})]})};d.defaultProps={offText:void 0,onText:void 0,onBgColor:!1,switchColor:void 0,margin:void 0,disabled:!1,inputId:void 0};var p=d},84562:function(e,t,o){o.d(t,{q:function(){return i}});var n=o(59499),r=o(51718);class i{constructor(e,t,o){this.wireArtifactType=e,this.text=t,this.textTitleCase=o,i.values.push(this)}static getValues(){return i.values}getWireArtifactType(){return this.wireArtifactType}getText(){return this.text}getTextTitleCase(){return this.textTitleCase}}(0,n.Z)(i,"values",[]),(0,n.Z)(i,"PRESENTATION",new i(r.BzI.Presentation,"presentation","Presentation")),(0,n.Z)(i,"OUTLINE",new i(r.BzI.Outline,"outline","Outline")),(0,n.Z)(i,"STORY",new i(r.BzI.Story,"story","Story"))},7289:function(e,t,o){o.d(t,{O:function(){return i}});var n=o(59499),r=o(51718);class i{constructor(e,t,o){this.wireImageStyle=e,this.menuText=t,(0,n.Z)(this,"activeText",void 0),this.activeText=o??t,i.values.push(this)}static getValues(){return i.values}getWireImageStyle(){return this.wireImageStyle}getMenuText(){return this.menuText}getActiveText(){return this.activeText}}(0,n.Z)(i,"values",[]),(0,n.Z)(i,"AUTO",new i(r.Hnc.Auto,"Auto","Images")),(0,n.Z)(i,"CYBERPUNK",new i(r.Hnc.Cyberpunk,"Cyberpunk")),(0,n.Z)(i,"EPIC",new i(r.Hnc.Epic,"Epic")),(0,n.Z)(i,"FANTASY",new i(r.Hnc.Fantasy,"Fantasy")),(0,n.Z)(i,"NEO_IMPRESSIONIST",new i(r.Hnc.NeoImpressionist,"Neo Impressionist")),(0,n.Z)(i,"POP_ART",new i(r.Hnc.PopArt,"Pop Art")),(0,n.Z)(i,"WATERCOLOR",new i(r.Hnc.Watercolor,"Watercolor")),(0,n.Z)(i,"NONE",new i(r.Hnc.None,"No Images"))},23969:function(e,t,o){o.d(t,{BO:function(){return l},d9:function(){return a},q$:function(){return i}});var n=o(84562),r=o(7289);let i;!function(e){e.ROOT="ROOT",e.SCOPED="SCOPED",e.DELEGATE="DELEGATE"}(i||(i={}));const a={imageStyle:r.O.AUTO,artifactType:n.q.PRESENTATION};let l;!function(e){e.OUT_OF_MODERATION_ERROR="OUT_OF_MODERATION_ERROR",e.RATE_LIMIT_ERROR="RATE_LIMIT_ERROR",e.GENERIC_ERROR="GENERIC_ERROR"}(l||(l={}))},78724:function(e,t,o){o.d(t,{$C:function(){return s},br:function(){return c},uJ:function(){return d}});var n=o(67294),r=o(4480),i=o(4034),a=o(60864),l=o(23969);let s;!function(e){e.OPEN="OPEN",e.CLOSE="CLOSE",e.TOGGLE_IF_AVAILABLE="TOGGLE_IF_AVAILABLE",e.INVOKE_COMMAND="INVOKE_COMMAND"}(s||(s={}));const c=()=>{const{commandPromptIsOpen:e,controlCommandPrompt:t}=d();return{commandPromptIsOpen:e,controlCommandPrompt:t}},d=()=>{const[e,t]=(0,r.FV)(p),[o,c]=(0,r.FV)(u),[d,y]=(0,r.FV)(m),[C,v]=(0,r.FV)(g),[x,O]=(0,r.FV)(b),[P,j]=(0,r.FV)(h),w=(0,r.Zl)(f),T=(0,i.t2)(),I=(0,r.Zl)(a.xi),E=(0,r.Zl)(a.B8),_=(0,n.useCallback)((()=>{T.closePropertyPanel(),I(!1),E(!1)}),[T,I,E]),S=(0,r._8)((e=>{let{snapshot:o}=e;return e=>{switch(e.action){case s.OPEN:_(),y(!0),O(!0);break;case s.CLOSE:y(!1),O(!0);break;case s.TOGGLE_IF_AVAILABLE:if(o.getLoadable(f).getValue())break;O(!0);o.getLoadable(m).getValue()||_(),y((e=>!e));break;case s.INVOKE_COMMAND:c(!0),t(e.commandId),v(l.q$.DELEGATE),_(),y(!0)}}}),[_,y,v,c,O,t]),k=(0,r.rb)(g),Z=(0,r.rb)(p),D=(0,r.rb)(f),M=(0,n.useCallback)((()=>{k(),Z(),D()}),[D,k,Z]);return(0,n.useMemo)((()=>({commandPromptIsOpen:d,commandPromptMode:C,setCommandPromptMode:v,shouldResetCommandPromptAfterClose:P,setShouldResetCommandPromptAfterClose:j,controlCommandPrompt:S,selectedCommandId:e,setSelectedCommandId:t,resetCommandPromptState:M,directlyInvokeCommand:o,setDirectlyInvokeCommand:c,setBlockCommandPromptToggle:w,promptAnimationsEnabled:x,setPromptAnimationsEnabled:O})),[d,C,v,P,j,S,e,t,M,o,c,w,x,O])},p=(0,r.cn)({key:"selectedCommandIdState",default:null}),u=(0,r.cn)({key:"directlyInvokeCommandState",default:!1}),m=(0,r.cn)({key:"commandPromptIsOpenState",default:!1}),g=(0,r.cn)({key:"commandPromptModeState",default:l.q$.ROOT}),h=(0,r.cn)({key:"shouldResetCommandPromptAfterClose",default:!1}),f=(0,r.cn)({key:"blockCommandPromptToggleState",default:!1}),b=(0,r.cn)({key:"promptAnimationsEnabledState",default:!0})},95911:function(e,t,o){o.d(t,{Jb:function(){return d},Vh:function(){return m},ex:function(){return g},fH:function(){return c},lu:function(){return u},ub:function(){return s}});var n=o(59016),r=o(1922),i=o(34136),a=o(62820),l=o(85893);const s=n.ZP.div.withConfig({displayName:"Comments__EmptyState",componentId:"x2b2nc-0"})(["height:100%;font-size:",";display:flex;flex-direction:column;text-align:center;padding:0px 25px;align-items:center;justify-content:center;color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),c=n.ZP.div.withConfig({displayName:"Comments__CommentInputSection",componentId:"x2b2nc-1"})(["display:flex;position:relative;"]),d=n.ZP.div.withConfig({displayName:"Comments__CommentsStyle",componentId:"x2b2nc-2"})(["p{user-select:text;}"]),p=n.ZP.div.withConfig({displayName:"Comments__CommentsPermissionsMessageWrapper",componentId:"x2b2nc-3"})(["text-align:center;font-size:",";color:",";padding:12px 12px 4px 12px;display:flex;align-items:center;justify-content:center;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),u=()=>{const{t:e}=(0,r.$G)();return(0,l.jsx)(p,{children:e("comments.noPermissionToCommentText")})},m=n.ZP.div.withConfig({displayName:"Comments__ScrollableListStyles",componentId:"x2b2nc-4"})(["height:calc(100vh - 260px);overflow:auto;padding-top:10px;padding-bottom:23px;"]),g=e=>{let{error:t}=e;const{t:o}=(0,r.$G)();return t?(0,l.jsx)(m,{children:(0,l.jsxs)(s,{children:[(0,l.jsx)("p",{children:o("comments.commentsFailedToLoadText")}),(0,l.jsx)(i.Z,{onClick:()=>{window.location.reload()},children:o("comments.refreshPageButton")})]})}):(0,l.jsx)(m,{children:(0,l.jsx)(s,{children:(0,l.jsx)(a.T,{})})})}},9576:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.15 50.8536H29.15C25.5124 48.9538 21.4637 47.9769 17.36 48.0088V48.0088C15.0346 48.0305 12.7213 48.347 10.4755 48.9505V48.9505C9.88645 49.1408 9.25462 48.8176 9.0643 48.2285C9.02788 48.1158 9.00955 47.998 9.01002 47.8795V15.2637V15.2636C9.00986 14.7937 9.30188 14.3731 9.7423 14.2091H9.7423C12.211 13.4469 14.7765 13.0435 17.36 13.0112H17.36C21.981 12.956 26.5228 14.2132 30.4575 16.6369V16.6369C30.8049 16.8685 31.0126 17.2594 31.01 17.6769V49.7838V49.7838C31.0051 50.4702 30.4447 51.0226 29.7584 51.0177C29.5449 51.0162 29.3353 50.9596 29.15 50.8536H29.15ZM55.01 15.2636V47.8795V47.8795C55.0124 48.4986 54.5126 49.0024 53.8935 49.0048C53.775 49.0053 53.6572 48.9869 53.5445 48.9505V48.9505C51.2987 48.347 48.9854 48.0305 46.66 48.0088V48.0088C42.5563 47.9769 38.5076 48.9539 34.87 50.8536V50.8536C34.2743 51.1945 33.515 50.9879 33.1741 50.3921C33.068 50.2068 33.0115 49.9972 33.01 49.7836V17.6769V17.6769C33.0075 17.2594 33.2151 16.8685 33.5625 16.6369H33.5625C37.4973 14.2132 42.039 12.956 46.66 13.0112H46.66C49.2436 13.0435 51.8092 13.4469 54.278 14.2091V14.2091C54.7183 14.3733 55.0102 14.7938 55.01 15.2637V15.2636Z"})}))));t.Z=c},30362:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{d:"M12 52V28C12 26.8954 12.8954 26 14 26H24C25.1046 26 26 26.8954 26 28V52C26 53.1046 25.1046 54 24 54H14C12.8954 54 12 53.1046 12 52ZM16 49C16 49.5523 16.4477 50 17 50H21C21.5523 50 22 49.5523 22 49V47C22 46.4477 21.5523 46 21 46H17C16.4477 46 16 46.4477 16 47V49ZM16 41C16 41.5523 16.4477 42 17 42H21C21.5523 42 22 41.5523 22 41V39C22 38.4477 21.5523 38 21 38H17C16.4477 38 16 38.4477 16 39V41ZM16 33C16 33.5523 16.4477 34 17 34H21C21.5523 34 22 33.5523 22 33V31C22 30.4477 21.5523 30 21 30H17C16.4477 30 16 30.4477 16 31V33ZM50 54H32C30.8954 54 30 53.1046 30 52V12C30 10.8954 30.8954 10 32 10H50C51.1046 10 52 10.8954 52 12V52C52 53.1046 51.1046 54 50 54ZM40 15C40 14.4477 39.5523 14 39 14H35C34.4477 14 34 14.4477 34 15V17C34 17.5523 34.4477 18 35 18H39C39.5523 18 40 17.5523 40 17V15ZM40 23C40 22.4477 39.5523 22 39 22H35C34.4477 22 34 22.4477 34 23V25C34 25.5523 34.4477 26 35 26H39C39.5523 26 40 25.5523 40 25V23ZM40 31C40 30.4477 39.5523 30 39 30H35C34.4477 30 34 30.4477 34 31V33C34 33.5523 34.4477 34 35 34H39C39.5523 34 40 33.5523 40 33V31ZM40 39C40 38.4477 39.5523 38 39 38H35C34.4477 38 34 38.4477 34 39V41C34 41.5523 34.4477 42 35 42H39C39.5523 42 40 41.5523 40 41V39ZM40 47C40 46.4477 39.5523 46 39 46H35C34.4477 46 34 46.4477 34 47V49C34 49.5523 34.4477 50 35 50H39C39.5523 50 40 49.5523 40 49V47ZM48 15C48 14.4477 47.5523 14 47 14H43C42.4477 14 42 14.4477 42 15V17C42 17.5523 42.4477 18 43 18H47C47.5523 18 48 17.5523 48 17V15ZM48 23C48 22.4477 47.5523 22 47 22H43C42.4477 22 42 22.4477 42 23V25C42 25.5523 42.4477 26 43 26H47C47.5523 26 48 25.5523 48 25V23ZM48 31C48 30.4477 47.5523 30 47 30H43C42.4477 30 42 30.4477 42 31V33C42 33.5523 42.4477 34 43 34H47C47.5523 34 48 33.5523 48 33V31ZM48 39C48 38.4477 47.5523 38 47 38H43C42.4477 38 42 38.4477 42 39V41C42 41.5523 42.4477 42 43 42H47C47.5523 42 48 41.5523 48 41V39ZM48 47C48 46.4477 47.5523 46 47 46H43C42.4477 46 42 46.4477 42 47V49C42 49.5523 42.4477 50 43 50H47C47.5523 50 48 49.5523 48 49V47Z"})}))));t.Z=c},16963:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{d:"M16.6257 30.8353L26.4175 44.8488L47.3744 14.8566V14.8566C48.0067 13.9503 49.2546 13.7278 50.1617 14.3595C50.2557 14.425 50.3439 14.4983 50.4253 14.5789V14.5789C51.1212 15.3103 51.1934 16.4345 50.5967 17.2488L28.4527 48.94V48.94C27.6673 50.063 26.1194 50.3373 24.9953 49.5526C24.7565 49.3859 24.549 49.1785 24.3822 48.94L13.4034 33.2278V33.2278C12.8066 32.4134 12.8788 31.289 13.5748 30.5574V30.5574C14.3607 29.7803 15.6284 29.7868 16.4062 30.572C16.4868 30.6534 16.5602 30.7415 16.6257 30.8353H16.6257Z"})}))));t.Z=c},46295:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 38.4706V22C10 17.5817 13.5817 14 18 14H46C50.4183 14 54 17.5817 54 22V38C54 42.4183 50.4183 46 46 46H30.7241C30.2562 46 29.8032 46.164 29.4437 46.4636L21.2804 53.2664C19.9777 54.3519 18 53.4256 18 51.7299V46.4706C18 46.2107 17.7893 46 17.5294 46C13.371 46 10 42.629 10 38.4706ZM19 26C19 24.8954 19.8954 24 21 24H43C44.1046 24 45 24.8954 45 26C45 27.1046 44.1046 28 43 28H21C19.8954 28 19 27.1046 19 26ZM21 32C19.8954 32 19 32.8954 19 34C19 35.1046 19.8954 36 21 36H37C38.1046 36 39 35.1046 39 34C39 32.8954 38.1046 32 37 32H21Z"})}))));t.Z=c},47314:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M53.0208 32.0208C53.0208 34.7822 50.7822 37.0208 48.0208 37.0208C45.2594 37.0208 43.0208 34.7822 43.0208 32.0208C43.0208 29.2593 45.2594 27.0208 48.0208 27.0208C50.7822 27.0208 53.0208 29.2593 53.0208 32.0208ZM37.0208 32.0208C37.0208 34.7822 34.7822 37.0208 32.0208 37.0208C29.2594 37.0208 27.0208 34.7822 27.0208 32.0208C27.0208 29.2593 29.2594 27.0208 32.0208 27.0208C34.7822 27.0207 37.0209 29.2592 37.0209 32.0207C37.0209 32.0207 37.0209 32.0207 37.0209 32.0208H37.0208ZM16.0208 27.0208C18.7822 27.0208 21.0208 29.2593 21.0208 32.0208C21.0208 34.7822 18.7822 37.0208 16.0208 37.0208C13.2594 37.0208 11.0208 34.7822 11.0208 32.0208V32.0209C11.0208 29.2595 13.2593 27.021 16.0206 27.0209L16.0208 27.0208Z"})}));t.Z=(0,r.forwardRef)(c)},44196:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsxs)("g",{children:[(0,a.jsx)("path",{d:"M37.5 11C36.3954 11 35.5 11.8954 35.5 13C35.5 14.1046 36.3954 15 37.5 15H46.6716L30.5858 31.0858C29.8047 31.8668 29.8047 33.1332 30.5858 33.9142C31.3668 34.6953 32.6332 34.6953 33.4142 33.9142L49.5 17.8284V27C49.5 28.1046 50.3954 29 51.5 29C52.6046 29 53.5 28.1046 53.5 27V13C53.5 11.8954 52.6046 11 51.5 11H37.5Z"}),(0,a.jsx)("path",{d:"M16 22C16 20.8954 16.8954 20 18 20H22C23.1046 20 24 19.1046 24 18C24 16.8954 23.1046 16 22 16H18C14.6863 16 12 18.6863 12 22V47C12 50.3137 14.6863 53 18 53H43C46.3137 53 49 50.3137 49 47V43C49 41.8954 48.1046 41 47 41C45.8954 41 45 41.8954 45 43V47C45 48.1046 44.1046 49 43 49H18C16.8954 49 16 48.1046 16 47V22Z"})]})}))));t.Z=c},79297:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 28 28"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.0093 24.509V24.509C8.2103 24.509 3.50928 19.808 3.50928 14.009C3.50928 8.21006 8.2103 3.50903 14.0093 3.50903C19.8083 3.50903 24.5093 8.21006 24.5093 14.009V14.009C24.5093 19.808 19.8083 24.509 14.0093 24.509V24.509ZM14.0093 5.25903V5.25903C9.17678 5.25903 5.25928 9.17654 5.25928 14.009C5.25928 18.8415 9.17679 22.759 14.0093 22.759C18.8418 22.759 22.7593 18.8415 22.7593 14.009V14.0091C22.7593 9.17667 18.8418 5.25916 14.0094 5.25912L14.0093 5.25903ZM14.9937 15.759C14.9937 16.0007 14.7978 16.1965 14.5562 16.1965H13.5718V16.1965C13.3302 16.1965 13.1343 16.0007 13.1343 15.759C13.1343 12.8521 15.5952 13.126 15.5952 10.9465C15.5952 10.2216 14.7727 9.63403 13.9273 9.63403C13.0819 9.63403 12.2456 10.2216 12.2456 10.9465V10.9465C12.2427 11.1955 12.2811 11.4433 12.3594 11.6797V11.6797C12.4388 11.9067 12.3192 12.1551 12.0922 12.2346C12.0459 12.2508 11.9972 12.2591 11.9481 12.2591H11.0595V12.2591C10.8622 12.2596 10.6887 12.1285 10.6353 11.9385V11.9385C10.5481 11.6152 10.5057 11.2814 10.5093 10.9465C10.5093 9.25516 12.0762 7.88403 14.0093 7.88403C15.9424 7.88403 17.5093 9.25512 17.5093 10.9465C17.5092 13.7539 14.9936 13.6446 14.9936 15.7591L14.9937 15.759ZM14.0093 17.509V17.509C14.7342 17.509 15.3218 18.0967 15.3218 18.8215C15.3218 19.5464 14.7342 20.134 14.0093 20.134C13.2844 20.134 12.6968 19.5464 12.6968 18.8215V18.8216C12.6968 18.0967 13.2844 17.5091 14.0092 17.5091L14.0093 17.509Z"})}))));t.Z=c},30829:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M39.268 40.5977C38.6861 42.5877 38.2125 44.0192 36.198 44.0192H27.8468C25.832 44.0192 25.3583 42.5875 24.7768 40.5977C22.8344 33.9552 17.1026 31.7516 17.0268 23.1716V23.1716C16.9468 14.8894 23.5959 8.1105 31.8781 8.0305C40.1602 7.95048 46.9392 14.5996 47.0192 22.8818C47.0201 22.9784 47.0201 23.075 47.0192 23.1716C46.9423 31.7516 41.21 33.9552 39.268 40.5977V40.5977ZM27.0188 46.0194H37.0257V46.0194C38.1305 46.0194 39.0261 46.915 39.0261 48.0198C39.0261 49.1246 38.1305 50.0202 37.0257 50.0202H27.0188V50.0202C25.914 50.0202 25.0184 49.1246 25.0184 48.0198C25.0184 46.915 25.914 46.0194 27.0188 46.0194V46.0194ZM28.19 52.0199H35.8548V52.0199C36.5017 52.0201 37.026 52.5447 37.0259 53.1916C37.0259 53.1916 37.0259 53.1916 37.0259 53.1916V53.1917C37.0259 53.7223 36.8152 54.2311 36.4401 54.6063L35.6124 55.4348V55.4348C35.2376 55.8098 34.7292 56.0206 34.199 56.0206H29.8455H29.8455C29.3153 56.0206 28.8069 55.8098 28.4321 55.4348L27.6044 54.6063V54.6063C27.2295 54.231 27.0188 53.7222 27.0188 53.1917V53.1917C27.0186 52.5448 27.5428 52.0201 28.1898 52.0199C28.1898 52.0199 28.1899 52.0199 28.19 52.0199V52.0199Z"})}))));t.Z=c},37982:function(e,t,o){var n=o(59499),r=o(4730),i=o(67294),a=o(24306),l=o(85893);const s=["pathFill"];function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const p=(0,i.forwardRef)(((e,t)=>{let{pathFill:o="currentcolor"}=e,n=(0,r.Z)(e,s);return(0,l.jsx)(a.Z,d(d({ref:t,viewBox:"0 0 64 64"},n),{},{children:(0,l.jsx)("path",{fill:o,d:"M 63.648438 29.429688 L 58.011719 9.296875 C 57.792969 8.507812 57.371094 7.789062 56.792969 7.207031 C 56.210938 6.628906 55.492188 6.207031 54.703125 5.988281 L 34.570312 0.351562 C 32.886719 -0.117188 31.109375 -0.117188 29.429688 0.351562 L 9.296875 5.988281 C 8.507812 6.207031 7.789062 6.628906 7.207031 7.207031 C 6.628906 7.785156 6.207031 8.503906 5.988281 9.292969 L 0.351562 29.429688 C -0.117188 31.109375 -0.117188 32.890625 0.351562 34.570312 L 5.984375 54.707031 C 6.207031 55.496094 6.625 56.214844 7.207031 56.792969 C 7.785156 57.375 8.507812 57.792969 9.296875 58.015625 L 29.433594 63.648438 C 31.113281 64.117188 32.890625 64.117188 34.574219 63.648438 L 54.707031 58.015625 C 55.496094 57.792969 56.214844 57.371094 56.792969 56.792969 C 57.375 56.214844 57.792969 55.496094 58.015625 54.707031 L 63.648438 34.570312 C 64.117188 32.890625 64.117188 31.109375 63.648438 29.429688 Z M 58.429688 34.25 L 34.25 58.429688 C 33.953125 58.726562 33.601562 58.960938 33.214844 59.121094 C 32.832031 59.28125 32.417969 59.363281 32 59.363281 C 31.582031 59.363281 31.167969 59.28125 30.78125 59.121094 C 30.398438 58.960938 30.046875 58.726562 29.75 58.429688 L 5.570312 34.25 C 5.273438 33.953125 5.039062 33.605469 4.878906 33.21875 C 4.71875 32.832031 4.636719 32.417969 4.636719 32 C 4.636719 31.582031 4.71875 31.167969 4.878906 30.785156 C 5.039062 30.398438 5.273438 30.046875 5.570312 29.753906 L 29.75 5.570312 C 30.046875 5.273438 30.398438 5.039062 30.78125 4.878906 C 31.167969 4.722656 31.582031 4.636719 32 4.636719 C 32.417969 4.636719 32.832031 4.722656 33.214844 4.878906 C 33.601562 5.039062 33.953125 5.273438 34.25 5.570312 L 58.429688 29.753906 C 58.722656 30.046875 58.957031 30.398438 59.117188 30.785156 C 59.277344 31.167969 59.359375 31.582031 59.359375 32 C 59.359375 32.417969 59.277344 32.832031 59.117188 33.21875 C 58.957031 33.605469 58.722656 33.953125 58.429688 34.25 Z M 58.429688 34.25 "})}))}));t.Z=p},31343:function(e,t,o){o.d(t,{s:function(){return u}});var n=o(59499),r=o(67294),i=o(34136),a=o(36948),l=o(26190),s=o(67091),c=o(85893);function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function p(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const u=()=>{const e=(0,r.useRef)(),t=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.open()}),[e]),o=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.close()}),[e]);return{ref:e,open:t,close:o}},m=(0,r.forwardRef)(((e,t)=>{const{title:o,subtitle:n,children:d,cancelButtonText:u,cancelButtonAction:m,primaryButtonContent:g,primaryButtonAction:h,dismissible:f=!0,buttonColor:b,onOpen:y,onClose:C}=e,{0:v,1:x}=(0,r.useState)(!1),O=(0,r.useCallback)((()=>{x(!0),null===y||void 0===y||y()}),[y]),P=(0,r.useCallback)((()=>{x(!1),null===C||void 0===C||C()}),[C]);return(0,r.useImperativeHandle)(t,(()=>({open:O,close:P}))),(0,c.jsxs)(a.u_,{open:v,onOpenChange:e=>x(e),modal:!0,children:[(0,c.jsx)(s.kZ,{}),(0,c.jsxs)(s.If,{"data-testid":"confirmation_container",width:240,onPointerDownOutside:f?void 0:e=>{e.preventDefault()},children:[(0,c.jsxs)(s.v5,{children:[(0,c.jsx)(s.Dx,{children:o}),(0,c.jsx)(s.QE,{children:n}),d]}),(0,c.jsxs)(s.KE,{$center:!f,children:[f&&(0,c.jsx)(i.Z,{onMouseDown:l.Z,onClick:m,children:u}),(0,c.jsx)(i.Z,{color:f&&!b?"destructive":b,onMouseDown:l.Z,onClick:h,style:p({},f?{}:{width:"100%"}),children:g})]})]})]})}));t.Z=m},15814:function(e,t,o){o.d(t,{m:function(){return f}});var n=o(59499),r=o(67294),i=o(87536),a=o(59016),l=o(1922),s=o(34136),c=o(36948),d=o(96012),p=o(26190),u=o(67091),m=o(85893);function g(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function h(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?g(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const f=()=>{const e=(0,r.useRef)(),t=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.open()}),[e]),o=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.close()}),[e]);return{ref:e,open:t,close:o}},b=(0,a.ZP)(u.QE).withConfig({displayName:"PromptModal__CustomSubtitle",componentId:"ezwveb-0"})(["padding-bottom:4px;"]),y=(0,a.ZP)(u.v5).withConfig({displayName:"PromptModal__CustomContentArea",componentId:"ezwveb-1"})(["padding:12px 12px 0 12px;"]),C=(0,r.forwardRef)(((e,t)=>{const{t:o}=(0,l.$G)(),{title:n,subtitle:a,primaryButtonText:g,cancelButtonText:f=o("components.promptModal.cancelPromptModalButtonLabel"),buttonColor:C="default",placeholder:v,onSubmit:x}=e,{0:O,1:P}=(0,r.useState)(!1),j=(0,r.useCallback)((()=>{P(!0)}),[]),w=(0,r.useCallback)((()=>{P(!1)}),[]);(0,r.useImperativeHandle)(t,(()=>({open:j,close:w})));const{register:T,handleSubmit:I,formState:{isValid:E,isSubmitting:_},reset:S}=(0,i.cI)({mode:"onChange"});return(0,m.jsxs)(c.u_,{open:O,onOpenChange:e=>P(e),modal:!0,children:[(0,m.jsx)(u.kZ,{}),(0,m.jsx)(u.If,{width:240,"data-testid":"prompt_modal",onMouseDown:p.Z,children:(0,m.jsxs)("form",{onSubmit:I((e=>{x(e.prompt),w(),S()})),autoComplete:"off",children:[(0,m.jsxs)(y,{children:[(0,m.jsx)(u.Dx,{children:n}),a&&(0,m.jsx)(b,{children:a}),(0,m.jsx)(d.Z,h({variant:"fill",placeholder:v},T("prompt",{required:!0})))]}),(0,m.jsxs)(u.KE,{children:[(0,m.jsx)(s.Z,{onClick:w,children:f}),(0,m.jsx)(s.Z,{type:"submit",color:C,disabled:!E||_,children:g})]})]})})]})}));t.Z=C},67558:function(e,t,o){o.d(t,{B:function(){return C},DX:function(){return i},GJ:function(){return c},Ir:function(){return d},M$:function(){return s},WE:function(){return a},Z5:function(){return b},a4:function(){return h},c3:function(){return l},kv:function(){return f},pP:function(){return m},pf:function(){return u},tL:function(){return g},xp:function(){return y},y3:function(){return p}});var n=o(59016),r=o(60559);const i=n.ZP.div.withConfig({displayName:"UserPresencestyles__UserPresenceStyles",componentId:"sc-1urgstr-0"})(["display:flex;flex-direction:column;position:relative;"]),a=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsWrapper",componentId:"sc-1urgstr-1"})(["display:flex;flex-direction:row;align-items:center;cursor:pointer;margin-right:8px;"]),l=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsOverflow",componentId:"sc-1urgstr-2"})(["font-size:","px;font-weight:500;line-height:","px;color:",";padding:2px 6px 2px 4px;margin-left:4px;border-radius:36px;background-color:",";display:flex;"],(e=>e.$fontSize),(e=>e.$lineHeight),(e=>e.theme.colors.seenByOverflow),(e=>e.theme.colors.seenByOverflowBackground)),s=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsOverflowPlus",componentId:"sc-1urgstr-3"})(["font-size:","px;line-height:","px;"],(e=>e.$fontSize),(e=>e.$lineHeight)),c=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsBackground",componentId:"sc-1urgstr-4"})(["width:","px;background-color:",";box-shadow:",";border-radius:12px;"],r.sK,(e=>e.theme.colors.menuBackgroundLayer[0]),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow})),d=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetail",componentId:"sc-1urgstr-5"})(["width:","px;padding:4px 12px;overflow-y:auto;max-height:70vh;min-height:10px;"],r.sK),p=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailHeader",componentId:"sc-1urgstr-6"})(["height:34px;color:",";font-size:",";font-weight:500;line-height:22px;padding:18px 12px;z-index:1;padding-top:8px;"],(e=>e.theme.colors.contrast40),(e=>e.theme.fontSizes.sm)),u=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailRow",componentId:"sc-1urgstr-7"})(["display:flex;flex-direction:row;align-items:stretch;height:32px;font-size:",";line-height:17px;padding:6px 0;color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),m=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailNameLabel",componentId:"sc-1urgstr-8"})(["align-self:center;flex-grow:0;flex-shrink:0;flex-basis:auto;margin-left:8px;font-size:",";color:",";text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.seenByDetailName)),g=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailTimeLabel",componentId:"sc-1urgstr-9"})(["margin-left:4px;align-self:center;"]),h=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverWrapper",componentId:"sc-1urgstr-10"})(["width:","px;display:flex;flex-direction:column;align-items:center;margin-top:-6px;"],200),f=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverStyles",componentId:"sc-1urgstr-11"})(["background-color:",";border-radius:8px;padding:6px 8px;display:flex;flex-direction:column;align-items:center;"],(e=>e.theme.colors.tooltipBg)),b=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverName",componentId:"sc-1urgstr-12"})(["font-size:",";font-weight:500;line-height:16px;"],(e=>e.theme.fontSizes.sm)),y=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverContent",componentId:"sc-1urgstr-13"})(["margin-top:2px;font-size:",";line-height:13px;color:",";"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.tooltipSecondaryTextColor)),C=n.ZP.span.withConfig({displayName:"UserPresencestyles__GuestLabel",componentId:"sc-1urgstr-14"})(["font-size:",";color:",";margin-left:4px;"],(e=>{let{theme:t}=e;return t.fontSizes.xxs}),(e=>{let{theme:t}=e;return t.colors.guestBadgeText}))},30934:function(e,t,o){o.d(t,{Z:function(){return S}});var n=o(67294),r=o(95421),i=o(19148),a=o(47901),l=o(48811),s=o(77717),c=o(71515),d=o(85684),p=o(60559),u=o(67558),m=o(59016),g=o(1922),h=o(53098),f=o(59499),b=o(24306),y=o(85893);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){(0,f.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var x=(0,n.forwardRef)(((e,t)=>(0,y.jsxs)(b.Z,v(v({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,y.jsx)("path",{d:"M34 22C34 23.6569 32.6569 25 31 25C29.3431 25 28 23.6569 28 22C28 20.3431 29.3431 19 31 19C32.6569 19 34 20.3431 34 22Z"}),(0,y.jsx)("path",{d:"M26 30C26 28.8954 26.8954 28 28 28H32C33.1046 28 34 28.8954 34 30V39.5C34 39.7761 34.2239 40 34.5 40H37C38.1046 40 39 40.8954 39 42C39 43.1046 38.1046 44 37 44H27C25.8954 44 25 43.1046 25 42C25 40.8954 25.8954 40 27 40H29.5C29.7761 40 30 39.7761 30 39.5V32.5C30 32.2239 29.7761 32 29.5 32H28C26.8954 32 26 31.1046 26 30Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]}))));function O(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function P(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?O(Object(o),!0).forEach((function(t){(0,f.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var j=(0,n.forwardRef)(((e,t)=>(0,y.jsx)(b.Z,P(P({ref:t,style:{width:"1em",height:"1em"},viewBox:"0 0 64 64"},e),{},{children:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M52.4973 56H11.5058V56C10.6712 55.9979 9.99628 55.3195 9.99842 54.4848C9.99854 54.4362 10.001 54.3876 10.0058 54.3392C10.677 47.5048 17.7956 40 32.0015 40C46.2074 40 53.3256 47.5048 53.997 54.3392V54.3392C54.0796 55.1698 53.4732 55.91 52.6426 55.9926C52.5944 55.9974 52.5459 55.9999 52.4973 56V56ZM32.0015 36C25.6 36 20.0082 30.4443 20.0082 21.5C20.0082 13.8 24.85 8 32.0015 8C39.153 8 43.995 13.8 43.995 21.5C43.995 30.4443 38.4032 36 32.0015 36Z"})}))));const w=(0,m.ZP)(j).withConfig({displayName:"UserPresenceList__StyledAnonUserIcon",componentId:"v7nwj6-0"})(["width:20px !important;height:20px !important;flex-basis:20px;flex-shrink:0;flex-grow:0;color:",";"],(e=>{let{theme:t}=e;return t.colors.uiAccent})),T=(0,m.ZP)(x).withConfig({displayName:"UserPresenceList__StyledInfoIcon",componentId:"v7nwj6-1"})(["width:20px;height:20px;margin-left:5px;transform:translateY(5px);"]),I=m.ZP.div.withConfig({displayName:"UserPresenceList__StyledLabelIcon",componentId:"v7nwj6-2"})(["display:inline;"]),E=m.ZP.div.withConfig({displayName:"UserPresenceList__StyledLabelTimeContainer",componentId:"v7nwj6-3"})(["justify-content:space-between;display:flex;flex:1;"]);var _=e=>{let{activities:t,userOrgName:o}=e;const n=(0,m.Fg)(),{t:r}=(0,g.$G)();return(0,y.jsxs)(u.GJ,{children:[(0,y.jsx)(u.y3,{children:r("userPresence.seenByHeader")}),(0,y.jsx)(u.Ir,{children:t.map((e=>((e,t,o,n)=>{var r;return e.user?(0,y.jsxs)(u.pf,{children:[(0,y.jsx)(l.Z,{user:e.user,size:20}),(0,y.jsxs)(E,{children:[(0,y.jsx)(u.pP,{children:null===(r=e.user)||void 0===r?void 0:r.name}),(0,y.jsx)(u.tL,{children:e.label})]})]},e.activityId):(0,y.jsxs)(u.pf,{children:[(0,y.jsx)(w,{}),(0,y.jsx)(u.pP,{children:e.label}),(0,y.jsx)(I,{children:(0,y.jsx)(c.Z,{content:`Viewers outside of ${t}`,placement:"top",style:{marginTop:"-5px"},zIndex:h.y$,background:o,children:(0,y.jsx)(T,{style:{fill:n}})})})]},e.activityId)})(e,o??"",n.colors.tooltipOnSheetBg,n.colors.contrast40)))})]})};var S=e=>{let{seenHeadsViewModels:t,overflowViewModels:o,avatarSize:m,navigateToPage:g,dropShadow:h=!1,animated:f=!1,anonymousViewers:b=0,userOrgName:C=""}=e;const v=(0,n.useRef)(null),{0:x,1:O}=(0,n.useState)(!1),P=(0,n.useRef)(null),j=(0,n.useCallback)((()=>{O(!1)}),[]);if((0,a.Z)({handleClose:j,enabled:x}),0===t.length)return null;const w=t.map((e=>function(e,t,o,n,r,a,s){const c={marginLeft:"3px"};return r&&(c.filter="drop-shadow(rgba(0, 0, 0, 0.10) -2px -2px 3px)"),(0,y.jsx)(l.Z,{user:e.user,opacity:o,size:t,style:c,animated:a,renderTooltip:()=>{var t,o;return n&&(0,y.jsx)(u.a4,{children:(0,y.jsxs)(u.kv,{children:[(0,y.jsx)(u.Z5,{children:null===(t=e.user)||void 0===t?void 0:t.name}),(0,y.jsxs)(u.xp,{children:[!0===(null===(o=e.user)||void 0===o?void 0:o.isGuest)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u.B,{children:i.ZP.t("userPresence.guest")})," \xb7 "]}),e.label]})]})})},onClick:()=>null===s||void 0===s?void 0:s(e.viewingPageId)},e.activityId)}(e,m,e.isActive?1:.4,!0,h,f,g)));let T=0,I=0;if(v.current){const e=v.current.getBoundingClientRect();T=e.x+e.width/2-p.sK/2,I=e.y+e.height+8}let E=0;return E=b>0?o.length-1-t.length+b:o.length-t.length,(0,y.jsxs)(u.DX,{"data-testid":"user_presence",children:[(0,y.jsxs)(u.WE,{ref:v,children:[(0,y.jsx)(c.Z,{placement:"bottom",offset:10,ignoreWrapper:!0,withBackground:!1,children:(0,y.jsx)(r.M,{children:w})}),E>0&&(0,y.jsxs)(u.c3,{ref:P,$lineHeight:m-4,$fontSize:m-7,onMouseDown:()=>{O(!x)},children:[(0,y.jsx)(u.M$,{$lineHeight:m-4,$fontSize:m-9,children:"+"}),(0,y.jsx)("div",{children:`${E.toLocaleString()}`})]})]}),x&&(0,y.jsx)(s.Z,{left:T,top:I,zIndex:200,children:(0,y.jsx)(d.Z,{exemptContainerRefs:[P],onClick:()=>{x&&O(!1)},children:(0,y.jsx)(_,{activities:o,userOrgName:C})})})]})}},21025:function(e,t,o){o.d(t,{K3:function(){return d},Pr:function(){return l},UO:function(){return c},tQ:function(){return i}});var n=o(19148),r=o(60928);const i=e=>e>=1440?8:e>=1312?7:e>=1184?6:e>=1056?5:e>=928?4:3,a=e=>e.active?n.ZP.t("userPresence.viewingNow"):`${(0,r.Z)(e.lastTimestamp,!0,!1)}`,l=e=>{var t,o;return{user:{name:null===(t=e.user)||void 0===t?void 0:t.name,isGuest:e.isGuest??!1,profileImage:null===(o=e.user)||void 0===o?void 0:o.profileImage},label:a(e),viewingPageId:e.pageId??void 0,isActive:e.active,activityId:e.id}};function s(e,t){return e.active&&t.active?0:e.active?-1:t.active||e.lastTimestamp<t.lastTimestamp?1:e.lastTimestamp>t.lastTimestamp?-1:0}const c=e=>[...e].sort(s),d=e=>[...e].sort(s)},77759:function(e,t,o){const n=o(76661).Ps`
  mutation DELETE_TOME_MUTATION($tomeId: String!) {
    deleteTome(id: $tomeId) {
      id
    }
  }
`;t.Z=n},64972:function(e,t,o){const n=o(76661).Ps`
  mutation RESTORE_TOME_MUTATION($tomeId: String!) {
    restoreTome(id: $tomeId) {
      id
    }
  }
`;t.Z=n},81703:function(e,t,o){const n=o(50456).ZP`
  query commentsLastSeenForUserAndPage(
    $userId: String!
    $tomeId: String!
    $pageId: String!
  ) {
    commentsLastSeenForUserAndPage(
      userId: $userId
      tomeId: $tomeId
      pageId: $pageId
    ) {
      pageId
      lastViewedAt
    }
  }
`;t.Z=n},33504:function(e,t,o){var n=o(50456),r=o(51718);const i=n.ZP`
  query tile($id: String!) {
    tile(id: $id) {
      ...TileFragment
    }
  }
  ${r.mXG}
`;t.Z=i},56793:function(e,t,o){o.d(t,{Z:function(){return a}});var n=o(51718),r=o(37308),i=o(49335);function a(){const{maybeIncrementFreeTomeCreationCount:e}=(0,i.Z)(),[t]=(0,n.mTo)({update(t,o){let{data:{duplicateTome:n}}=o;(0,r.a)(t,n,e)}});return async e=>{let{tomeId:o,orgId:n,onDuplicateComplete:r,onDuplicateError:i}=e;try{const{data:e}=await t({variables:{tomeId:o,orgId:n}});if(null===e||void 0===e)return void i(new Error("No data returned from duplicate tome mutation"));const a=e.duplicateTome;if(!a)return void i(new Error("No duplicate tome returned from duplicate tome mutation"));r(a.id,a.canonicalUrl)}catch{i(new Error("Error duplicating tome"))}}}},82391:function(e,t,o){o.d(t,{w:function(){return r}});var n=o(67294);const r=["left","right","up","down","escape","enter","tab","shift+tab"];t.Z=e=>{let{options:t,selectedType:o,setSelectedType:r,didSelect:i,didEscape:a}=e;const l=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e<t.length-1&&r(t[e+1])}),[o,t,r]),s=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e>0&&r(t[e-1])}),[o,t,r]),c=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e<t.length-2&&r(t[e+2])}),[t,o,r]),d=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e>1&&r(t[e-2])}),[t,o,r]);return{onKeyDown:e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Escape","Enter"].includes(e.key)&&(!o&&t.length>0&&"Escape"!==e.key?(r(t[0]),e.preventDefault()):"ArrowRight"===e.key||"Tab"===e.key&&!e.shiftKey?(l(),e.preventDefault()):"ArrowLeft"===e.key||"Tab"===e.key&&e.shiftKey?(s(),e.preventDefault()):"ArrowUp"===e.key?(d(),e.preventDefault()):"ArrowDown"===e.key?(c(),e.preventDefault()):"Enter"===e.key?(o&&i&&i(),e.preventDefault()):"Escape"===e.key&&(a&&a(),e.preventDefault()))}}}},43002:function(e,t,o){var n=o(85518),r=o(30587),i=o(57509);t.Z=()=>{const e=(0,r.GS)(i.Hb.mobile),t=n.tq||n.Em;return n.nI?e:t}},46116:function(e,t,o){o.d(t,{JN:function(){return g},Ni:function(){return u},l1:function(){return m}});var n=o(59499),r=o(19148),i=o(51718),a=o(16344);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}const s={type:i.YUT.Text,textTileData:{content:(0,a.qV)(a.SQ.Heading)}},c={type:i.YUT.Image},d={type:i.YUT.Text,textTileData:{content:(0,a.qV)(a.SQ.Title),verticalAlignment:i.Q4P.Center,horizontalAlignment:i.KxP.Center}},p=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({type:i.YUT.Table},(0,a.vJ)(4,7,!1)),u={id:"centered-text",description:r.ZP.t("layouts.centeredTextDescription"),rows:[{tiles:[d]}]},m={id:"text",description:r.ZP.t("layouts.textDescription"),rows:[{tiles:[s]}]},g=[m,u,{id:"text+media",description:r.ZP.t("layouts.textAndMediaDescription"),rows:[{tiles:[s,c]}]},{id:"text+table",description:r.ZP.t("layouts.textAndTableDescription"),hidesSublabels:!0,rows:[{tiles:[s]},{tiles:[p]}]},{id:"media",description:r.ZP.t("layouts.mediaDescription"),rows:[{relativeHeight:1,tiles:[c]}]},{id:"three-media",description:r.ZP.t("layouts.threeMediaDescription"),rows:[{relativeHeight:1,tiles:[c,c,c]}]},{id:"media+2-text",description:r.ZP.t("layouts.mediaAndTwoTextDescription"),rows:[{relativeHeight:1.25,tiles:[c]},{relativeHeight:.75,tiles:[s,s]}]},{id:"text-media-grid",description:r.ZP.t("layouts.textAndThreeByTwoDescription"),rows:[{relativeHeight:.666667,tiles:[d]},{relativeHeight:.666667,tiles:[c,c,c]},{relativeHeight:.666667,tiles:[c,c,c]}]}]},57819:function(e,t,o){o.d(t,{I0:function(){return y},P3:function(){return g},PI:function(){return x},PS:function(){return v},QA:function(){return C},QX:function(){return P},Ti:function(){return f},VK:function(){return O},hT:function(){return h},zh:function(){return b}});var n=o(59499),r=o(62830),i=o.n(r),a=o(25934),l=o(19148),s=o(51718),c=o(81703),d=o(60864),p=o(33159);function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const g=(e,t)=>{t.comments&&t.comments.forEach((t=>{e.cache.modify({id:e.cache.identify(t),fields:{unread:()=>!1}})}))},h=(e,t)=>{const o=e.cache.readFragment({id:`Tome:${t}`,fragment:s.AKG,fragmentName:"TomeFragment",variables:{fetchFullPage:!0,prefetchPreviewImage:!1}});o&&o.pages.forEach((o=>{o.comments&&o.comments.forEach((o=>{e.cache.modify({id:e.cache.identify(o),fields:{unread:()=>((e,t,o)=>{var n;const{me:r}=e.readQuery({query:s.fkZ});if((null===t||void 0===t||null===(n=t.author)||void 0===n?void 0:n.id)===r.id)return!1;const i=e.readQuery({query:c.Z,variables:{userId:r.id,tomeId:o,pageId:t.pageId}}),a=i&&i.commentsLastSeenForUserAndPage&&i.commentsLastSeenForUserAndPage.lastViewedAt&&new Date(i.commentsLastSeenForUserAndPage.lastViewedAt).valueOf();return!!a&&a<new Date(t.createdAt).valueOf()})(e.cache,o,t)}})}))}))},f=e=>e&&e.pages&&e.pages.map((e=>e.comments&&e.comments.map((e=>e.unread)).some((e=>!0===e)))).some((e=>!0===e)),b=e=>e&&e.comments&&e.comments.map((e=>e.unread)).some((e=>!0===e)),y=(e,t)=>{var o;const{me:n}=e.readQuery({query:s.fkZ});t.unread=!0,null!==n&&void 0!==n&&n.id&&(null===t||void 0===t||null===(o=t.author)||void 0===o?void 0:o.id)===n.id&&(t.unread=!1);const r=e.writeFragment({id:`Comment:${t.id}`,fragment:s.$zS,data:t,fragmentName:"CommentFragment"});e.modify({id:`Page:${t.pageId}`,fields:{comments(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r]}}})},C=(e,t)=>{e.modify({id:e.identify(t),fields:{content:e=>t.content||e}})},v=(e,t)=>{e.modify({id:`Page:${t.pageId}`,fields:{comments(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:o}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>t.id!==o("id",e)))}}})},x=async(e,t,o,n,r,c)=>{const u=i()(),m=(0,a.Z)(),g={__typename:"User",id:o.id,name:o.name,email:o.email,profileImage:o.profileImage},h={__typename:"Comment",id:u,pageId:t.id,author:g,content:n,createdAt:(new Date).toISOString(),unread:!1};await r.mutate({mutation:s.Zso,variables:{editId:m,clientId:c,tomeId:e,pageId:t.id,commentId:u,content:n},optimisticResponse:{createComment:{__typename:"Edit",id:m,authorId:g.id,clientId:c,tomeId:e,status:"SUCCESS",comment:h}},update(e,t){let{data:o}=t;"SUCCESS"===(null===o||void 0===o?void 0:o.createComment.status)?y(e,h):(0,d.ak)({message:l.ZP.t("logic.tome.noPermissionForCommentMessage")})}}),p.ZP.reportNewCommentEvent({apolloClient:r,tomeId:e,pageId:t.id,commentId:u})},O=async(e,t,o,n,r)=>{const i=(0,a.Z)(),l=o.cache.readFragment({id:`Comment:${r}`,fragment:s.$zS,fragmentName:"CommentFragment"});l&&await o.mutate({mutation:s.ulC,variables:{editId:i,clientId:n,tomeId:e,commentId:r,content:t},optimisticResponse:{updateComment:{__typename:"Edit",id:i,authorId:l.author.id,clientId:n,tomeId:e,comment:m(m({},l),{},{content:t})}},update(e,t){let{data:o}=t;null!==o&&void 0!==o&&o.updateComment.comment&&C(e,null===o||void 0===o?void 0:o.updateComment.comment)}})};function P(e,t,o,n,r){t.mutate({mutation:s.i9U,variables:{editId:(0,a.Z)(),clientId:o,tomeId:e,commentId:n},update(e){v(e,{id:n,pageId:r})}})}},15487:function(e,t,o){o.d(t,{l_:function(){return T},Vy:function(){return x},JK:function(){return I},tj:function(){return O},ek:function(){return w},pp:function(){return v},kj:function(){return P},sR:function(){return E}});var n=o(59499),r=o(62830),i=o.n(r),a=o(25934),l=o(51718),s=o(6748),c=o(36488),d=o(16344);function p(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function u(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?p(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const m=(e,t)=>{const o=(0,d.ZP)(e.type??"TEXT",!1);return{operation:l.C8.CreateTile,id:e.tileId,tile:u(u(u({},o),{},{type:e.type,order:e.order},e.textTileData?{textTileData:e.textTileData}:{}),e.tableTileData?{tableTileData:e.tableTileData}:{}),page:{id:t}}};var g=(e,t,o,n)=>{const r={rows:t.rows.map((e=>u(u({},e),{},{tiles:e.tiles.map((e=>u(u({},e),{},{id:i()()})))})))}.rows.map((e=>({rowId:i()(),relativeHeight:e.relativeHeight??null,tiles:e.tiles.map(((e,t)=>({tileId:e.id,order:t+1,type:e.type,textTileData:e.textTileData,tableTileData:e.tableTileData})))}))),a=i()(),s=r[0].tiles[0].tileId,c={rows:r.map(((e,t)=>({rowId:e.rowId,relativeHeight:e.relativeHeight,order:t+1,tiles:e.tiles.map((e=>({tileId:e.tileId,order:e.order+1,relativeWidth:1})))})))},d=r.flatMap((e=>e.tiles.map((e=>m(e,a)))));return{apply:[{operation:l.C8.CreatePage,id:a,page:{autoThemeColor:!0,order:o,overlay:{videoStatus:l.Kwn.WaitingForCreation,videoId:null,videoThumbnailUrl:null,videoUrl:null,position:l._zJ.UpperRight},layout:c,themeId:n},tome:{id:e}},...d],revert:[{operation:l.C8.DeletePage,id:a,tome:{id:e}}],pageId:a,tileId:s}};var h=o(46116),f=o(33159),b=o(60864),y=o(95821);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e,t){let o;return o=0===t.length?1:0===e?t[0].order/2:e===t.length?t[t.length-1].order+1:(t[e-1].order+t[e].order)/2,o}function x(e,t,o,n,r){null!==r&&void 0!==r&&r.id&&f.ZP.reportNewCreatePageEvent({apolloClient:o,tomeId:e.id,layoutId:r.id});const i=v(t,e.pages),l=r||(1===i?h.Ni:h.l1),{apply:c,revert:d,pageId:p,tileId:u}=g(e.id,l,i,e.theme.id),m={id:(0,a.Z)(),tomeId:e.id,clientId:n,apply:c,revert:d},b=(0,y.mz)(m);return(0,s.iO)(o,b,m),{pageId:p,tileId:u}}function O(e,t,o,n,r){const i=[],d=[];let p;if(t.forEach((t=>{i.push({operation:l.C8.DeletePage,id:t,tome:{id:e.id}}),d.push({operation:l.C8.RecoverPage,id:t,tome:{id:e.id}});const o=n.cache.readFragment({id:`Page:${t}`,fragment:l.bsn,fragmentName:"PageWithTilesFragment"});if(null!==o&&void 0!==o&&o.theme){const e=new c.Z(o.theme);e.isAnonymous&&(i.push({operation:l.C8.DeleteTheme,id:e.id}),d.push({operation:l.C8.RecoverTheme,id:e.id}))}})),o){const{apply:t,revert:o,pageId:n}=g(e.id,h.Ni,1,e.theme.id);p=n,i.push(...t),d.unshift(...o)}const u={id:(0,a.Z)(),tomeId:e.id,clientId:r,apply:i,revert:d};return(0,s.iO)(n,u),p}function P(e,t,o,n,r){if(t===o)return;const i=e.pages[t];let c;c=0===o?e.pages[0].order/2:o===e.pages.length-1?e.pages[o].order+1:o>t?(e.pages[o].order+e.pages[o+1].order)/2:(e.pages[o-1].order+e.pages[o].order)/2;const d=[{operation:l.C8.UpdatePage,id:i.id,page:{order:c},tome:{id:e.id}}],p=[{operation:l.C8.UpdatePage,id:i.id,page:{order:i.order},tome:{id:e.id}}],u={id:(0,a.Z)(),tomeId:e.id,clientId:r,apply:d,revert:p};(0,s.iO)(n,u)}function j(e,t,o,r,d){let p=1,u=1;if(e.pages.length>0&&(u=e.pages[e.pages.length-1].order),o<e.pages.length-1){u=e.pages[o].order;const n=e.pages[o+1].order;p=(n-u)/(t.length+1)}const m=[],g=[],h=[];t.forEach(((t,o)=>{const a=u+p*(o+1),s=i()();h.push(s);let d=t.theme.id;if(t.theme){const o=new c.Z(t.theme),n=new c.Z(e.theme),r=o.id===n.id;if(o.isAnonymous&&!r){var f;const t=i()();d=t,m.push({operation:l.C8.CreateTheme,id:t,theme:{orgId:null===e||void 0===e||null===(f=e.org)||void 0===f?void 0:f.id,colors:o.colors,headingTypeface:o.headingTypeface,paragraphTypeface:o.paragraphTypeface}}),g.push({operation:l.C8.DeleteTheme,id:t})}}m.push({operation:l.C8.CreatePage,id:s,page:{autoThemeColor:t.autoThemeColor,order:a,overlay:t.overlay,themeId:d},tome:{id:e.id}});const b=JSON.parse(JSON.stringify(t.layout));t.tiles.forEach((e=>{const t=`Tile:${e.id}`,o=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},r.cache.readFragment({id:t,fragment:l.mXG}));delete o.__typename,delete o.id;const a=i()();b.rows.map((t=>{t.tiles.map((t=>(t.tileId===e.id&&(t.tileId=a),t)));const o=i()();return t.rowId=o,t})),m.push({operation:l.C8.CreateTile,id:a,tile:o,page:{id:s}})})),m.push({operation:l.C8.UpdatePage,id:s,page:{layout:b}}),g.push({operation:l.C8.DeletePage,id:s,tome:{id:e.id}})}));const f={id:(0,a.Z)(),tomeId:e.id,clientId:d,apply:m,revert:g},b=(0,y.mz)(f);return(0,s.iO)(r,b,f),h}function w(e,t,o,n){const r=Math.max(...t),i=e.pages.filter(((e,o)=>t.includes(o)));return j(e,i,r,o,n)}function T(e,t,o){const n=[];t.forEach((e=>{const t=`Page:${e}`,r=o.cache.readFragment({id:t,fragment:l.bsn,fragmentName:"PageWithTilesFragment"});n.push(r)})),(0,b.fz)({tome:e,pages:n,type:"PAGE"})}function I(e,t,o,n){T(e,t,o);O(e,t,t.length===e.pages.length,o,n)}function E(e,t,o,n){const{pages:r,type:i}=(0,b.fz)();return"PAGE"===i?j(e,r,t,o,n):null}},37308:function(e,t,o){o.d(t,{W:function(){return s},a:function(){return l}});var n=o(59499),r=o(51718);function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const l=(e,t,o)=>{const{me:n}=e.readQuery({query:r.fkZ}),i=e.writeFragment({id:e.identify(t),fragment:r.LWh,fragmentName:"WorkspaceTomeFragment",data:t});e.modify({id:e.identify(n),fields:{recentTomes:e=>a(a({},e),{},{nodes:[i,...e.nodes]}),tomes:e=>a(a({},e),{},{nodes:[i,...e.nodes]})}}),o(e)},s=(e,t)=>{const o=t.id,{me:n}=e.readQuery({query:r.fkZ});e.modify({id:e.identify(t),fields:{deleted:()=>!1}}),e.modify({id:e.identify(n),fields:{tomes(e){const t=[{__ref:`Tome:${o}`},...e.nodes];return a(a({},e),{},{nodes:t})},deletedTomes(e,t){let{readField:n}=t;const r=e.nodes.filter((e=>o!==n("id",e)));return a(a({},e),{},{nodes:r})}}})}},69103:function(e,t,o){o.r(t),o.d(t,{__N_SSG:function(){return g},default:function(){return h}});var n=o(41664),r=o.n(n),i=o(11163),a=o(59016),l=o(1922),s=o(55245),c=o(8423),d=o(34136),p=o(85893);const u=(0,a.ZP)(d.Z)`
  &:hover,
  :focus,
  :active {
    text-decoration: none;
  }
  min-width: 145px;
`,m=a.ZP.div`
  display: flex;
  gap: 12px;
  margin: 24px 0;
`;var g=!0;function h(){const e=(0,i.useRouter)(),{t:t}=(0,l.$G)();return(0,p.jsx)(c.Z,{mainMessage:t("pages.mainErrorMessage404Page"),children:(0,p.jsxs)(m,{"data-testid":"404_page_button_container",children:[(0,p.jsx)(r(),{href:"/",passHref:!0,children:(0,p.jsx)(u,{component:"a",size:"large",children:t("pages.homeButton404Page")})}),(0,p.jsx)(r(),{href:(0,s.bM)(e),passHref:!0,children:(0,p.jsx)(u,{component:"a",size:"large",children:t("pages.loginButton404Page")})})]})})}},52322:function(e,t,o){const n=(0,o(4480).cn)({key:"forceTomeViewWithCacheState",default:!1});t.Z=n},22111:function(e,t,o){o.d(t,{B:function(){return i}});var n=o(28670),r=o.n(n);const i=e=>r().valid(e)&&1===r()(e).get("rgba.a")},1027:function(e,t,o){o.d(t,{G:function(){return r}});var n=o(62196);const r=e=>n.validate(e,{minDomainAtoms:2})},66482:function(e,t,o){o.d(t,{Bb:function(){return c},Gi:function(){return m},Qy:function(){return f},Y1:function(){return p},ZB:function(){return d},sc:function(){return g},tv:function(){return h},xh:function(){return l},yW:function(){return s}});var n=o(97173),r=o(19148),i=o(60864),a=o(15487);const l=(e,t)=>{if(!t)return null;for(let o=0;o<e.length;o++)if(e[o].id===t)return o;return null},s=(e,t)=>{const[o]=e.filter((e=>e.id===t));return o||e[0]},c=(e,t)=>{const[o]=e.filter(((e,o)=>o===t));return o?o.id:null},d=(e,t,o,n)=>{const r=t.map((t=>e.pages[t].id));(0,a.JK)(e,r,o,n)},p=(e,t,o,n)=>{const l=t.map((t=>e.pages[t].id));(0,a.l_)(e,l,o,n),(0,i.ak)({message:r.ZP.t("utils.pageActions.pageCopied_with_count",{count:l.length})})},u=function(e,t,o,n,l,s,c){let d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=o.length===e.pages.length,m=(0,a.tj)(e,o,u,n,l);let g,h;if(d&&(0,i.ak)({message:r.ZP.t("utils.pageActions.pageDeleted_with_count",{count:o.length}),action:"undo"}),u)h=0,g=m;else{const n=e.pages.map((e=>e.id)).filter((e=>!o.includes(e))),r=Math.min(...t);h=n.length-1>=r?p?r-1:r:n.length-1,g=n[h]}c(g),s([h])},m=(e,t,o,n,r,i,a,s)=>{const c=t.map((t=>l(e.pages,t)));u(e,c,t,o,n,r,i,a,s)},g=(e,t,o,n,r,i,a,l)=>{const s=t.map((t=>e.pages[t].id));u(e,t,s,o,n,r,i,a,l)},h=(e,t,o,r,i,l)=>{if(0===t.length)return;const s=(0,a.ek)(e,t,o,r),c=Math.max(...t)+1;i((0,n.Z)(c,c+t.length)),l(s[0]||"")},f=(e,t,o,r,i,s,c)=>{let d=Math.max(...t);if(d<0){d=l(e.pages,o)||0}const p=(0,a.sR)(e,d,r,i);if(p){const e=d+1;s((0,n.Z)(e,e+t.length)),c(p[0]||"")}}},60928:function(e,t,o){var n=o(22839);const r=3600,i=86400,a=604800,l=2419200,s=31449600;t.Z=function(e,t,o){const c=(new Date).valueOf(),d=new Date(e).valueOf(),p=Math.round((c-d)/1e3);if(p<60)return o?n.ZP.t("utils.getRelativeTimeLabel.momentsAgoCapitalized"):n.ZP.t("utils.getRelativeTimeLabel.momentsAgoLowercase");let u;if(p<r){const e=Math.floor(p/60);u=!1===t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMin_with_count",{count:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMinuteShortlabel",{relativeTimeValue:e})}else if(p<i){const e=Math.floor(p/r);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInHoursShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInHours",{relativeTimeValue:-e})}else if(p<a){const e=Math.floor(p/i);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInDaysShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInDays",{relativeTimeValue:-e})}else if(p<l||t&&p<s){const e=Math.floor(p/a);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInWeeksShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInWeeks",{relativeTimeValue:-e})}else if(p<s&&!t){const e=Math.floor(p/l);u=n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMonths",{relativeTimeValue:-e})}else{const e=Math.floor(p/s);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInYearsShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInYears",{relativeTimeValue:-e})}return u}}}]);
